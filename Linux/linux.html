<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Linux的学习 | winden96</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="winden96 的学习记录">
    
    <link rel="preload" href="/assets/css/0.styles.4fd6cf0c.css" as="style"><link rel="preload" href="/assets/js/app.e7c2969b.js" as="script"><link rel="preload" href="/assets/js/2.94d3dfac.js" as="script"><link rel="preload" href="/assets/js/13.0d8bcb67.js" as="script"><link rel="prefetch" href="/assets/js/10.27cdeca9.js"><link rel="prefetch" href="/assets/js/11.07a9d483.js"><link rel="prefetch" href="/assets/js/12.2505f188.js"><link rel="prefetch" href="/assets/js/14.a1698ea2.js"><link rel="prefetch" href="/assets/js/15.dce506f4.js"><link rel="prefetch" href="/assets/js/16.82ab8250.js"><link rel="prefetch" href="/assets/js/17.1fa3722a.js"><link rel="prefetch" href="/assets/js/18.129b810d.js"><link rel="prefetch" href="/assets/js/19.7531d5a3.js"><link rel="prefetch" href="/assets/js/20.2c5f040e.js"><link rel="prefetch" href="/assets/js/21.635435c4.js"><link rel="prefetch" href="/assets/js/22.a44576c7.js"><link rel="prefetch" href="/assets/js/23.32ee5f65.js"><link rel="prefetch" href="/assets/js/24.109d908c.js"><link rel="prefetch" href="/assets/js/25.9ebc3e07.js"><link rel="prefetch" href="/assets/js/26.643e2283.js"><link rel="prefetch" href="/assets/js/27.44aebb00.js"><link rel="prefetch" href="/assets/js/28.269bc50f.js"><link rel="prefetch" href="/assets/js/29.5ba9d11a.js"><link rel="prefetch" href="/assets/js/3.dc23a8fe.js"><link rel="prefetch" href="/assets/js/30.be0b3d6d.js"><link rel="prefetch" href="/assets/js/31.5c853594.js"><link rel="prefetch" href="/assets/js/32.06dd5c8a.js"><link rel="prefetch" href="/assets/js/33.66017b72.js"><link rel="prefetch" href="/assets/js/4.76c25a36.js"><link rel="prefetch" href="/assets/js/5.313f4ba0.js"><link rel="prefetch" href="/assets/js/6.3db81792.js"><link rel="prefetch" href="/assets/js/7.2b7d8442.js"><link rel="prefetch" href="/assets/js/8.19d8ddaf.js"><link rel="prefetch" href="/assets/js/9.4cbab228.js">
    <link rel="stylesheet" href="/assets/css/0.styles.4fd6cf0c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">winden96</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JUC</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JVM</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Java基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Linux</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Linux/linux.html" aria-current="page" class="active sidebar-link">Linux的学习</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/Linux/linux.html#_1-远程连接" class="sidebar-link">1. 远程连接</a></li><li class="sidebar-sub-header"><a href="/Linux/linux.html#_2-终端" class="sidebar-link">2. 终端</a></li><li class="sidebar-sub-header"><a href="/Linux/linux.html#_3-命令" class="sidebar-link">3 命令</a></li><li class="sidebar-sub-header"><a href="/Linux/linux.html#_4-bash-的基础特性" class="sidebar-link">4 bash 的基础特性</a></li><li class="sidebar-sub-header"><a href="/Linux/linux.html#_5-重定向" class="sidebar-link">5 重定向</a></li><li class="sidebar-sub-header"><a href="/Linux/linux.html#_6-管道" class="sidebar-link">6 管道 |</a></li><li class="sidebar-sub-header"><a href="/Linux/linux.html#_7-用户管理" class="sidebar-link">7. 用户管理</a></li><li class="sidebar-sub-header"><a href="/Linux/linux.html#_8-组" class="sidebar-link">8 组</a></li><li class="sidebar-sub-header"><a href="/Linux/linux.html#_9-用户" class="sidebar-link">9 用户</a></li><li class="sidebar-sub-header"><a href="/Linux/linux.html#_10-权限管理" class="sidebar-link">10 权限管理</a></li><li class="sidebar-sub-header"><a href="/Linux/linux.html#_11-shell脚本编程" class="sidebar-link">11 shell脚本编程</a></li><li class="sidebar-sub-header"><a href="/Linux/linux.html#_12-grep-文本过滤工具" class="sidebar-link">12 grep 文本过滤工具</a></li><li class="sidebar-sub-header"><a href="/Linux/linux.html#_13-egrep-扩展正则表达式" class="sidebar-link">13 egrep 扩展正则表达式</a></li><li class="sidebar-sub-header"><a href="/Linux/linux.html#_14-fgrep-不支持正则表达式元字符" class="sidebar-link">14 fgrep 不支持正则表达式元字符</a></li><li class="sidebar-sub-header"><a href="/Linux/linux.html#_15-文件查找" class="sidebar-link">15 文件查找</a></li><li class="sidebar-sub-header"><a href="/Linux/linux.html#_16-vim-和-vi" class="sidebar-link">16 vim 和 vi</a></li><li class="sidebar-sub-header"><a href="/Linux/linux.html#_17-文件管理系统" class="sidebar-link">17 文件管理系统</a></li><li class="sidebar-sub-header"><a href="/Linux/linux.html#_18-其他" class="sidebar-link">18 其他</a></li><li class="sidebar-sub-header"><a href="/Linux/linux.html#_19-程序包管理器" class="sidebar-link">19 程序包管理器</a></li><li class="sidebar-sub-header"><a href="/Linux/linux.html#_20-网络服务" class="sidebar-link">20 网络服务</a></li><li class="sidebar-sub-header"><a href="/Linux/linux.html#_21-进程" class="sidebar-link">21 进程</a></li><li class="sidebar-sub-header"><a href="/Linux/linux.html#_22-http" class="sidebar-link">22 http</a></li><li class="sidebar-sub-header"><a href="/Linux/linux.html#_24-mysql" class="sidebar-link">24 mysql</a></li><li class="sidebar-sub-header"><a href="/Linux/linux.html#_25-chrony-同步时间" class="sidebar-link">25 chrony 同步时间</a></li><li class="sidebar-sub-header"><a href="/Linux/linux.html#_26-rsyslog-系统日志" class="sidebar-link">26 rsyslog 系统日志</a></li><li class="sidebar-sub-header"><a href="/Linux/linux.html#_27-nginx-uwsgi" class="sidebar-link">27 nginx + uwsgi</a></li><li class="sidebar-sub-header"><a href="/Linux/linux.html#_28-gunicorn" class="sidebar-link">28 gunicorn</a></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>My SQL</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Mybatis Plus</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Redis</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Spring Boot</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Spring Cloud</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>分布式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>操作系统</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>杂记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>消息中间件</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>计算机网络</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>设计模式</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>linux 多任务、多用户</p> <h2 id="_1-远程连接"><a href="#_1-远程连接" class="header-anchor">#</a> 1. 远程连接</h2> <p>阿里ip : 172.19.186.195</p> <p>在远程连接时，如果出现<code>connection failed</code> ,一般是ubuntu系统没有安装ssh</p> <p>通过 <code>sudo apt-get install openssh-server</code> 安装 <code>ssh-server</code>,<code>sudo /etc/init.d/ssh start</code>  启动服务，启动成功会提示<code>[ok] Starting ssh (via systemctl): ssh.service</code></p> <div class="language- extra-class"><pre class="language-text"><code>ss -tnl # 查看系统是否监听于 tcp 协议的22号端口
</code></pre></div><ul><li>查看ip 地址</li></ul> <div class="language- extra-class"><pre class="language-text"><code>ifconfig # 查看地址，其中主要看inet那里的ip地址
或 ip addr list
</code></pre></div><ul><li>确定防火墙处于关闭状态</li></ul> <div class="language- extra-class"><pre class="language-text"><code># 在 ubuntu中无效
iptables -L -n  # 列出所有的防火墙


# 在 ubuntu中
# 打开防火墙
$ sudo ufw enable

# 查看防火墙状态 active为开启状态，inactive为关闭状态
$ sudo ufw status

# 关闭防火墙
$ sudo ufw disable
</code></pre></div><ul><li>查看所用的shell 类型</li></ul> <div class="language- extra-class"><pre class="language-text"><code>$ echo $SHELL
/bin/bash
</code></pre></div><img src="D:\linux软件\linux运维\images\ssh连接.png" style="zoom:80%;"> <h2 id="_2-终端"><a href="#_2-终端" class="header-anchor">#</a> 2. 终端</h2> <ul><li><p>物理终端，控制台 : console</p></li> <li><p>虚拟终端：6个  (tty)</p> <p><code>ctrl+Alt+F[1-6]</code></p></li> <li><p>图形终端</p> <p><code>ctrl+alt+F1</code></p> <p>eg: ubuntu 中<code>ctrl+alt+F2</code> 打开了虚拟终端，再按<code>ctrl+Alt+F1</code> 退出终端，进入图形化界面</p></li> <li><p>串行终端：ttyS</p></li> <li><p>伪终端：pty</p></li></ul> <h2 id="_3-命令"><a href="#_3-命令" class="header-anchor">#</a> 3 命令</h2> <h3 id="_3-1-命令概要"><a href="#_3-1-命令概要" class="header-anchor">#</a> 3.1 命令概要</h3> <div class="language- extra-class"><pre class="language-text"><code>command options arguments
</code></pre></div><ul><li><p>options 选项有两种表现形式:</p> <ul><li><p>短选项： -C，例如 -l, -d, ==注：有的命令的选项没有-==；</p> <p>​              如果同一命令同时使用多个短选项，多数可合并： <code>-l -d</code> = <code>-ld</code></p></li> <li><p>长选项： --word, 例如：<code>--help, --human-readable</code>, ==注：长选项不能合并==</p></li></ul></li> <li><p>arguments 命令的作用对象：命令对什么生效；不同的命令的参数：有些可同时带多个参数，多个之间以空白字符分隔； <code>ls -ld /var</code></p> <p>​</p></li></ul> <p>发起命令，请求内核将某个二进制程序运行为一个进程</p> <p>程序 -&gt; 进程， 静态-&gt; 动态</p> <ul><li><p>命令本身是一个可执行的程序文件：二进制格式的文件，有可能会调用共享库文件</p></li> <li><p>多数系统程序文件都存放在： <code>/bin, /sbin, /usr/bin, /usr/sbin, /usr/local/bin, usr/local/sbin</code></p> <ul><li>普通命令： <code>/bin, /usr/bin, /usr/local/bin</code></li> <li>管理命令：<code>/sbin, /usr/sbin, /usr/local/bin</code></li></ul></li> <li><p>共享库：<code>/lib, lib64, /usr/lib, /usr/lib64, /usr/local/lib, /usr/local/lib64</code></p> <ul><li>32bits的库：<code>/lib, /usr/lib, /usr/local/lib64</code></li> <li>64bits的库：<code>/lib64, /usr/lib64, /usrlocal/lib64</code></li></ul></li> <li><p>注：并非所有的命令都有一个在某目录与之对应的可执行程序文件</p></li> <li><p>命令的分类</p> <ul><li>shell 程序自带命令，内置命令(builtin)</li> <li>独立的可执行程序文件，文件名即命令名：外部命令</li></ul></li> <li><p>shell 程序是独特的程序，负责解析用户提供的命令</p></li> <li><p>查看命令类型：<code>type COMMAND</code></p></li></ul> <h3 id="_3-2-获取命令的使用帮助"><a href="#_3-2-获取命令的使用帮助" class="header-anchor">#</a> 3.2 获取命令的使用帮助</h3> <p>####3.2.1 内部命令</p> <p><code>help COMMAND</code></p> <p>####3.2.2 外部命令</p> <ul><li><p>命令自带简要格式的使用帮助   <code>COMMAND --help</code></p></li> <li><p>使用手册: manual</p> <p>位置：/usr/share/man</p> <p><code>man COMMAND</code></p> <table><thead><tr><th>字符</th> <th>说明</th></tr></thead> <tbody><tr><td>[]</td> <td>可选内容</td></tr> <tr><td>&lt;&gt;</td> <td>必须提供的内容</td></tr> <tr><td>a|b|c</td> <td>多选一</td></tr> <tr><td>...</td> <td>同类内容可出现多个</td></tr></tbody></table></li></ul> <p>使用手册：压缩格式的文件，有章节之分 <code>/usr/share/man</code></p> <table><thead><tr><th>man[1-8]</th> <th>说明</th></tr></thead> <tbody><tr><td>man1</td> <td>用户命令</td></tr> <tr><td>man2</td> <td>系统调用</td></tr> <tr><td>man3</td> <td>C库调用</td></tr> <tr><td>man4</td> <td>设备文件及特殊文件</td></tr> <tr><td>man5</td> <td>文件格式：（配置文件格式）</td></tr> <tr><td>man6</td> <td>游戏使用帮助</td></tr> <tr><td>man7</td> <td>杂项</td></tr> <tr><td>man8</td> <td>管理工具及守护进行</td></tr></tbody></table> <p><code>man CHAPTER COMMAND</code></p> <p>查看：<code>whatis COMMAND</code> (执行过程通过查询数据库进行)</p> <p>​		手动更新数据库： <code>makewhatis</code></p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Cman.png" alt=""></p> <p>#####3.2.2.1 man 命令打开手册以后的操作方法</p> <p>翻屏操作</p> <ul><li>空格键：向文件尾部翻一屏</li> <li>b：向文件首部翻一屏</li> <li><code>ctrl+d</code> : 向文件尾部翻半屏</li> <li><code>ctrl+u</code> : 向文件首部翻半屏</li> <li>回车键：向文件尾部翻一行</li> <li>k ：向文件首部翻一行</li> <li>G：跳转至指定行</li> <li><code>#G</code>： 跳转至指定行</li> <li>1G：跳转至文件首部</li></ul> <h5 id="_3-2-2-2-添加用户"><a href="#_3-2-2-2-添加用户" class="header-anchor">#</a> 3.2.2.2  添加用户</h5> <div class="language- extra-class"><pre class="language-text"><code>useradd jiang # 添加用户
id jiang # 验证方式

useradd -s /bin/tcsh jiang # 指定位置
tail -l /etc/passwd
</code></pre></div><p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E6%B7%BB%E5%8A%A0%E7%94%A8%E6%88%B7.png" alt=""></p> <h3 id="_3-3-常用命令"><a href="#_3-3-常用命令" class="header-anchor">#</a> 3.3 常用命令</h3> <h4 id="_3-3-1-pwd"><a href="#_3-3-1-pwd" class="header-anchor">#</a> 3.3.1 pwd</h4> <p><code>pwd</code> : 显示工作目录</p> <h4 id="_3-3-2-cd"><a href="#_3-3-2-cd" class="header-anchor">#</a> 3.3.2 cd</h4> <div class="language- extra-class"><pre class="language-text"><code>cd [/path]
cd : 切换回家目录
cd ~: 切换回家目录
cd ~username: 切换至指定用户的家目录
cd -: 在上一次所在目录与当前目录之间来回切换
. 当前目录
.. 上级目录
/ 根目录
</code></pre></div><h4 id="_3-3-3-ls"><a href="#_3-3-3-ls" class="header-anchor">#</a> 3.3.3 ls</h4> <p><code>ls</code>：列出指定目录下的内容</p> <div class="language- extra-class"><pre class="language-text"><code>ls [OPTION]... [FILE]...

man ls
</code></pre></div><ul><li>常见参数说明</li></ul> <table><thead><tr><th>option</th> <th>说明</th></tr></thead> <tbody><tr><td>-a</td> <td>显示所有文件，包括隐藏文件</td></tr> <tr><td>-A</td> <td>显示出. 和  .. 之外的所有文件</td></tr> <tr><td>-l</td> <td>--long,长列表，显示文件的详细属性信息</td></tr> <tr><td>-h</td> <td>--human-readable, 对文件大小单位换算，换算后结果可能会非精确值</td></tr> <tr><td>-d</td> <td>查看目录自身而非其内部的文件列表</td></tr> <tr><td>-r</td> <td>reverse，逆序显示</td></tr> <tr><td>-R</td> <td>recursive,递归显示</td></tr></tbody></table> <ul><li>对于 <code>-l</code>, 显示文件的详细属性信息</li></ul> <div class="language- extra-class"><pre class="language-text"><code>drwxr-xr-x 2 jiang jiang 4096 10月 31 14:51 a_d
</code></pre></div><p><code>d</code>：文件类型，-，d,b,c,l,s,p</p> <p><code>rwx</code>: 文件属主权限</p> <p><code>r-x</code>: 文件属组的权限</p> <p><code>r-x</code>:  其他用户（非属主、属组）的权限</p> <p><code>2</code>: 数组表示文件被硬连接的次数</p> <p><code>jiang</code>：文件的属主</p> <p><code>jiang</code>：文件属组的权限</p> <p>4096：数字表示文件的大小，单位是子节</p> <p>10月 31 14:51 文件最近一次被修改的时间</p> <p>a_d ：文件名</p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Cls.png" alt=""></p> <h4 id="_3-3-4-cat-文件文本查看工具"><a href="#_3-3-4-cat-文件文本查看工具" class="header-anchor">#</a> 3.3.4 cat 文件文本查看工具</h4> <div class="language- extra-class"><pre class="language-text"><code>cat /etc/fstab
cat /etc/passwd

cat [OPTION]... [FILE]...
	-n: 给显示的文本行编号
	-E: 显示行结束符$
cat /etc/issue | tee /tmp/issue | tr 'a-z' 'A-Z'
cat /tep/issue.tee
</code></pre></div><p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Ccat.png" alt=""></p> <p><code>tac</code>  文件文本查看工具</p> <div class="language- extra-class"><pre class="language-text"><code>tac /etc/fstab
tac /etc/passwd

tac [OPTION]... [FILE]...
	-n: 给显示的文本行编号
	-E: 显示行结束符$
</code></pre></div><h4 id="_3-3-5-echo-回显"><a href="#_3-3-5-echo-回显" class="header-anchor">#</a> 3.3.5 echo 回显</h4> <div class="language- extra-class"><pre class="language-text"><code>echo [SHORT-OPTION]...[STRING]...
	-n : 不进行换行
	-e : 让转义符生效 \t, \n
	STRING 可以使用引号，单引号和双引号均可用
		单引号：强引用，变量引用不执行替换
			$ echo '$SHELL'
		双引号：弱引用，变量引用会被替换
			$ echo &quot;SHELL&quot;
	注：变量引用的正规符号
</code></pre></div><p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Cecho.png" alt=""></p> <h4 id="_3-3-6-关机或重启命令-shutdown"><a href="#_3-3-6-关机或重启命令-shutdown" class="header-anchor">#</a> 3.3.6 关机或重启命令 ：shutdown</h4> <div class="language- extra-class"><pre class="language-text"><code>shutdown [OPTION...] [TIME] [WALL...]
	OPTIONS:
		-h: halt
		-r: reboot
		-c: cancel
	TIME:
		now
		hh:mm
		+m
			+0
	WALL  #在所有终端上发送信息
</code></pre></div><h4 id="_3-3-7-日期相关的命令"><a href="#_3-3-7-日期相关的命令" class="header-anchor">#</a> 3.3.7 日期相关的命令</h4> <p>linux 分为系统时钟和硬件时钟</p> <ol><li><p>date : 系统时钟</p> <div class="language- extra-class"><pre class="language-text"><code>显示日期时间：date [OPTION]...[+FORMAT]
FORMAT: 格式符 %F %T %Y %m %d %H %S %s(时间戳)...

设定日期时间：date [MMDDhhmmm[CC]YY[.ss]]
hwclock,clock:硬件时钟
	显示或设定硬件时钟
	-s, --hctosys: 以硬件为准，把系统调整为与硬件时间相同
	-w, --systohc: 以系统为准，把硬件时间调整为与系统时钟相同
cal: 日历
	cal [[month] year]
</code></pre></div></li></ol> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Cdate.png" alt=""></p> <h4 id="_3-3-8-which"><a href="#_3-3-8-which" class="header-anchor">#</a> 3.3.8 which</h4> <ul><li><p>which : show the full path of commands</p></li> <li><p>which [options] programname [...]</p> <ul><li>--skip-alias : 忽略别名</li></ul></li></ul> <h4 id="_3-3-9-whereis"><a href="#_3-3-9-whereis" class="header-anchor">#</a> 3.3.9 whereis</h4> <ul><li>whereis : locate the binary, source and manual  page files for a command</li> <li>whereis [option] name....
<ul><li>-b : 仅搜索二进制程序路径</li> <li>-m :  仅搜索使用手册文件路径</li></ul></li></ul> <h4 id="_3-3-10-who"><a href="#_3-3-10-who" class="header-anchor">#</a> 3.3.10 who</h4> <div class="language- extra-class"><pre class="language-text"><code>who : show who is logged on
who [OPTION]...
	-b: 系统此次启动的时间
	-r: 运行级别
</code></pre></div><p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Cw.png" alt=""></p> <h4 id="_3-3-11-w"><a href="#_3-3-11-w" class="header-anchor">#</a> 3.3.11 w</h4> <div class="language- extra-class"><pre class="language-text"><code>w : show who is logged on and what they are doing
</code></pre></div><h4 id="_3-3-12-mkdir"><a href="#_3-3-12-mkdir" class="header-anchor">#</a> 3.3.12 mkdir</h4> <div class="language- extra-class"><pre class="language-text"><code>mkdir [OPTION]...DIRECTORY...
	-p : 自动按需创建父目录
	-v : 显示详细过程
	-m : 直接给定权限
</code></pre></div><p>==注：路径基名为命令的作用对象；基名之前的路径必须存在==</p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Cmkdir.png" alt=""></p> <h4 id="_3-3-13-rmdir"><a href="#_3-3-13-rmdir" class="header-anchor">#</a> 3.3.13 rmdir</h4> <p>rmdir : remove empty directories</p> <div class="language- extra-class"><pre class="language-text"><code>rmdir [OPTION]...DIRECTORY...
	-p: 删除某目录后，如果其父目录为空，则一并删除之
	-v: 显示过程
</code></pre></div><p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Crmdir.png" alt=""></p> <h4 id="_3-3-14-分屏查看命令-more-和-less"><a href="#_3-3-14-分屏查看命令-more-和-less" class="header-anchor">#</a> 3.3.14 分屏查看命令：more 和 less</h4> <p>more 命令</p> <div class="language- extra-class"><pre class="language-text"><code>more FILE # 翻屏至文件尾部后自动退出
</code></pre></div><p>less 命令</p> <div class="language- extra-class"><pre class="language-text"><code>less FILE
</code></pre></div><h4 id="_3-3-15-head-查看文件的前-n-行"><a href="#_3-3-15-head-查看文件的前-n-行" class="header-anchor">#</a> 3.3.15 head 查看文件的前 n 行</h4> <div class="language- extra-class"><pre class="language-text"><code>head [options] FILE
	-n #
	-#

查看前20行
head -n 20 /etc/rc.d/init.d/functions
</code></pre></div><h4 id="_3-3-16-tail-查看文件的后-n-行"><a href="#_3-3-16-tail-查看文件的后-n-行" class="header-anchor">#</a> 3.3.16 tail  查看文件的后 n 行</h4> <div class="language- extra-class"><pre class="language-text"><code>tail [options] FILE
	-n #
	-#
	-f : 查看文件尾部内容结束后不退出，跟随显示新增的行
</code></pre></div><h4 id="_3-3-17-stat-显示文件或文件系统状态"><a href="#_3-3-17-stat-显示文件或文件系统状态" class="header-anchor">#</a> 3.3.17 stat 显示文件或文件系统状态</h4> <div class="language- extra-class"><pre class="language-text"><code>stat FILE...
文件：两类数据
	元数据：metadata
	数据：data
</code></pre></div><h4 id="_3-3-18-touch-命令"><a href="#_3-3-18-touch-命令" class="header-anchor">#</a> 3.3.18 touch 命令</h4> <div class="language- extra-class"><pre class="language-text"><code>touch : change file timestamps
touch [OPTION]...FILE...
	-c: 指定的文件路径不存在时不予创建
	-a: 仅修改 access time
    -m: 仅修改 modify time
    -t STAMP
    	[[CC]YYMMDDhhmm[.ss]]
</code></pre></div><p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Ctouch.png" alt=""></p> <h3 id="_3-4-文件管理工具"><a href="#_3-4-文件管理工具" class="header-anchor">#</a> 3.4 文件管理工具</h3> <h4 id="_3-4-1-cp-copy"><a href="#_3-4-1-cp-copy" class="header-anchor">#</a> 3.4.1 cp copy</h4> <p><code>cp</code>  命令的功能是将给出的 <strong>文件</strong> 或 <strong>目录</strong> 复制到另一个文件中，相当于 DOS下的copy 命令</p> <table><thead><tr><th>选项</th> <th>含义</th></tr></thead> <tbody><tr><td>-f</td> <td>已经存在的目标文件直接覆盖，不会提示</td></tr> <tr><td>-i</td> <td>覆盖文件前提示</td></tr> <tr><td>-r</td> <td>若给出的源文件是目录文件，则cp,  将递归复制该目录下的所有子目录和文件，目标文件必须为一个目录名</td></tr> <tr><td>-d</td> <td>复制符号链接文件本身，而非其指向的源文件</td></tr> <tr><td>-a</td> <td>-dR --preserve=all, archive,用于实现归档</td></tr></tbody></table> <div class="language- extra-class"><pre class="language-text"><code>cp 123.txt . //文件名不发生变化
cp -i Desktop/123.txt .

cp -r a text //复制a 和 text 目录

cp -r /usr/share/man/man[0-9] /tmp/man
</code></pre></div><p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Ccat1.png" alt=""></p> <h4 id="_3-4-2-mv-move"><a href="#_3-4-2-mv-move" class="header-anchor">#</a> 3.4.2 mv move</h4> <p><code>mv</code>  命令可以用来 <strong>移动</strong> <strong>文件</strong> 或<strong>目录</strong>，也可以给 <strong>文件或目录重命名</strong></p> <table><thead><tr><th>选项</th> <th>含义</th></tr></thead> <tbody><tr><td>-i</td> <td>覆盖文件前提示</td></tr> <tr><td>-f</td> <td>不会提示</td></tr></tbody></table> <div class="language- extra-class"><pre class="language-text"><code>mv text ~/Documents/
mv a/b/c/123.txt . //将123.txt 移动到当前目录
</code></pre></div><img src="D:\linux软件\linux运维\images\mv.png" style="zoom:50%;"> <h4 id="_3-4-3-rm-remove"><a href="#_3-4-3-rm-remove" class="header-anchor">#</a> 3.4.3 rm remove</h4> <p>删除文件或目录</p> <p>使用<code>rm</code> 命令要小心，因为<strong>文件删除后不能恢复</strong></p> <table><thead><tr><th>选项</th> <th>含义</th></tr></thead> <tbody><tr><td>-f</td> <td>强制删除，忽略不存在的文件，无需提示</td></tr> <tr><td>-r</td> <td>递归地删除目录下的内容，<strong>删除文件夹</strong>时必须加此参数</td></tr></tbody></table> <div class="language- extra-class"><pre class="language-text"><code>删除目录: rm -rf /path/to/dir
wui险操作：rm -rf /*
</code></pre></div><p>==注：所有不用的文件建议不要直接删除，而是移动至某个专用目录==</p> <h3 id="_3-5-globbing-文件名通配-整体文件名匹配-而非部分"><a href="#_3-5-globbing-文件名通配-整体文件名匹配-而非部分" class="header-anchor">#</a> 3.5 globbing : 文件名通配（整体文件名匹配，而非部分）</h3> <p>匹配模式：元字符</p> <ul><li><code>*</code> : 匹配任意长度的任意字符 p*,*p*</li> <li><code>?</code> : 匹配任意单个字符</li> <li><code>[]</code> : 匹配指定范围内的任意单个字符
<ul><li>[a-z], [A-Z], [0-9], [a-z0-9]</li> <li>[[:upper]] : 所有大写字母</li> <li>[[:lower:]] : 所有小写字母</li> <li>[[:alpha]] : 所有字母</li> <li>[[:dight]] : 所有数字</li> <li>[[:alnum:]] : 所有的字母和数字</li> <li>[[:space:]] : 所有的空白字符</li> <li>[[:punct:]] : 所有标点符号</li></ul></li> <li>[^] : 匹配指定范围外的任意单个字符
<ul><li>[^[:upper:]]</li> <li>[^0-9]</li> <li>[^[:alnum]]</li></ul></li></ul> <div class="language- extra-class"><pre class="language-text"><code>ls [[:upper:]][0-9][0-9]a # 第一个字母大写，2，3在[0-9]之间找，第4个为a

ls /var.log/l[0-9][[:lower:]] 
</code></pre></div><p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E9%80%9A%E9%85%8D%E7%AC%A6%E5%8C%B9%E9%85%8D.png" alt=""></p> <h3 id="_4-fhs-filesystem-hierarchy-standard"><a href="#_4-fhs-filesystem-hierarchy-standard" class="header-anchor">#</a> 4. FHS (Filesystem Hierarchy Standard)</h3> <ul><li><p><code>/bin</code>：所有用户可用的基本命令程序文件</p></li> <li><p><code>/sbin</code>：供系统管理使用的工具程序</p></li> <li><p><code>/boot</code>：引导加载器必须用到的各种静态文件：kernel(内核),initramfs(initrd), grub等</p></li> <li><p><code>/dev</code>：存储特殊文件或设备文件：</p> <p>​			设备有两种类型：字符设备、块设备</p></li> <li><p><code>/etc</code>：系统程序的配置文件，只能为静态</p></li> <li><p><code>/home</code>：普通的家目录的集中位置：一般每个普通用户的家目录默认为此目录下与用户名同名的子目录，<code>/home/username</code></p></li> <li><p><code>/lib</code>：为系统启动或跟文件系统上的应用程序(/bin, /sbin等)提供共享库，以及为内核提供内核模块</p> <ul><li>libc.so.*：动态连接的C库</li> <li>ld*：运行时链接器/加载器</li> <li>modules：用于存储内核模块的目录</li></ul></li> <li><p><code>/lib64</code>：64位系统特有的存放64位共享库的路径</p></li> <li><p><code>/media</code>：便携式设备挂载点， cdrom,floppy等；</p></li> <li><p><code>/mnt</code>：其他文件系统的临时挂载点</p></li> <li><p><code>/opt</code>：附加应用程序的安装位置：可选路径</p></li> <li><p><code>/srv</code>：当前主机位服务器提供的数据</p></li> <li><p><code>/tmp</code>：为那些会产生临时文件的程序提供的用于存储临时文件的目录，可供所用户执行写入操作，有特殊权限</p></li> <li><p><code>/usr</code>：usr Hierarchy，全局共享的只读数据路径</p> <ul><li>bin, sbin</li> <li>lib, lib64</li> <li>include：c程序头文件</li> <li>X11R6：X-Window程序的安装位置</li> <li>src：程序源码文件的存储位置</li></ul></li> <li><p><code>/usr/local</code>：local hierarchy,让系统管理员安装本地应用程序，也通常用于安装第三方库</p></li> <li><p><code>/var</code>：var Hierarchy，存储经常发生变化的数据的目录</p> <ul><li>cache     数据缓存</li> <li>lib     变量信息</li> <li>local     variable data for /usr/local</li> <li>lock    lock files</li> <li>log  , opt,  run,  spool,  tmp</li></ul></li> <li><p><code>/proc</code>: 基于内存的虚拟文件系统，用于为内核及进程存储其相关信息，多为内核参数，虚拟我i<code>net/ipv4/ip_forward</code>, 存储于<code>/proc/sys</code>, <code>/sys</code> 为管理linux提供统一的模型接口</p></li></ul> <h4 id="_3-3-14-tree"><a href="#_3-3-14-tree" class="header-anchor">#</a> 3.3.14 tree</h4> <div class="language- extra-class"><pre class="language-text"><code>tree [options] [directory]
	-L level : 指定要显示的层级
</code></pre></div><h3 id="_5-常见的文件类型"><a href="#_5-常见的文件类型" class="header-anchor">#</a> 5 常见的文件类型</h3> <ul><li>-：常规文件；即 f</li> <li>d : directory,目录文件</li> <li>b : block device, 块设备文件，支持以“block”为单位进行随机访问</li> <li>c : character device ，字符设备文件</li> <li>l : symbolic link,符号链接文件</li> <li>p：pipe 管道</li> <li>s : socket 套接字文件</li></ul> <p>###6. 命令别名</p> <p>命令类型：外部命令，内部命令</p> <p>内部命令：builtin</p> <p>外部：显示为命令文件路径</p> <p>命令可以有别名，别名可以与原名相同，此时元明被隐藏，如果要运行原命令，则使用 <code>\COMMAND</code></p> <p><strong>命令别名</strong></p> <ul><li><p>获取所有可用别名的定义 <code>alias</code></p></li> <li><p>定义别名： <code>alias NAME='COMMAND'</code></p></li> <li><p>撤销别名 ： <code>unalias NAME</code></p></li></ul> <h3 id="_7-历史-history"><a href="#_7-历史-history" class="header-anchor">#</a> 7 历史 history</h3> <div class="language- extra-class"><pre class="language-text"><code>history [-c] [-d 偏移量] [n] 或 history -anrw [文件名] 或 history -ps 参数 [参数...]
</code></pre></div><ul><li>-c : 清空命令历史</li> <li>-d offset : 删除指定命令历史</li> <li>-r : 从文件读取命令历史至历史列表中</li> <li>-w : 把历史列表中的命令追加到历史文件中</li> <li>history # : 显示最近的#条命令</li></ul> <ol><li>调用命令历史列表中的命令</li></ol> <p>!# : 再一次执行列表在的第#条命令</p> <p>!!: 再次执行上一条命令</p> <p>!STRING: 再一次执行命令历史列表中最近一个以STRING开头的命令</p> <ol start="2"><li><p>调用上一条命令的最后一个参数：</p> <p>快捷键： ESC，.</p> <p>字符串：!$</p></li> <li><p>控制命令历史记录的方式</p> <p>​	环境变量：HISTCONTROL</p> <p>​			<code>ignoredups</code>: 忽略重复的命令</p> <p>​			<code>ignorespace</code> : 忽略以空白字符开头的命令</p> <p>​			<code>ignoreboth</code>: 以上二者同时生效</p></li></ol> <h2 id="_4-bash-的基础特性"><a href="#_4-bash-的基础特性" class="header-anchor">#</a> 4 bash 的基础特性</h2> <p>补全命令：tab</p> <h3 id="_4-1-命令行展开"><a href="#_4-1-命令行展开" class="header-anchor">#</a> 4.1 命令行展开</h3> <p>~：自动展开为用户的家目录，或指定的用户的家目录</p> <p>{} : 看完承载一个以逗号分隔的路径列表，并能够将其展开为多个路径；</p> <div class="language- extra-class"><pre class="language-text"><code>/tmp/{a, b}  相当于 /tmp/a /tmp/b
</code></pre></div><h3 id="_4-2-命令的执行状态结果"><a href="#_4-2-命令的执行状态结果" class="header-anchor">#</a> 4.2 命令的执行状态结果</h3> <p>bash 通过状态返回值输出此结果</p> <ul><li>成功： 0</li> <li>失败： 1~255</li></ul> <p>命令执行完成后，其状态返回值保存于bash 的特殊变量 $? 中</p> <p>命令正常执行时，有的还会有命令返回值，根据命令及其功能不同，结果各不相同</p> <h3 id="_4-3-引用"><a href="#_4-3-引用" class="header-anchor">#</a> 4.3 引用</h3> <p>引用命令的执行结果</p> <p>$(COMMAND) 或 <code>COMMAND</code></p> <ul><li>强引用：' '</li> <li>弱引用：&quot; &quot;</li> <li>命令引用：``</li></ul> <h3 id="_4-4-快捷键"><a href="#_4-4-快捷键" class="header-anchor">#</a> 4.4 快捷键</h3> <ul><li><code>ctrl + a</code> : 跳转至命令行行首</li> <li><code>ctrl + e</code> : 跳转至命令行行尾</li> <li><code>ctrl + u</code> : 删除行首至光标所在处之间的所有字符</li> <li><code>ctrl + k</code> :  删除光标所在行至行尾的所有字符</li> <li><code>ctrl + l</code> : 清屏，相当于 clear</li></ul> <h3 id="_4-5-命令hash"><a href="#_4-5-命令hash" class="header-anchor">#</a> 4.5 命令hash</h3> <div class="language- extra-class"><pre class="language-text"><code>key-value: key:搜索键 value:值
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>hash: 列出
hash -d COMMAND: 删除
hash -r: 清空
</code></pre></div><p><code>$?</code>: 0成功; <code>1-255</code>:失败</p> <h3 id="_4-6-本地变量"><a href="#_4-6-本地变量" class="header-anchor">#</a> 4.6 本地变量</h3> <ul><li>变量赋值：name=value</li> <li>变量引用：${name}, $name
<ul><li>&quot; &quot;: 变量名会替换为其值</li> <li>' ': 变量名不会替换为其值</li></ul></li> <li>查看变量：set</li> <li>撤销变量：unset name
<ul><li>此变量非变量引用</li></ul></li></ul> <h3 id="_4-6-环境变量"><a href="#_4-6-环境变量" class="header-anchor">#</a> 4.6 环境变量</h3> <p><strong>变量赋值</strong>：</p> <ul><li>export name=value</li> <li>name=value
<ul><li>export name</li></ul></li> <li>declare -x name=value</li> <li>name=value
<ul><li>declare -x name</li></ul></li></ul> <p><strong>变量引用：</strong><code>$(name)</code>, <code>$(name)</code></p> <p><strong>只读变量：</strong></p> <ul><li>declare -r name</li> <li>readonly name</li> <li>只读变量无法重新赋值，并且不支持撤销；存活时间为当前shell进程的生命周期</li></ul> <img src="D:\linux软件\linux运维\images\变量.png" style="zoom:80%;"> <h3 id="_4-7-bash的配置文件"><a href="#_4-7-bash的配置文件" class="header-anchor">#</a> 4.7 bash的配置文件</h3> <h4 id="_4-7-1-profile类"><a href="#_4-7-1-profile类" class="header-anchor">#</a> 4.7.1 profile类</h4> <p>对所有用户都生效</p> <p><code>/etc/profile</code></p> <p><code>etc/profild.d/*.sh</code></p> <p>用户个人：仅对当前用户有效</p> <p><code>~/.bash_profile</code></p> <p>功用：</p> <ol><li>用于定义环境变量</li> <li>运行命令或脚本</li></ol> <h4 id="_4-7-1-bashrc类"><a href="#_4-7-1-bashrc类" class="header-anchor">#</a> 4.7.1 bashrc类</h4> <p>全局：<code>/etc/bashrc</code></p> <p>用户：<code>~/.bash_profile</code></p> <p>功用：</p> <ol><li>定义本地变量</li> <li>运行命令别名</li></ol> <p>注意：仅管理员可修改全局配置文件</p> <h3 id="_4-8-bash脚本编程之算术运算"><a href="#_4-8-bash脚本编程之算术运算" class="header-anchor">#</a> 4.8 bash脚本编程之算术运算</h3> <p>+,-,*,/,**,%</p> <h3 id="_4-8-1-格式"><a href="#_4-8-1-格式" class="header-anchor">#</a> 4.8.1 格式</h3> <ul><li>let var=算数表达式</li> <li>var=$(算数表达式)</li> <li>var=$((算数表达式))</li> <li>var=$(expr $arg1 $op $arg2)</li></ul> <p>注：*在有些时候需要转义符</p> <h2 id="_5-重定向"><a href="#_5-重定向" class="header-anchor">#</a> 5 重定向</h2> <ul><li>Linux 允许将命令执行结果  <strong>重定向</strong> 到 一个 <strong>文件</strong></li> <li>将本应显示在  <strong>终端上的内容 输出/追加 到指定文件</strong>  中</li></ul> <p>其中</p> <ul><li><code>&gt;</code> : 表示输出，会覆盖文件原有内容</li> <li><code>&gt;&gt;</code> : 表示追加，会将内容追加到已有文件的末尾</li></ul> <h3 id="_5-1-输出重定向"><a href="#_5-1-输出重定向" class="header-anchor">#</a> 5.1 输出重定向</h3> <ul><li>输出重定向 &gt;
<ul><li>特点：覆盖输出</li></ul></li> <li>输出重定向 &gt;&gt;
<ul><li>特点：追加输出</li></ul></li> <li>set -C
<ul><li>禁止覆盖输出重定向至已存在的文件</li> <li>此时可使用强制覆盖输出 &gt;|</li></ul></li> <li>set +C
<ul><li>关闭上述特性</li></ul></li> <li>错误输出流重定向 2&gt;, 2&gt;&gt;</li> <li>合并正常输出流和错误输出流
<ul><li>&amp;&gt;, &amp;&gt;&gt;</li> <li>COMMAND &gt; /path/to/somefile 2&gt;&amp;1</li> <li>COMMAND &gt;&gt;/path/to/somefile 2&gt;&amp;1</li></ul></li></ul> <div class="language- extra-class"><pre class="language-text"><code>cat /etc/issue &gt; /tep/issue.out

cat /etc/issue 2&gt; tmp/issue2.err

cat /etc/fstab &amp;&gt; /tep/fatab.out
</code></pre></div><p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E9%87%8D%E5%AE%9A%E5%90%911.png" alt=""></p> <h3 id="_5-2-输入重定向"><a href="#_5-2-输入重定向" class="header-anchor">#</a> 5.2 输入重定向 &lt;</h3> <p>####5.2.1 tr</p> <div class="language- extra-class"><pre class="language-text"><code>tr 命令：
	tr [OPTION]...SET1 [SET2]
	把输入的数据当中的字符，凡是在SET1定义范围内出现的，通通对位转换为SET2出现的字符
	用法1： tr SET1 SET2 &lt; PATH/FROM/SOMEFIEL
	用法2：tr -d set1 &lt; path/from/somefile

tr [a-z] [A-Z] 
tr [a-z] [A-Z] &lt; /etc/issue
</code></pre></div><p>==注：不修改原文件==</p> <h4 id="_5-2-2"><a href="#_5-2-2" class="header-anchor">#</a> 5.2.2 &lt;&lt;</h4> <div class="language- extra-class"><pre class="language-text"><code>cat &lt;&lt; EOF #相当于当EOF作为文档的结束符
cat &gt; PTH/TO/SOMEFILE &lt;&lt; EOF

cat ? /tmp/cat.out &lt;&lt; END
</code></pre></div><p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E9%87%8D%E5%AE%9A%E5%90%912.png" alt=""></p> <h2 id="_6-管道"><a href="#_6-管道" class="header-anchor">#</a> 6 管道 |</h2> <p>将前一个命令的输出当作后一个程序的输入</p> <div class="language- extra-class"><pre class="language-text"><code>command1 | command2 | command3 | ...
</code></pre></div><p>tee 命令</p> <div class="language- extra-class"><pre class="language-text"><code>command | tee /path/to/somefile

# 将/etc/passwd 文件的前6行的信息转换为大写字符后输出
head - n 6 /etc/passwd | tr 'a-z' 'A-Z' 
</code></pre></div><p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E7%AE%A1%E9%81%93.png" alt=""></p> <h2 id="_7-用户管理"><a href="#_7-用户管理" class="header-anchor">#</a> 7. 用户管理</h2> <h3 id="_7-1-用户类别"><a href="#_7-1-用户类别" class="header-anchor">#</a> 7.1 用户类别</h3> <ul><li>管理员、普通用户</li></ul> <h3 id="_7-2-组类别"><a href="#_7-2-组类别" class="header-anchor">#</a> 7.2 组类别</h3> <ul><li>管理员组、普通用户组</li> <li>基本组、附加组</li> <li>私有组、共工作</li></ul> <h3 id="_7-3-数据库文件"><a href="#_7-3-数据库文件" class="header-anchor">#</a> 7.3 数据库文件</h3> <ul><li><code>/etc/passwd</code> <ul><li><code>login:password:uid:gid:comment:home:shell</code></li></ul></li></ul> <img src="D:\linux软件\linux运维\images\用户管理.png" style="zoom:80%;"> <ul><li><code>/etc/shadow</code> <ul><li><code>login:encrpted_passwd:...</code></li></ul></li></ul> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%862.png" alt=""></p> <ul><li><code>/etc/group</code> <ul><li><code>group:password:gid:user_list</code></li></ul></li></ul> <img src="D:\linux软件\linux运维\images\用户管理3.png" style="zoom:80%;"> <p>密码存储格式：单向加密，并借助salt完成</p> <h2 id="_8-组"><a href="#_8-组" class="header-anchor">#</a> 8 组</h2> <h3 id="_8-1-添加组-groupadd"><a href="#_8-1-添加组-groupadd" class="header-anchor">#</a> 8.1 添加组 groupadd</h3> <div class="language- extra-class"><pre class="language-text"><code>groupadd [选项] group_name
	-g GID: 指定GID；默认是上一个组的GID+1
	-r: 创建系统组
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>sudo groupadd -r testgroup
sudo groupadd -g 2000 grp1
</code></pre></div><img src="D:\linux软件\linux运维\images\用户管理4.png" style="zoom:80%;"> <h3 id="_8-2-修改组属性-groupmod"><a href="#_8-2-修改组属性-groupmod" class="header-anchor">#</a> 8.2 修改组属性 groupmod</h3> <div class="language- extra-class"><pre class="language-text"><code>groupmod [选项] GROUP
	-g GID: 修改GID
	-n new_name: 修改组名
</code></pre></div><h3 id="_8-3-删除组-groupdel"><a href="#_8-3-删除组-groupdel" class="header-anchor">#</a> 8.3 删除组 groupdel</h3> <div class="language- extra-class"><pre class="language-text"><code>groupdel [选项] GROUP
</code></pre></div><img src="D:\linux软件\linux运维\images\用户管理5.png" style="zoom:80%;"> <h2 id="_9-用户"><a href="#_9-用户" class="header-anchor">#</a> 9 用户</h2> <h3 id="_9-1-创建用户-useradd"><a href="#_9-1-创建用户-useradd" class="header-anchor">#</a> 9.1 创建用户 useradd</h3> <div class="language- extra-class"><pre class="language-text"><code>man useradd

useradd [选项] 登录名
	-u, --uid UID指定UID
	-g, --gid GROUP指定基本组ID，此组得事先存在
	-G, --groups GROUP1[,GROUP2,...[,GROUPN]]:指明用户所属得附加组，多个组之间用逗号分隔
	-c, --comment COMMENT: 指明注释信息
	-d, --home HOME_DIR:以指定的路径为用户的家目录，通过复制/etc/skel此目录并重命名实现，指定的家目录如果事先存在，则不会为用户复制环境配置文件
	-s, --shell SHELL:指定用户的默认shell,可用的所有shell列表存储在/etc/shells文件中
	-r, --system: 创建系统用户
</code></pre></div><p><strong>创建用户时的诸多默认设定配置文件为<code>/etc/login.defs</code></strong></p> <div class="language- extra-class"><pre class="language-text"><code>useradd -D: 显示创建用户的默认配置
useradd -D: 修改默认选项的值
useradd -u UID 名字: 设置UID
修改的结果保存在/etc/default/useradd文件中
</code></pre></div><img src="D:\linux软件\linux运维\images\用户管理6.png" style="zoom:80%;"> <h3 id="_9-2-usermod-修改用户属性"><a href="#_9-2-usermod-修改用户属性" class="header-anchor">#</a> 9.2 usermod 修改用户属性</h3> <div class="language- extra-class"><pre class="language-text"><code>usermod [选项] 登录
	-u, --uid UID: 修改用户的ID为此处指定的新UID
	-g, --gid GROUP: 修改用户所属的基本组
	-G, --groups GROUP1[,GROUP2,...[,GROUPN]]: 修改用户所属的附加组：原来的附加组会被覆盖
	-a, --append: 与-G一同使用，用于为用户追加新的附加组
	-c, --comment COMMENT: 修改注释信息
	-d, --home HOME_DIR: 修改用户的家目录：用户原有的文件不会被转移至新位置
	-m, --move-home: 只能与-d选项一同使用，用于将原来的家目录移动为新的家目录
	-l, --login NEW_LOGIN: 修改用户名
	-s, --shell SHELL: 修改用户的默认shell
	
	-L, --lock: 锁定用户密码：即在用户原来的密码字符串之前添加一个&quot;!&quot;
	-U, --unlock: 解锁用户密码
</code></pre></div><h3 id="_9-3-userdel-删除用户"><a href="#_9-3-userdel-删除用户" class="header-anchor">#</a> 9.3 userdel 删除用户</h3> <div class="language- extra-class"><pre class="language-text"><code>userdel 用户名
</code></pre></div><img src="D:\linux软件\linux运维\images\添加删除用户.png" style="zoom:80%;"> <h3 id="_9-3-passwd"><a href="#_9-3-passwd" class="header-anchor">#</a> 9.3 passwd</h3> <div class="language- extra-class"><pre class="language-text"><code>passwd [-k] [-l] [-u[-f]] [-d] [-e] [-n mindays] [-x maxdays] [-w warndays] [-i inactivedays] [-S] [--stdin] [-username]

(1) passwd: 修改用户自己的密码
(2) passwd USERNAME: 修改指定用户的密码。但仅root 有此权限
	-l, -u: 锁定和解锁用户
	-d: 清除用户密码串
	-e DATE: 过期期限，日期
	-i DAYS: 非活动期限
	-n DAYS: 密码的最短使用期限
	-x DAYS: 密码的最长使用期限
	-w DAYS: 警告期限
	
	--stdin: 

passwd -d jojo # 清除jojo的密码串
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>关于stdin的和passwd组合使用的问题

for name in xp wrg lct
do
useradd $name
echo red | passwd --stdin $name
done

解释：passwd  --stdin $name是更改$name变量的密码，$name变量指代上面for循环的三个用户xp ，wrg， lct
加上--stdin是接受echo后面的字符串(red)做为密码，密码是red

意思就是，创建三个用户：xp ，wrg， lct
密码都是：red
</code></pre></div><h3 id="_9-5-gpasswd-命令"><a href="#_9-5-gpasswd-命令" class="header-anchor">#</a> 9.5 gpasswd 命令</h3> <p>组密码文件：<code>/etc/gshadow</code></p> <div class="language- extra-class"><pre class="language-text"><code>gpasswd [选项] group
	-a USERNAME: 向组中添加用户
	-d USERNAME: 从组中移除用户
</code></pre></div><h3 id="_9-6-newgrp-临时切换指定的组为基本组"><a href="#_9-6-newgrp-临时切换指定的组为基本组" class="header-anchor">#</a> 9.6 newgrp  临时切换指定的组为基本组</h3> <div class="language- extra-class"><pre class="language-text"><code>newgrp [-] [group]
	-: 会模拟用户重新登录以实现重新初始化其工作环境
</code></pre></div><h3 id="_9-7-chage命令-更改用户密码过期信息"><a href="#_9-7-chage命令-更改用户密码过期信息" class="header-anchor">#</a> 9.7 chage命令：更改用户密码过期信息</h3> <div class="language- extra-class"><pre class="language-text"><code>chage [选项] 登录名
</code></pre></div><h3 id="_9-8-id命令-显示用户的真实有效id"><a href="#_9-8-id命令-显示用户的真实有效id" class="header-anchor">#</a> 9.8 id命令：显示用户的真实有效ID</h3> <div class="language- extra-class"><pre class="language-text"><code>id [OPTION]...[USER]
	-u: 仅显示有效的UID
	-g: 仅显示用户的基本组ID
	-G： 仅显示用户所属的所有组的ID
	-n: 显示名字而非ID
</code></pre></div><h3 id="_9-9-su-命令-switch-user"><a href="#_9-9-su-命令-switch-user" class="header-anchor">#</a> 9.9 su 命令：switch user</h3> <ul><li>登录式切换：会通过读取目标用户的配置文件来重新初始化
<ul><li><code>su - USERNAME</code></li> <li><code>su -l USERNAME</code></li></ul></li> <li>非登录式切换：不会读取目标用户的配置文件进行初始化
<ul><li><code>su USERNAME</code></li></ul></li></ul> <p><strong>注：管理员可无密码切换至其他任何用户</strong></p> <p><code>-c 'COMMAND'</code>: 仅以指定yoghurt的身份运行此处指定的命令</p> <h2 id="_10-权限管理"><a href="#_10-权限管理" class="header-anchor">#</a> 10 权限管理</h2> <img src="D:\linux软件\linux运维\images\权限管理.png" style="zoom:80%;"> <div class="language- extra-class"><pre class="language-text"><code>rwxrwxrwx:
	左三位：定义user(owner)的权限
	中三位：定义group的权限
	右三位：定义other的权限
</code></pre></div><ul><li>进程安全上下文：
<ul><li>进程对文件的访问权限应用模型：</li> <li><strong>进程的属主与文件的属主</strong>是否相同；如果<strong>相同</strong>，则<strong>应用属主权限</strong>，否则检查<strong>进程的属主是否属于文件的属组</strong>；如果<strong>是</strong>，则应用<strong>属组权限</strong>；否则应用other的权限</li></ul></li></ul> <p>###10.1 权限的基本</p> <p>权限：</p> <ul><li><code>r</code> : read, 读</li> <li><code>w</code>: wirte,写</li> <li><code>x</code>: excute, 执行</li></ul> <p>文件：</p> <ul><li><code>r</code>: 获取文件的数据</li> <li><code>w</code>: 修改文件的数据</li> <li><code>x</code>: 可将此文件运行为进程</li></ul> <p>目录：</p> <ul><li><code>r</code>: 可使用ls命令获取其下的所有文件列表</li> <li><code>w</code>: 可修改此目录下的文件列表，即创建或删除文件</li> <li><code>x</code>: 可cd至此目录中，且可使用<code>ls -l</code>来获取所有文件的详细属性信息</li></ul> <p><code>mode: rwxrwxrwx</code></p> <p><code>ownership: user, group</code></p> <h3 id="_10-2-权限的组合机制"><a href="#_10-2-权限的组合机制" class="header-anchor">#</a> 10.2 权限的组合机制</h3> <div class="language- extra-class"><pre class="language-text"><code>--- 000 0
--x 001 1
-w- 010 2
-wx 011 3
r-- 100 4
r-x 101 5
rw- 110 6
rwx 111 7
</code></pre></div><p>eg: <code>rw-r--rwx: 647</code></p> <h3 id="_10-3-chmod-修改属主-属组-其他"><a href="#_10-3-chmod-修改属主-属组-其他" class="header-anchor">#</a> 10.3 chmod 修改属主，属组，其他</h3> <div class="language- extra-class"><pre class="language-text"><code>chmod [OPTION]... MODE[,MODE]...FILE...
chmod [OPTION]...OCTAL-MODE FILE...
chmod [OPTION]... --reference=RFILE FILE...

chmod ug=r a.txt
chmod u=rwx,g=rw,o= a.txt

chmod 700 a_d -R # 对里面的子文件也执行修改该权限
</code></pre></div><p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Cchmod3.png" alt=""></p> <p>三类用户：</p> <ul><li>u：属主</li> <li>g：属组</li> <li>o：其它</li> <li>a：所有</li></ul> <ol><li><p><code>chmod [OPTION]...MODE[,MODE]...FILE...</code></p> <ul><li><p>赋权表示法: 直接操作一类用户的所有权限位rwx</p> <p><code>ug=</code>、<code>u=</code>、<code>g=</code>、<code>o=</code>、<code>a=</code></p></li> <li><p>授权表示法：直接操作一类瀛湖的一个权限为r,w,x</p> <p><code>u+</code>、<code>u-</code>、<code>g+</code>、<code>g-</code>、<code>o+</code>、<code>o-</code>、<code>a+</code>、<code>a-</code></p></li></ul></li> <li><p><code>chmod [OPTION]...OCTAL-MODE FILE...</code></p></li> <li><p><code>chmod [OPTION]...--referencce=REILE FILE...</code></p> <p>选项：-R, --recursive：递归修改</p></li></ol> <img src="D:\linux软件\linux运维\images\chmod.png" style="zoom:80%;"> <img src="D:\linux软件\linux运维\images\chmod2.png" style="zoom:80%;"> <h3 id="_10-4-从属关系管理命令-chown-chgrp"><a href="#_10-4-从属关系管理命令-chown-chgrp" class="header-anchor">#</a> 10.4 从属关系管理命令：chown, chgrp</h3> <p>####10.4.1 chown</p> <div class="language- extra-class"><pre class="language-text"><code>chown [OPTION]... MODE[:group]...FILE...
chown [OPTION]... --reference=RFILE FILE...

选项 -R: 递归修改
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>chown -R hhh:mygrp skel/    root.root表示hhh用户mygrp组
chown -R root.root skel/    root.root表示root用户root组
</code></pre></div><h4 id="_10-4-2-chgrp"><a href="#_10-4-2-chgrp" class="header-anchor">#</a> 10.4.2 chgrp</h4> <div class="language- extra-class"><pre class="language-text"><code>chgrp [OPTION]...GROUP FILE...
chgrp [OPTION]...--reference=RFILE FILE...
</code></pre></div><h3 id="_10-5-install命令"><a href="#_10-5-install命令" class="header-anchor">#</a> 10.5 install命令</h3> <div class="language- extra-class"><pre class="language-text"><code>install - copy files and set attributes
</code></pre></div><ul><li><p>单源复制：<code>install [OPTION]...[-T] SOURCE DEST</code></p></li> <li><p>多源复制：</p> <ul><li><code>install [OPTION]...SOURCE...DIRECTORY</code></li> <li><code>install [OPTION]...-t DIRECTORY SOURCE...</code></li></ul></li> <li><p>创建目录：<code>install [OPTION]...-d DIRECTORY...</code></p></li> <li><p>常用选项</p></li></ul> <table><thead><tr><th>参数</th> <th>意思</th></tr></thead> <tbody><tr><td>-m</td> <td>--mode=MODE: 设定目标文件权限，默认为755</td></tr> <tr><td>-o</td> <td>--owner=OWNER: 设定目标文件属主</td></tr> <tr><td>-g</td> <td>--group=GROUP: 设定目标文件属组</td></tr></tbody></table> <h3 id="_10-6-mktemp-创建模板"><a href="#_10-6-mktemp-创建模板" class="header-anchor">#</a> 10.6 mktemp 创建模板</h3> <div class="language- extra-class"><pre class="language-text"><code>mktemp - create a temproary file or directory

mktemp [OPTION]...[TEMPLATE]
常用选项：
	-d: 创建临时目录
注意：mktemp会将创建的临时文件名直接返回，因此，可直接通过命令引用保存起来

mktemp /tmp/mytemp.XXXX
mktemp /tmp/mytemp.XXXXXX
</code></pre></div><img src="D:\linux软件\linux运维\images\创建临时文件.png" style="zoom:80%;"> <h2 id="_11-shell脚本编程"><a href="#_11-shell脚本编程" class="header-anchor">#</a> 11 shell脚本编程</h2> <p>shell脚本编程：过程式编程，解释运行，依赖于外部程序文件运行</p> <h3 id="_11-1-编写shell脚本"><a href="#_11-1-编写shell脚本" class="header-anchor">#</a> 11.1 编写shell脚本</h3> <div class="language- extra-class"><pre class="language-text"><code># 脚本第一行，顶格给出解释器路径，用于指明解释执行当前脚本的解释器程序文件
常见的解释器
#! /bin/bash
#! /usr/bin/pythoon
#! /usr/bin/perl

#! /bin/bash
id user3 || useradd user3
echo &quot;user3&quot; | passwd --stdin user3

mktemp - d /text.XXXXXX
</code></pre></div><img src="D:\linux软件\linux运维\images\编写脚本.png" style="zoom:80%;"> <h3 id="_11-2-运行脚本"><a href="#_11-2-运行脚本" class="header-anchor">#</a> 11.2 运行脚本</h3> <ol><li>赋予执行权限，并直接运行此程序文件</li></ol> <div class="language- extra-class"><pre class="language-text"><code>chmod +x /PATH/TO/SCRIPT_FILE
</code></pre></div><ol start="2"><li>直接运行解释器，将脚本以命令行参数传递给解释器程序</li></ol> <div class="language- extra-class"><pre class="language-text"><code>bash /PATH/TO/SCRIPT_FILE

./m.sh 或者 bash m.sh
</code></pre></div><p><strong>注：脚本中除了开头，其余所有的行都会被视作注释行</strong></p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E8%84%9A%E6%9C%AC%E7%9A%84%E7%BB%83%E4%B9%A0%E9%A2%98.png" alt=""></p> <img src="D:\linux软件\linux运维\images\脚本练习2.png" style="zoom:80%;"> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E8%84%9A%E6%9C%AC%E8%81%94%E7%B3%BB4.png" alt=""></p> <h2 id="_12-grep-文本过滤工具"><a href="#_12-grep-文本过滤工具" class="header-anchor">#</a> 12 grep 文本过滤工具</h2> <div class="language- extra-class"><pre class="language-text"><code>grep [OPTIONS] PATTERN [FILE...]
grep [OPTIONS] [-e PATTERN] | -F FILE] [FILE...]
	OPTIONS:
		--color=auto: 对匹配到的文本着色后高亮显示
		-i: ignorecase, 忽略字符的大小写
		-o: 仅显示匹配到的字符串本身
		-v, --invert-match: 显示不能被模式匹配到的行
		-E: 支持使用扩展的正则表达式元字符
		-a, --quiet,--silent: 静默模式，即不输出任何信息
		
		-A #: after,后#行
		-B #: before, 前#行
		-C #: context, 前后各#行
</code></pre></div><img src="D:\linux软件\linux运维\images\正则.png" style="zoom:80%;"> <img src="D:\linux软件\linux运维\images\正则2.png" style="zoom:80%;"> <h3 id="_12-2-正则表达式"><a href="#_12-2-正则表达式" class="header-anchor">#</a> 12.2 正则表达式</h3> <p>####12.2.1 字符匹配</p> <table><thead><tr><th>符号</th> <th>说明</th></tr></thead> <tbody><tr><td>.</td> <td>匹配任意单个字符</td></tr> <tr><td>[]</td> <td>匹配指定范围内的任意单个字符</td></tr> <tr><td>[^]</td> <td>匹配指定范围外的任意单个单个字符</td></tr></tbody></table> <p>此外还有[:digit:]、[:lower:]、[:upper:]、[:alpha:]、[:alnum:]、[:punct:]、[:space:]</p> <p>eg:</p> <div class="language- extra-class"><pre class="language-text"><code>1. 显示/etc/passwd文件中不以/bin/bash 结尾的行
$ grep -v &quot;/bin/bash$&quot; /etc/passwd

2.找出/etc/passwd文件中的两位数或三位数
$ grep &quot;\&lt;[0-9]\{2,3\}\&gt;&quot; /etc/passwd

3.找出/etc/grub2.cfg文件中。以至少一个空白字符开头，且后面非空白字符的行
$ grep &quot;^[[:space:]\+[^[:space:]]&quot; /etc/grub2.cfg
</code></pre></div><h4 id="_12-2-2-匹配次数"><a href="#_12-2-2-匹配次数" class="header-anchor">#</a> 12.2.2 匹配次数</h4> <p>用于在指定其出现的次数的字符后面，用于限制其前面字符出现的次数；默认工作于贪婪模式</p> <table><thead><tr><th>字符</th> <th>说明</th></tr></thead> <tbody><tr><td>*</td> <td>匹配前面的字符任意次</td></tr> <tr><td>.*</td> <td>匹配任意长度的字符</td></tr> <tr><td>?</td> <td>取消贪婪模式，匹配前面的字符0次或1次</td></tr> <tr><td>\+</td> <td>匹配前面的字符1次或多次</td></tr> <tr><td>\{m\}</td> <td>匹配前面的字符m次</td></tr> <tr><td>\{m,n\}</td> <td>匹配m-n次</td></tr> <tr><td>\{m,\}</td> <td>匹配至少m次</td></tr></tbody></table> <h4 id="_12-2-3-位置锚定"><a href="#_12-2-3-位置锚定" class="header-anchor">#</a> 12.2.3 位置锚定</h4> <table><thead><tr><th>字符</th> <th>说明</th></tr></thead> <tbody><tr><td>^</td> <td>行首锚定，用于模式的最左侧</td></tr> <tr><td>$</td> <td>行尾锚定，用于模式的最右侧</td></tr> <tr><td>^PATTERN$</td> <td>用于PATTERN匹配整行</td></tr></tbody></table> <ul><li><code>^$</code>: 空白行</li> <li><code>^[[:space:]]*$</code>： 空行或包含空白字符的行</li></ul> <p><strong>单词</strong></p> <table><thead><tr><th>字符</th> <th>说明</th></tr></thead> <tbody><tr><td>\&lt; 或 \b</td> <td>词首锚定，用于单词模式的左侧</td></tr> <tr><td>\&gt; 或 \b</td> <td>词尾锚定，用于单词模式的右侧</td></tr> <tr><td>\&lt;PATTENRN\&gt;</td> <td>匹配完整单词</td></tr></tbody></table> <p>匹配0-9的数字2-3次</p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E6%AD%A3%E5%88%993.png" alt=""></p> <h4 id="_12-2-4-分组和引用"><a href="#_12-2-4-分组和引用" class="header-anchor">#</a> 12.2.4 分组和引用</h4> <p><code>\(\)</code>：将一个或多个字符捆绑在一起，当作一个整体处理 如：<code>\(xy\)*ab</code></p> <ul><li>\1: 模式从左侧起，第一个左括号及与之匹配的右括号之间的模式所匹配到的字符</li> <li>\2: 模式从左侧起，第二个左括号及与之匹配的右括号之间的模式所匹配到的字符</li> <li>\3：...</li></ul> <div class="language- extra-class"><pre class="language-text"><code>grep &quot;\(l..e\).*\1&quot; lovers.txt
</code></pre></div><h2 id="_13-egrep-扩展正则表达式"><a href="#_13-egrep-扩展正则表达式" class="header-anchor">#</a> 13 egrep 扩展正则表达式</h2> <ul><li>grep: 基本正则表达式，-E, -F</li> <li>egrep: 扩展正则表达式， -G, -F</li> <li>fgrep : 不支持正则表达式</li></ul> <div class="language- extra-class"><pre class="language-text"><code>egrep [OPTIONS] PATTERN [FILE...]
	选项：-i, -o, -v, -q, -A, -B, -C
	-G: 支持基本正则表达式
</code></pre></div><h3 id="_13-1-扩展正则表达式的元字符"><a href="#_13-1-扩展正则表达式的元字符" class="header-anchor">#</a> 13.1 扩展正则表达式的元字符</h3> <p><strong>字符匹配：</strong></p> <table><thead><tr><th>符号</th> <th>说明</th></tr></thead> <tbody><tr><td>.</td> <td>任意单个字符</td></tr> <tr><td>[]</td> <td>指定范围内的任意单个字符</td></tr> <tr><td>[^]</td> <td>指定范围外的任意单个字符</td></tr></tbody></table> <p><strong>次数匹配</strong></p> <table><thead><tr><th>符号</th> <th>说明</th></tr></thead> <tbody><tr><td>*</td> <td>任意次，0，1或多次</td></tr> <tr><td>?</td> <td>0次或1次，其前的字符可有可无</td></tr> <tr><td>+</td> <td>其前字符至少1次</td></tr> <tr><td>{m}</td> <td>其前的字符m次</td></tr> <tr><td>{m,n}</td> <td>至少m次，至多n次，{0，n}匹配至多n次， {m, }匹配至少m次</td></tr></tbody></table> <p><strong>位置锚定</strong></p> <table><thead><tr><th>符号</th> <th>说明</th></tr></thead> <tbody><tr><td>^</td> <td>行首锚定</td></tr> <tr><td>$</td> <td>行尾锚定</td></tr> <tr><td>\&lt;, \b</td> <td>词首锚定</td></tr> <tr><td>\&gt;, \b</td> <td>词尾锚定</td></tr></tbody></table> <p><strong>分组及引用</strong></p> <p>(): 分组：括号内的模式匹配到的字符会被记录于正则表达式引擎的内部变量中，后向引用：\1, \2,...</p> <p><strong>或</strong></p> <div class="language- extra-class"><pre class="language-text"><code>a|b: a或者b;
C|cat C或者cat
(C|c)at Cat或者cat
</code></pre></div><img src="D:\linux软件\linux运维\images\egrep.png" style="zoom:80%;"> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Cegrep2.png" alt=""></p> <div class="language- extra-class"><pre class="language-text"><code>grep -E ... == egrep ...

grep -E &quot;^([^:+\&gt;]).*\1$&quot; /etc/passwd #开头不为空匹配1次或多次取出第一个括号里面的以前面那个结尾的
</code></pre></div><p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Cegrep5.png" alt=""></p> <h2 id="_14-fgrep-不支持正则表达式元字符"><a href="#_14-fgrep-不支持正则表达式元字符" class="header-anchor">#</a> 14 fgrep 不支持正则表达式元字符</h2> <h3 id="_14-1-文本查看及处理工具"><a href="#_14-1-文本查看及处理工具" class="header-anchor">#</a> 14.1 文本查看及处理工具</h3> <p>文本查看及处理工具 <code>wc, cut,</code></p> <h4 id="_14-1-1-wc-word-count"><a href="#_14-1-1-wc-word-count" class="header-anchor">#</a> 14.1.1 wc word count</h4> <div class="language- extra-class"><pre class="language-text"><code>wc [OPTION]... [FILE]...
	-l: lines
	-w: words
	-c: bytes
</code></pre></div><h4 id="_14-1-2-cut"><a href="#_14-1-2-cut" class="header-anchor">#</a> 14.1.2 cut</h4> <div class="language- extra-class"><pre class="language-text"><code>cut OPTION... [FILE]...
	OPTION:
		-d CHAR: 以指定的字符为分隔符
		-f FILEDS: 挑选出的字段
			#: 指定的单个字段
			#-#: 连续的多个字段
			#,#: 离散的多个字段
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>cut -d: -f1,3-5,7 /etc/passwd
从/etc/passwd截出 以:分隔,取出1,3-5,7的字段
</code></pre></div><p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Cegrep4.png" alt=""></p> <h4 id="_14-1-3-sort"><a href="#_14-1-3-sort" class="header-anchor">#</a> 14.1.3 sort</h4> <div class="language- extra-class"><pre class="language-text"><code>sort [OPTION]...[FILE]...
	-n: 基于数值大小而非字符进行排序
	-t CHAR: 指定分隔符
	-k #: 用于排序比较的字段
	-r: 逆序排序
	-f: 忽略字符大小写
	-u: 重复的行只保留一份；重复行，连续且相同
</code></pre></div><p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Csort.png" alt=""></p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Csort2.png" alt=""></p> <h4 id="_14-1-4-uniq"><a href="#_14-1-4-uniq" class="header-anchor">#</a> 14.1.4 uniq</h4> <p>报告或移除重复的行</p> <div class="language- extra-class"><pre class="language-text"><code>uniq [OPTION]...[INPUT [OUTPUT]]
	-c: 显示每行的重复次数
	-u: 仅显示未曾重复过的行
	-d: 仅显示重复过的行
</code></pre></div><p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Csort3.png" alt=""></p> <h4 id="_14-1-5-diff"><a href="#_14-1-5-diff" class="header-anchor">#</a> 14.1.5 diff</h4> <div class="language- extra-class"><pre class="language-text"><code>compare files line by line
diff [OPTION]...FILES
diff /PATH/TO/OLDFILE /PATH/TO/NEWFILE &gt; /PATH/TO/PATCH_FIEL
	-u: 使用unfied机制，即显示要修改的行的上下文，默认为3行
</code></pre></div><h4 id="_14-1-6-patch-向文件打补丁"><a href="#_14-1-6-patch-向文件打补丁" class="header-anchor">#</a> 14.1.6 patch: 向文件打补丁</h4> <div class="language- extra-class"><pre class="language-text"><code>patch [OPTIONS] -i /PATH/TO/PATCH_FILE /PATH/TO/OLDFILE

patch /PATH/TO/OLDFILE &lt; /PATH/TO/PATCH_FILE
</code></pre></div><h2 id="_15-文件查找"><a href="#_15-文件查找" class="header-anchor">#</a> 15 文件查找</h2> <h3 id="_15-1-locate"><a href="#_15-1-locate" class="header-anchor">#</a> 15.1 locate</h3> <p>locate 依赖于事先构建好的索引库 系统自动实现（周期性任务），手动更新数据库（updatedb）</p> <p><strong>工作特性</strong></p> <ul><li>查找速度快</li> <li>模糊查找</li> <li>非实时查找</li></ul> <p><strong>语法</strong></p> <div class="language- extra-class"><pre class="language-text"><code>location [option]... PATTERN...
	-b: 只匹配路径中的基名
	-c: 统计出共有多少个符合的文件
	-r: BRE
</code></pre></div><p>==注：索引构建过程需要遍历整个根文件系统，极消耗资源==</p> <h3 id="_15-2-find"><a href="#_15-2-find" class="header-anchor">#</a> 15.2 find</h3> <p>实时查找工具，通过遍历指定路径下文件系统层级结构完成文件查找</p> <p><strong>工作特性</strong></p> <ul><li>查找速度略慢</li> <li>精确查找</li> <li>实时查找</li></ul> <p><strong>用法</strong></p> <div class="language- extra-class"><pre class="language-text"><code>find [options] [查找起始路径] [查找条件] [处理动作]
	查找起始路径：指定具体搜索目标起始路径，默认为当前目录
	查找条件：指定的查找标准，可根据文件名、大小、类型、从属关系、权限等标准进行；默认为找出指定路径下的所有文件
	处理动作：对符合查找条件的文件做出的操左，例如删除等操作；默认为输出值标准输出
</code></pre></div><h4 id="_15-2-1-查找条件"><a href="#_15-2-1-查找条件" class="header-anchor">#</a> 15.2.1 查找条件</h4> <p>表达式：选项和测试</p> <p>测试：（结果通常为布尔型）</p> <ul><li>根据文件名查找：（支持glob风格的通配符 *,?, [], [^]）
<ul><li><code>-name &quot;pattern&quot;</code></li> <li><code>-iname &quot;pattern&quot;</code></li> <li><code>-regex pattern: 基于正则表达式模式查找文件，匹配是整个路径，而非基名</code></li></ul></li></ul> <img src="D:\linux软件\linux运维\images\find-name.png" style="zoom:67%;"> <p>此外还可以比如</p> <div class="language- extra-class"><pre class="language-text"><code>find /etc -iname &quot;passwd?&quot;
find /etc -iname &quot;passwd[[:alnum:]]&quot;
</code></pre></div><ul><li>根据文件从属关系查找
<ul><li><code>-user USERNAME</code>: 查找属主指定用户的所有文件</li> <li><code>-group GRPNAME</code>: 查找属组指定组的所有文件</li> <li><code>-uid UID</code>: 查找 属主 指定 UID 的所有文件</li> <li><code>-gid UID</code>: 查找 属组 指定 GID 的所有文件</li> <li><code>-nouser</code>:查找没有属主的文件</li> <li><code>-nogroup</code>: 查找没有属组的文件</li></ul></li></ul> <img src="D:\linux软件\linux运维\images\find-ug.png" style="zoom:50%;"> <p>此外查找其他的</p> <div class="language- extra-class"><pre class="language-text"><code>find /tmp -nouser # 查找没有属主的
find /tmp -nogroup # 查找没有属组的
</code></pre></div><ul><li><p>-a 与，默认为与</p></li> <li><p>-o 或</p></li> <li><p>-not 或 ! 非</p></li> <li><p>根据文件的类型查找</p> <ul><li><code>-type TYPE</code></li> <li>f: 普通文件</li> <li>d: 目录文件</li> <li>l: 符号链接文件</li> <li>b: 块设备文件</li> <li>c: 字符设备文件</li> <li>p: 管道文件</li> <li>s: 套接字文件</li></ul> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Cfind2.png" alt=""></p></li> <li><p>根据文件的大小查找</p> <ul><li><code>-size [+|-]#UNIT</code>, 常用单位: k,M,G</li> <li>#UNIT: (#-1, #)</li> <li>-#UNIT: [0, #-1]</li> <li>+#UNIT: (#, 正无穷)</li></ul></li></ul> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Cfind3.png" alt=""></p> <ul><li><p>以时间戳查找</p> <ul><li>以天为单位：<code>-atiem [+|-]#</code>,
<ul><li>#: [#: #-1]</li> <li>-#: (#, 0)</li> <li>+#: (无穷, 0)</li> <li>-mtime</li> <li>-ctime</li></ul></li> <li>以分钟为单位:<code>-amin</code>, <code>-mmin</code>,<code>-cmin</code></li></ul></li></ul> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Cfind5.png" alt=""></p> <ul><li>根据权限查找<code>-perm [/|-]mode</code> <ul><li>mode: 精确权限匹配</li> <li>/mode: 任何一类用户(u,g,o)的权限中的任何一位(r,w,x)符合条件即满足，9位权限之间存在&quot;或&quot;关系</li> <li>-mode: 每一类用户(u,g,o)的权限中的每一位(r,w,x)同时符合条件即满足;9位权限之间存在&quot;与&quot;关系</li></ul></li></ul> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Cfind4.png" alt=""></p> <h4 id="_15-2-2-处理动作"><a href="#_15-2-2-处理动作" class="header-anchor">#</a> 15.2.2 处理动作</h4> <ul><li><code>-print</code>: 输出至标准输出，默认的动作</li> <li><code>-ls</code>: 类似于对查找到的文件执行<code>-ls -l</code>命令，输出文件的详细信息</li> <li><code>-delete</code>: 删除查找到的文件</li> <li><code>-fls /PATH/TO/SOMEFILE</code>: 把查找到的所有文件的长格式信息保存至指定文件中</li> <li><code>-ok COMMAND {}\;</code> : 对查找到的每个文件执行由COMMAND表示的命令；每次操作都有用户进行确认</li> <li><code>-exec COMMAND {}\;</code> : 对查找到的每个文件执行由COMMAND表示的命令</li></ul> <p>注：find传递查找到的文件路径至后面的命令时，是先查找出所有符合条件的文件路径，并一次性传递给后面的命令，但是有些命令不能接受过长的参数，此时命令执行失败，可使用<code>find | xargs COMMAND</code></p> <p>找出/tmp目录下属主位非root,而且文件名不包含fstab字符串文件</p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Cfind.png" alt=""></p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Cfind1.png" alt="find1"></p> <h2 id="_16-vim-和-vi"><a href="#_16-vim-和-vi" class="header-anchor">#</a> 16 vim 和 vi</h2> <h3 id="_16-1-三种模式"><a href="#_16-1-三种模式" class="header-anchor">#</a> 16.1 三种模式</h3> <h4 id="_16-1-1模式转换"><a href="#_16-1-1模式转换" class="header-anchor">#</a> <strong>16.1.1模式转换</strong></h4> <p>输入模式-&gt;编辑模式 <code>ESC</code></p> <p>编辑模式-&gt;末行模式 <code>:</code></p> <p>末行模式-&gt;编辑模式 <code>ESC</code></p> <h4 id="_16-1-2-编辑模式-输入模式"><a href="#_16-1-2-编辑模式-输入模式" class="header-anchor">#</a> 16.1.2 编辑模式-&gt;输入模式</h4> <ul><li><code>i</code>: 在光标所在处输入</li> <li><code>a</code>: append, 在光标所在处后方输入</li> <li><code>O</code>: 在光标所在处的下方打开一个新行</li> <li><code>I</code>: 在光标所在行的行首输入</li> <li><code>A</code>: 在光标所在行的行尾输入</li> <li><code>O</code>(大写的): 在光标所在处的上方打开一个新行</li></ul> <img src="D:\webstorm\html\基础\CSS\css背景\images\Snipaste_2020-09-20_10-29-40.png" alt="Snipaste_2020-09-20_10-29-40" style="zoom:80%;"> <h3 id="_16-2-打开文件"><a href="#_16-2-打开文件" class="header-anchor">#</a> 16.2 打开文件</h3> <div class="language- extra-class"><pre class="language-text"><code>vim [option] [file...]
+# 打开文件后，直接让光标处于第#行的行首
+/PATTERN: 打开文件后，直接让光标处于第一个被PATTERN匹配到的行的行首
</code></pre></div><h3 id="_16-3-关闭文件"><a href="#_16-3-关闭文件" class="header-anchor">#</a> 16.3 关闭文件</h3> <table><thead><tr><th>命令</th> <th>英文</th> <th>功能</th></tr></thead> <tbody><tr><td>w</td> <td>write</td> <td>保存</td></tr> <tr><td>q</td> <td>quit</td> <td>退出，如果没有保存不允许退出</td></tr> <tr><td>q!</td> <td>quit</td> <td>强行退出，不保存退出</td></tr> <tr><td>wq</td> <td>write &amp; quit</td> <td>保存并退出</td></tr> <tr><td>x</td> <td></td> <td>保存并退出</td></tr></tbody></table> <div class="language- extra-class"><pre class="language-text"><code>:wq
:x
</code></pre></div><h3 id="_16-4-光标跳转"><a href="#_16-4-光标跳转" class="header-anchor">#</a> 16.4 光标跳转</h3> <p>####16.4.1 字符间跳转</p> <table><thead><tr><th>字符</th> <th>说明</th></tr></thead> <tbody><tr><td>h</td> <td>左</td></tr> <tr><td>J</td> <td>下</td></tr> <tr><td>k</td> <td>上</td></tr> <tr><td>l</td> <td>右</td></tr></tbody></table> <p>#COMMAND: 跳转由#指定的个数的字符</p> <h4 id="_16-4-2-单词间跳转"><a href="#_16-4-2-单词间跳转" class="header-anchor">#</a> 16.4.2 单词间跳转</h4> <ul><li><code>w</code>: 下一个单词的词首</li> <li><code>e</code>: 当前或后一个单词的词尾</li> <li><code>b</code>: 当前或前一个单词的词首</li></ul> <p>#COMMAND: 跳转由#指定的个数的单词</p> <h4 id="_16-4-3-行首行尾跳转"><a href="#_16-4-3-行首行尾跳转" class="header-anchor">#</a> 16.4.3 行首行尾跳转</h4> <ul><li><p><code>^</code>: 跳转至行首的第一个非空白字符</p></li> <li><p><code>o</code>:  跳转至行首</p></li> <li><p><code>$</code>: 跳转至行尾</p></li></ul> <h4 id="_16-4-4-行间跳转"><a href="#_16-4-4-行间跳转" class="header-anchor">#</a> 16.4.4 行间跳转</h4> <ul><li><code>#G</code>: 跳转至由#指定的行</li> <li><code>1G,gg</code>: 第一行</li> <li><code>G</code>: 最后一行</li></ul> <h4 id="_16-4-5-句间跳转"><a href="#_16-4-5-句间跳转" class="header-anchor">#</a> 16.4.5 句间跳转</h4> <ul><li><p><code>(</code></p></li> <li><p><code>)</code></p></li></ul> <h4 id="_16-4-6-段间跳转"><a href="#_16-4-6-段间跳转" class="header-anchor">#</a> 16.4.6 段间跳转</h4> <ul><li><p><code>{</code></p></li> <li><p><code>}</code></p></li></ul> <h3 id="_16-5-翻屏"><a href="#_16-5-翻屏" class="header-anchor">#</a> 16.5 翻屏</h3> <ul><li><code>ctrl+f</code>: 向文件尾翻一屏</li> <li><code>ctrl+b</code>: 向文件首部翻一屏</li> <li><code>ctrl+d</code>: 向文件尾部翻半屏</li> <li><code>ctrl+u</code>: 向文件首部翻半屏</li> <li><code>enter</code>: 按行向后翻</li></ul> <h3 id="_16-6-编辑命令"><a href="#_16-6-编辑命令" class="header-anchor">#</a> 16.6 编辑命令</h3> <h4 id="_16-6-1-字符编辑"><a href="#_16-6-1-字符编辑" class="header-anchor">#</a> 16.6.1 字符编辑</h4> <ul><li><code>x</code>: 删除光标所在处的字符</li> <li><code>#x</code>: 删除光标所在处起始的<code>#</code> 个字符</li> <li><code>xp</code>: 交换光标所在处的字符与其后面的字符的位置</li></ul> <h4 id="_16-6-2-替换命令-replace"><a href="#_16-6-2-替换命令-replace" class="header-anchor">#</a> 16.6.2 替换命令(replace)</h4> <ul><li><code>r</code> : 替换光标所在处的字符<code>rCHAR</code></li></ul> <h4 id="_16-6-3-删除命令"><a href="#_16-6-3-删除命令" class="header-anchor">#</a> 16.6.3 删除命令</h4> <ul><li><code>d</code>: 删除命令，可结合光标跳转字符，实现范围删除</li> <li><code>d$</code>: 从光标处删除到行尾;    <code>d^</code>: 行首到光标处删除； dw ; de; db #COMMAND;</li> <li><code>dd</code>: 删除光标所在的行
<ul><li><code>#dd</code>: 删除光标所处的行起始的共<code>#</code>行</li></ul></li></ul> <p>###16.7 粘贴命令(p,put,paste)</p> <ul><li><code>p</code>: 缓存区的内容如果为整行，则粘贴在当前光标所在行的下方；否则，则粘贴至当前光标所在处的后方</li> <li><code>P</code>（大写）: 缓冲区的内容如果为整行，则粘贴在当前光标所在行的上方；否则，则粘贴至当前光标所在处的前方</li></ul> <h3 id="_16-8-复制命令-yank-y"><a href="#_16-8-复制命令-yank-y" class="header-anchor">#</a> 16.8 复制命令(yank,y)</h3> <ul><li><code>y</code>: 复制，工作行为相似于d命令
<ul><li><code>y$</code> <code>y^</code> <code>yo</code> <code>ye</code> <code>yw</code> <code>yb</code>  #COMMAND</li> <li><code>yy</code>: 复制一整行 <code>#yy</code>: 复制#行</li></ul></li></ul> <h3 id="_16-9-改变命令-change-c"><a href="#_16-9-改变命令-change-c" class="header-anchor">#</a> 16.9 改变命令(change, c)</h3> <p>编辑模式-&gt; 输入模式，实现删除操作</p> <ul><li><code>c$</code> <code>c^</code> <code>co</code> <code>cb</code> <code>ce</code> <code>cw</code> #COMMAND</li> <li><code>cc</code> : 删除光标所在的行，并转换为输出模式；<code>#cc</code></li></ul> <h3 id="_16-10-vim末行模式"><a href="#_16-10-vim末行模式" class="header-anchor">#</a> 16.10 vim末行模式</h3> <h4 id="_16-10-1-地址定界"><a href="#_16-10-1-地址定界" class="header-anchor">#</a> 16.10.1 地址定界</h4> <ul><li><p><code>:start_pos[,end_pos]</code></p> <ul><li><code>#</code>: 特定的<code>#</code>行，例如5即第5行</li> <li><code>.</code>: 当前行</li> <li><code>$</code>: 最后一行</li> <li><code>#,#</code>: 指定行范围，左侧为起始行，右侧为结束行</li> <li><code>#, #</code>: 指定行范围，左侧为超始行绝对编号，右侧为相对左侧行号的偏移量；例如: 3,+7
<ul><li>., $-1</li> <li>1, $</li></ul></li></ul> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E6%9F%A52.png" alt=""></p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E6%9F%A52.png" alt=""></p> <ul><li><code>%</code>: 全文</li> <li><code>/pattern/</code>: 从光标所在处起始，第一次由part1匹配到的行开始，至第一次由part2匹配到的行结束之间的所有行</li> <li><code>/part1/,/part2/</code>： 从光标所在处起始，第一次由part1匹配到的行开始，至第一次由part2匹配到的行结束之间的所有行</li></ul></li> <li><p>可同编辑命令一同使用，实现编辑操作</p> <ul><li><code>d</code>,   <code>y</code>  , <code>c</code></li> <li><code>w /PATH/TO/SOMEFILE</code>： 将范围内的文本保存至指定的文件中</li> <li><code>r /PATH/FROM/SOMEFILE</code>: 将指定的文件中的文本读取并插入至指定位置</li></ul></li> <li><p>查找</p> <ul><li><code>/PATTERN</code>: 从当前光标所在处向文件尾部查找能够被当前模式匹配到的所有字符串</li> <li><code>?PATTERN</code>: 从当前光标所在处向文件首部查找能够被当前模式匹配到的所有字符串
<ul><li><code>n</code>: 下一个，与命令方向相同</li> <li><code>N</code>: 上一个，与命令方向相反</li></ul></li></ul></li> <li><p>查找并替换</p> <ul><li><code>s</code>: 末行模式的命令：使用格式
<ul><li>s/要查找的内容/替换为内容/修饰符
<ul><li>要查找的内容：使用正则表达式</li> <li>替换为的内容：不能使用下则表达式，但可以引用</li> <li>如果“要查找的内容”部分在模式中使用分组符号，在“替换为的内容”中使用后向引用</li> <li>直接引用查找模式匹配到的全部文本，要使用&amp;符号</li></ul></li> <li>修饰符
<ul><li><code>i</code>: 忽略大小写</li> <li><code>g</code>: 全局替换，意味着一行中如果匹配到多次，则均替换</li></ul></li> <li>可把分隔符替换为其它非常用字符
<ul><li>s@@@</li> <li>s###</li></ul></li></ul></li></ul></li></ul> <p>示例：</p> <div class="language- extra-class"><pre class="language-text"><code>%s@\t[[:alpha:]]\+@&amp;er@g #&amp; 表示前面查找到的字符串，将t开头的一个或多个字母后面加上er,全局 替换
</code></pre></div><p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E6%9F%A51.png" alt=""></p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E6%9F%A5%E6%89%BE%E5%92%8C%E6%9B%BF%E6%8D%A2.png" alt="查找和替换"></p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E6%9F%A53.png" alt=""></p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E6%9F%A54.png" alt="查4"></p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E6%9F%A55.png" alt="查5"></p> <h3 id="_16-11-其他编辑操作"><a href="#_16-11-其他编辑操作" class="header-anchor">#</a> 16.11 其他编辑操作</h3> <h5 id="可视化模式"><a href="#可视化模式" class="header-anchor">#</a> <strong>可视化模式</strong></h5> <ul><li><code>v</code>: 按字符选定</li> <li><code>V</code>：(按行选定)</li></ul> <p>结合编辑命令使用：<code>d, c, y</code></p> <h5 id="撤销-undo-操作"><a href="#撤销-undo-操作" class="header-anchor">#</a> <strong>撤销(undo)操作</strong></h5> <ul><li><p><code>u</code>: 撤销此前的操作</p> <ul><li><code>#u</code>: 撤销此前的<code>#</code> 个操作</li></ul></li></ul> <h5 id="撤销此前的撤销"><a href="#撤销此前的撤销" class="header-anchor">#</a> 撤销此前的撤销</h5> <ul><li><code>ctrl+r</code></li></ul> <p>vim自带的练习教程：<code>vimtutor</code></p> <h3 id="_16-12-vim的多文件功能"><a href="#_16-12-vim的多文件功能" class="header-anchor">#</a> 16.12 vim的多文件功能</h3> <h4 id="多文件"><a href="#多文件" class="header-anchor">#</a> 多文件</h4> <div class="language- extra-class"><pre class="language-text"><code>vim FILE1 FILE2...
</code></pre></div><p><strong>在文件间切换</strong></p> <table><thead><tr><th>符号</th> <th>说明</th></tr></thead> <tbody><tr><td>:next</td> <td>下一个</td></tr> <tr><td>:prev</td> <td>上一个</td></tr> <tr><td>:first</td> <td>第一个</td></tr> <tr><td>:last</td> <td>最后一个</td></tr></tbody></table> <p><strong>退出所有文件</strong></p> <table><thead><tr><th>符号</th> <th>说明</th></tr></thead> <tbody><tr><td>:wqall</td> <td>保存所有文件并退出</td></tr> <tr><td>:wall</td> <td>保存所有文件</td></tr> <tr><td>:qall</td> <td>退出所有文件</td></tr></tbody></table> <h4 id="多窗口"><a href="#多窗口" class="header-anchor">#</a> 多窗口</h4> <table><thead><tr><th>符号</th> <th>说明</th></tr></thead> <tbody><tr><td>-o</td> <td>水平分隔窗口</td></tr> <tr><td>-O</td> <td>垂直分隔窗口</td></tr></tbody></table> <p>在窗口间切换：<code>ctrl+w</code></p> <p>注：单个文件也可以分隔围殴多个窗口查看</p> <ul><li><code>ctrl+w,s</code>: 水平分割窗口</li> <li><code>ctrl+w,v</code>: 垂直分割窗口</li></ul> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E7%AA%97%E5%8F%A32.png" alt="窗口2"></p> <div class="language- extra-class"><pre class="language-text"><code>vim -o a.txt a_d/a.txt # 水平分割窗口
</code></pre></div><img src="D:\linux软件\linux运维\images\窗口1.png" style="zoom:50%;"> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E7%AA%97%E5%8F%A33.png" alt="窗口3"></p> <h2 id="_17-文件管理系统"><a href="#_17-文件管理系统" class="header-anchor">#</a> 17 文件管理系统</h2> <h3 id="_17-1-管理文件的权限"><a href="#_17-1-管理文件的权限" class="header-anchor">#</a> 17.1 管理文件的权限</h3> <h4 id="_17-1-suid"><a href="#_17-1-suid" class="header-anchor">#</a> 17.1 SUID</h4> <p>用户运行某程序时，如果此程序拥有SUID权限，则程序运行为进程时，进程的属主不是发起者，而是程序文件的属主</p> <div class="language- extra-class"><pre class="language-text"><code>chmod u+|-s FILE...
</code></pre></div><p>属主的执行权限位；如果属主原本有执行权限，显示为<code>s</code>; 否则显示为<code>S</code>;</p> <h4 id="_7-2-sgid"><a href="#_7-2-sgid" class="header-anchor">#</a> 7.2 SGID</h4> <p>当目录属组有写权限，且有SGID权限时，则所有属于此目录的属组，且以属组身份在此目录中新建文件或目录时，新文件的属组不是用户的基本组，而是此目录的属组</p> <p>管理文件的SGID权限</p> <div class="language- extra-class"><pre class="language-text"><code>chmod g+|-s FILE...
</code></pre></div><h4 id="_17-3-sticky"><a href="#_17-3-sticky" class="header-anchor">#</a> 17.3 sticky</h4> <p>对于属组或全局可写的目录，组内所有用户或系统上的所有用户在此目录中都能创建新文件或删除所有的已有文件；如果为此类目录设置sticky权限，则每个用户都能创建新文件，且只能删除自己的文件</p> <p>管理文件的sticky权限</p> <div class="language- extra-class"><pre class="language-text"><code>chmod o+|-t FILE...
</code></pre></div><ul><li><p>展示位置：其他用户的执行权限位；</p></li> <li><p>如果其他用户原本有执行权限，显示为小写t;</p></li> <li><p>否则，显示为大写T</p></li></ul> <p>系统上的<code>/tmp</code>和<code>/var/tmp</code>目录默认有sticky权限</p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E6%96%87%E4%BB%B61.png" alt=""></p> <p>管理权限的另一方式：</p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E6%96%87%E4%BB%B62.png" alt=""></p> <h4 id="_17-1-4-facl-文件的额外赋权机制"><a href="#_17-1-4-facl-文件的额外赋权机制" class="header-anchor">#</a> 17.1.4 facl 文件的额外赋权机制</h4> <p>在原来的u,g,o之外，另一层让普通用户能控制赋权给另外的用户或组的赋权机制</p> <p><strong>getfacl命令</strong></p> <div class="language- extra-class"><pre class="language-text"><code>getfacl FILE...
	user:USERNAME:MODE
	group:GROUPNAME:MODE
</code></pre></div><p><strong>setfacl命令</strong></p> <div class="language- extra-class"><pre class="language-text"><code>赋权给用户：setfacl -m u:USERNAME:MODE FILE...
赋权给组：setfacl -m g:GROUPNAME:MODE FILE...
撤销赋权：setfacl -x u:USERNAME FILE...
		setfacl -x g:GROUPNAME FILE...
</code></pre></div><h3 id="_17-2-文件系统管理工具"><a href="#_17-2-文件系统管理工具" class="header-anchor">#</a> 17.2 文件系统管理工具</h3> <ul><li>创建文件系统的工具 mkfs</li> <li>检测及修复文件系统的工具 fsck
<ul><li>-t fstype:指明文件系统类型</li> <li>-a: 无需交互自动修复所有错误</li> <li>-r:交互式修复</li></ul></li></ul> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E6%96%87%E4%BB%B63.png" alt=""></p> <ul><li>查看其属性的工具 dumpe2fs, tune2fs</li> <li>调整文件系统特性 tune2fs</li></ul> <div class="language- extra-class"><pre class="language-text"><code>mkfs.ext2 /dev/sda3 # 创建文件系统
tune2fs -m 2 /dev/sda3 # 调整块的百分比
</code></pre></div><h4 id="ext系列文件系统管理工具"><a href="#ext系列文件系统管理工具" class="header-anchor">#</a> ext系列文件系统管理工具</h4> <p>mkfs.ext2, mkfs.ext3, mkfs.ext4</p> <p>mkfs -t ext2 = mkfs.ext2</p> <p>ext系列文件系统专用管理工具：mke2fs</p> <div class="language- extra-class"><pre class="language-text"><code>mke2fs [OPTIONS] device
	-t {ext2|ext3|ext4}: 指明要创建的文件系统类型 mkfs -t ext2 = mkfs.ext2
	-b {1024|2048|4096}: 指明文件系统的块大小
	-L LABEL: 指明卷标
	-J: 创建有日志功能的文件系统ext3
	-i #:指明inode与字节的比率
    -N #: 指明文件系统要创建的inode的数量
    -m #：指定预留的空间，百分比
    
    -O[^]FEATURE: 以指定的特性创建目标文件系统
</code></pre></div><p><strong>e2label命令</strong>:卷标的查看和设定</p> <ul><li>查看：<code>e2label device</code></li> <li>设定：<code>e2label device LABEL</code></li></ul> <p><strong>tune2fs命令</strong>：查看或修改ext系列文件系统的某些属性</p> <p>==注：块大小创建后不能修改==</p> <div class="language- extra-class"><pre class="language-text"><code>tune2fs [OPTIONS] device
	-l:查看超级块的内容
	
	修改指定文件系统的属性
		-J: ext2-&gt;ext3
		-L LABEL:修改卷标
		-m #: 调整预留百分比
		-O [^]FEATHER: 开启或关闭某种特性
		-o [^]mount_options: 开启或关闭某种默认挂载选项
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>tune2fs -O ^has_journal /dev/sda3
</code></pre></div><h4 id="fdisk命令"><a href="#fdisk命令" class="header-anchor">#</a> fdisk命令</h4> <h5 id="_1-查看磁盘的分区信息"><a href="#_1-查看磁盘的分区信息" class="header-anchor">#</a> 1. 查看磁盘的分区信息</h5> <div class="language- extra-class"><pre class="language-text"><code>fdisk -l [-u] [device...] 列出指定磁盘设备上的分区情况
</code></pre></div><p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E6%96%87%E4%BB%B64.png" alt=""></p> <h5 id="_2-管理分区"><a href="#_2-管理分区" class="header-anchor">#</a> 2 管理分区</h5> <div class="language- extra-class"><pre class="language-text"><code>fdisk device
</code></pre></div><p>fdisk提供了一个交互式接口管理分区，有许多子命令，分别用于不同的管理功能；所有操作都在内存中完成，没有直接同步到磁盘；直接使用w命令保存在磁盘上</p> <p>常用命令</p> <table><thead><tr><th>字符</th> <th>说明</th></tr></thead> <tbody><tr><td>n</td> <td>创建新分区</td></tr> <tr><td>d</td> <td>删除已有分区</td></tr> <tr><td>t</td> <td>修改分区类型</td></tr> <tr><td>l</td> <td>查看所有ID</td></tr> <tr><td>w</td> <td>保存并退出</td></tr> <tr><td>q</td> <td>不保存并退出</td></tr> <tr><td>m</td> <td>查看帮助信息</td></tr> <tr><td>p</td> <td>显示现有分区信息</td></tr></tbody></table> <p>==注：在已经分区并且挂载到其中某个分区的磁盘设备上创建的新分区，内核可能在创建完成后无法直接识别==</p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E6%96%87%E4%BB%B66.png" alt=""></p> <p>当硬盘容量&gt;4t时，需要使用parted命令</p> <div class="language- extra-class"><pre class="language-text"><code># 创建文件系统 
mkfs.ext4 /dev/vda

</code></pre></div><p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Cfdisk.png" alt=""></p> <p>检测文件系统是否损坏</p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E6%96%87%E4%BB%B65.png" alt=""></p> <p>具体信息可以看看下面这篇博客。</p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Cfdisk2.png" alt=""></p> <p>https://blog.csdn.net/weixin_46818279/article/details/107100401</p> <h5 id="_3-挂载-mount-和-unmount"><a href="#_3-挂载-mount-和-unmount" class="header-anchor">#</a> 3 挂载 mount 和 unmount</h5> <p>根文件系统外的其他文件要想能被访问，必须通过关联值根文件系统上的某个目录实现，此关联操作即为“挂载”；此目录即为“挂载点”</p> <p><strong>挂载点：mount_point: 用于作为另一个文件系统的访问入口</strong></p> <ul><li>事先存在</li> <li>应该使用未被或不会被其他进程使用到的目录</li> <li>挂载点下原有的文件将会被隐藏</li></ul> <div class="language- extra-class"><pre class="language-text"><code>mount [-fnrsvw] [-t vfstype] [-o options] device dir
	命令选项
	 -r: readonly,只读挂载
	 -w: read and write,读写挂载
	 -n: 默认情况下，设备挂载或卸载操作会同步更新至/etc/mtab文件中。-n用于禁止此特性
	 -t vfstype:指明要挂在的设备上的文件系统的类型；多数情况下可省略，此时mount会通过blkid来判断要挂在的设备的文件系统类型
	 -L LABEL: 挂载时以卷标的方式指明设备
	 -U UUID: 挂载时以UUID的方式指明设备；
	 	mount -L LABEL dir
	 	
	-o options; 挂载选项
		sync/async: 同步/异步操作
		atime/noatime: 文件或目录在被访问时更新其访问时间戳
		diratime/nodiratime: 目录在被访问时是否更新其访问时间戳
		remounnt: 重新挂载
		aci:支持使用facl功能
			# mount -o aci device dir
			# tune2fs -o aci device
		ro: 只读
		rw: 读写
		dev/nodev: 此设备上是否允许创建设备文件
		exec/noexec: 是否允许运行此设备上的程序文件
		auto/noauto:
		user/nouser: 是否允许运行此设备上的程序文件
		suid/nosuid: 是否允许程序文件上的suid和sgid特殊权限生效
		
		defaults: User default options: rw, suid, dev, exec, quto, nouser, async, relatime
</code></pre></div><p>​	<code>mount -a</code>： 可自动挂载定义在此文件中的所支持自动挂载的设备</p> <p><code>umount device|dir</code>: 取消挂载</p> <p>==注：正在被进程访问到的挂载点无法被卸载==</p> <ul><li>查看被哪个或哪些进程所占用</li></ul> <div class="language- extra-class"><pre class="language-text"><code>lsof MOUNT_POINT
fuser -v MOUNT_POINT
</code></pre></div><ul><li>终止所有正在访问某挂载点的进程</li></ul> <div class="language- extra-class"><pre class="language-text"><code>fuser -km MOUNT_POINT
</code></pre></div><h4 id="df-和-du"><a href="#df-和-du" class="header-anchor">#</a> df 和 du</h4> <p><strong>df命令</strong></p> <p>df查看磁盘使用情况。</p> <div class="language- extra-class"><pre class="language-text"><code>df [OPTION]...[FILE]...
	-l: 仅显示本地文件的相关信息
	-h: human-readable
	-i: 显示inode的使用状态而非blocks
</code></pre></div><img src="D:\linux软件\linux运维\images\df.png" style="zoom:67%;"> <img src="D:\linux软件\linux运维\images\df1.png" style="zoom:67%;"> <p><strong>du命令</strong></p> <p>du查看目录大小</p> <div class="language- extra-class"><pre class="language-text"><code>du [OPTION]...[FILE]...
	-s: sumary
	-h:human-readable
</code></pre></div><img src="D:\linux软件\linux运维\images\du.png" style="zoom:80%;"> <h2 id="_18-其他"><a href="#_18-其他" class="header-anchor">#</a> 18 其他</h2> <p>###18.1 mail</p> <div class="language- extra-class"><pre class="language-text"><code>mailx [-s 'subject'] username[@hostname]
	邮件正文的生成
	(1)交互式输入；. 单独成行可以表示正文结束; ctrl+d 提交也可
	(2)通过输入重定向
	(3)通过管道
</code></pre></div><img src="D:\linux软件\linux运维\images\mail.png" style="zoom:80%;"> <h3 id="_18-2-at命令"><a href="#_18-2-at命令" class="header-anchor">#</a> 18.2 at命令</h3> <div class="language- extra-class"><pre class="language-text"><code>at [OPTION]...TIME
	TIME:
		HH:MM [YYYY-mm-dd]
		noon, midnight,teatime
		now+#
</code></pre></div><p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Cat.png" alt=""></p> <h2 id="_19-程序包管理器"><a href="#_19-程序包管理器" class="header-anchor">#</a> 19 程序包管理器</h2> <p>程序包管理器功能：将编译好的应用程序的各组成文件打包成一个或几个程序包，从而更方便实现程序包的安装、升级、卸载和查询等管理操作</p> <p>源代码-&gt;目标二进制格式（二进制程序、库文件、配置文件、帮助文件）-&gt;组织称为一个或有限几个“包”文件</p> <p>向crond提交作业的方式不同于at,需要专用的配置文件，有固定的格式，不建议使用文本编辑器直接编辑，要使用</p> <p>crontab命令</p> <p><strong>cron任务的分类</strong></p> <ul><li>系统cron任务：主要用于事先系统自身的维护
<ul><li>手动编辑：/etc/crontab文件</li></ul></li> <li>用户cron任务
<ul><li>命令：crontab命令</li></ul></li></ul> <h3 id="_19-1-系统cron的配置格式-etc-crontab"><a href="#_19-1-系统cron的配置格式-etc-crontab" class="header-anchor">#</a> 19.1 系统cron的配置格式: /etc/crontab</h3> <ul><li>每一行定义一个周期性任务
<ul><li>***** 定义周期性时间</li> <li>user-name:运行任务的用户身份</li> <li>command to be executed: 任务</li></ul></li> <li>此处的环境变量不同于用户登录后获得的环境，因此，建议命令使用绝对路径，或者自定义path环境变量</li> <li>执行结果通过邮件发送给MAILTO指定的用户</li></ul> <h4 id="_19-1-1-时间表示法"><a href="#_19-1-1-时间表示法" class="header-anchor">#</a> 19.1.1 时间表示法</h4> <ul><li><p>特定值</p> <p>给定时间点有效范围内的值</p> <p>注意：day of week和day of month一般不同时使用</p></li> <li><ul><li></li></ul> <p>给定时间点上有效取值范围内的所有值；表示&quot;每&quot;</p></li> <li><p>离散取值</p> <p>在时间点上使用逗号分隔的多个值； <code>#,#,#</code></p></li> <li><p>连续取值</p> <p>在时间点上使用-连接开头和结束 <code>#-#</code></p></li> <li><p>在指定时间点上，定义步长； <code>/#</code>: #即为步长</p> <ul><li>指定的时间点不能被步长整除时，其意义将不复存在</li> <li>最小时间单位为“分钟”</li></ul></li></ul> <div class="language- extra-class"><pre class="language-text"><code>3 * * * *: 每小时执行一次，每小时的第3分钟
3 4 * * 5:每周执行一个，每周的4点3分
*/5 * * * *：每5分钟执行一次某任务
9 8 * * 3,7: 每周三和周日
</code></pre></div><p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Ccortab.png" alt=""></p> <p>###19.1.2 crontab命令</p> <div class="language- extra-class"><pre class="language-text"><code>crontab [-u user] [-l | -r | -e] [-i]
	-e: 编辑任务
	-l: 列出所有任务
	-r:移除所有任务；即删除/var/spllo/cron/USERNAME文件
	-i: 在使用-r选项移除所有任务时提示用户确认
	-u user: root用户可谓指定用户管理cron任务
</code></pre></div><p>注：运行结果以邮件通知给当前用户，如果拒绝接收邮件</p> <ul><li>COMMAND &gt; /dev/null</li> <li>COMMAND &amp;&gt; /dev/null</li></ul> <p>定义COMMAND时，如果命令需要用到%,需要对其转义；但放置于单引号中的%不用转义即可</p> <p>如果某任务在指定的时间因关机未能按时执行，下次开机不会自动执行，可用anacron实现自动执行</p> <h3 id="_19-2-获取程序包的途径"><a href="#_19-2-获取程序包的途径" class="header-anchor">#</a> 19.2 获取程序包的途径</h3> <p>http://mirrors.aliyun.com, http://mirrors.sohu.com, http://mirrors.163.com，反正要官方就对了</p> <h3 id="_19-3-rpm命令管理程序包"><a href="#_19-3-rpm命令管理程序包" class="header-anchor">#</a> 19.3 rpm命令管理程序包</h3> <p>/var/lib/rpm/</p> <div class="language- extra-class"><pre class="language-text"><code>rpm [OPTIONS] [PACKAGE_FILE]
	安装: -i, --install
	升级: -U, --update, -F, --freshen
	卸载: -e, --erase
	查询: -q, --query
	校验: -V, --verify
	数据库维护: --builddb, --initdb
</code></pre></div><h4 id="_19-3-1-rpm安装"><a href="#_19-3-1-rpm安装" class="header-anchor">#</a> 19.3.1 rpm安装</h4> <div class="language- extra-class"><pre class="language-text"><code>rpm {-i|--install} {install-options} PACKAGE_FILE...

rpm -ivh PACKAGE_FILE...
	GENERAL OPTIONS:
		-v: 详细信息
		-vv: 更详细的输出
	[install-options]:
		-h: hash marks输出进度条，每个#表示2%的进度
		--test: 测试安装，检查并报告依赖关系及冲突消息等
		--nodeps: 忽略依赖关系；不建议
		--replacepkgs: 重新安装
		
		注意: rpm 可以自带脚本
			四类: --noscripts(无脚本)
				preinstall: 安装过程开始之前运行的脚本,%pre, --nopre
				postinstall: 安装过程完成之后运行的脚本, %post, --nopost
				preuninstall: 卸载过程真正开始执行之前运行的脚本，%preun,--nopreun
				postuninstall: 卸载过程完成之后运行的脚本，%postun,--nopostun
		
		--nosignautre: 不检查包签名信息，不检查来源合法性
		--nodigest: 不检查啊包完整性信息
</code></pre></div><p>因为我用的是ubuntu所以需要用alien。</p> <p>参考博客https://blog.csdn.net/suleil1/article/details/49471723</p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Crpm.png" alt=""></p> <h4 id="_19-3-2-rpm升级"><a href="#_19-3-2-rpm升级" class="header-anchor">#</a> 19.3.2 rpm升级</h4> <div class="language- extra-class"><pre class="language-text"><code>rpm {-U|--upgrade} {install-options} PACKGE_FILE...
rpm {-F|--freshen} {install-options} PACKGE_FILE...
	-U: 升级或安装
	-F: 升级
	
	rpm -Uvh PACKAGE_FILE...
	rpm -FVH PACKAGE_FILE...
	
		--oldpackage: 降级
		--force: 强制升级
	注意: (1) 不要对内核做升级操作，linux支持多内核版本并存，因此，直接安装新版本内核
		(2) 如果某原程序包的配置文件安装后曾被修改过，升级时，新版本的程序提供的同一个配置文件不会覆盖原有的配置文件，而是把新版本的配置文件重命名(FILENAME.rpmnew)后提供
</code></pre></div><h4 id="_19-3-3-卸载"><a href="#_19-3-3-卸载" class="header-anchor">#</a> 19.3.3 卸载</h4> <div class="language- extra-class"><pre class="language-text"><code>rpm {-e | --erase} [--allmatches] [--nodeps] [--noscripts] [--test] PACKAGE_NAME...
	--allmatches: 卸载所有匹配指定名称的程序包的各版本
	--nodeps: 忽略依赖关系
	--test: 测试卸载，dry run模式
</code></pre></div><p>==这里是说给定名称，不需要给定文件路径==</p> <h4 id="_19-3-4-查询"><a href="#_19-3-4-查询" class="header-anchor">#</a> 19.3.4 查询</h4> <div class="language- extra-class"><pre class="language-text"><code>rpm {-q | --query} {select-options} [query-options]
	[select-options]
        PACKAGE_NAME: 查询指定的程序包是否已经安装，及其版本
        -a, --all: 查询所有已经安装过的包
        -f FILE: 查询指定的文件由哪个程序包安装生成

        -p, --package PACKAGE_FILE: 用于实现对未安装的程序包执行查询操作

        --whatprovides XXX: 查询指定的xxx由哪个程序包提供
        --whatrequires xxx: 查询指定的xxx被哪个包所依赖

	[query-options]
		--changelog: 查询rpm包的changlog
		-l, --list: 程序安装生成的所有文件列表
		-i, --info: 程序包相关的信息，版本号、大小、所属的包组等
		-c, --configfiles: 查询指定的程序包提供的配置文件
		-d, --docfiles: 查询指定的程序包提供的文档
		--provides: 列出指定的程序包提供的所有的capability
		-R, --requires: 查询指定的程序包的依赖关系
		--scripts: 查看程序包自带的脚本片断
</code></pre></div><h4 id="_19-3-5-数据库重建"><a href="#_19-3-5-数据库重建" class="header-anchor">#</a> 19.3.5 数据库重建</h4> <p>rpm管理器数据库路径：/var/lib/rpm/</p> <p>查询操作：通过此处的数据库进行</p> <p>获取帮助：</p> <p>CentOS 6: man rpm</p> <p>CentOS 7: man rpmdb</p> <div class="language- extra-class"><pre class="language-text"><code>rpm {--initdb | --rebuilddb} [--dbpath DIRECTORY] [--root DIRECTORY]
	--initdb: 初始化数据库，当前无任何数据库可实始化创建一个新的；当前有时不执行任何操作
	--rebuilddb: 重新构建，通过读取当前系统上的所有已经安装过的程序包进行重新创建
</code></pre></div><h2 id="_20-网络服务"><a href="#_20-网络服务" class="header-anchor">#</a> 20 网络服务</h2> <h3 id="_20-1-ifconfig"><a href="#_20-1-ifconfig" class="header-anchor">#</a> 20.1 ifconfig</h3> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E7%BD%91%E5%8D%A1%5C%E7%BD%91%E5%8D%A11.png" alt=""></p> <h3 id="_20-2-route-路由"><a href="#_20-2-route-路由" class="header-anchor">#</a> 20.2 route 路由</h3> <ul><li>查看： <code>route -n</code></li> <li>查看路由：<code>netstat -rn</code> <ul><li><code>-r: 显示内核路由表</code></li> <li><code>-n: 数字格式</code></li></ul></li> <li>添加：<code>route add [net | host] target [netmask Nm] [gw GW] [[dev] if]</code></li></ul> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E7%BD%91%E5%8D%A1%5C%E7%BD%91%E5%8D%A13.png" alt=""></p> <p>###20.3 netstat</p> <p>Linux netstat 命令用于显示网络状态。</p> <p>利用 netstat 指令可让你得知整个 Linux 系统的网络情况。</p> <div class="language- extra-class"><pre class="language-text"><code>netstat [-acCeFghilMnNoprstuvVwx][-A&lt;网络类型&gt;][--ip]
</code></pre></div><p><strong>参数说明</strong>：</p> <ul><li><p>-a或--all 显示所有连线中的Socket。</p></li> <li><p>-e或--extend 显示网络其他相关信息。</p></li> <li><p>-l或--listening 显示监控中的服务器的Socket。</p></li> <li><p>-n或--numeric 直接使用IP地址，而不通过域名服务器。</p></li> <li><p>-p或--programs 显示正在使用Socket的程序识别码和程序名称。</p></li> <li><p>-t或--tcp 显示TCP传输协议的连线状况。</p></li> <li><p>-u或--udp 显示UDP传输协议的连线状况。</p></li> <li><p>-w或--raw 显示RAW传输协议的连线状况。</p></li></ul> <p><strong>传输层协议</strong></p> <ul><li><code>tcp</code>: 面向连接的协议；通信开始之前，要建立一个虚链路；通信完成后还要拆除连接</li> <li><code>udp</code>: 无连接的协议，直接发送数据报文</li></ul> <img src="D:\linux软件\linux运维\images\网卡\网卡1.png" style="zoom:67%;"> <img src="D:\linux软件\linux运维\images\网卡\网卡2.png" alt="网卡2" style="zoom:67%;"> <img src="D:\linux软件\linux运维\images\网卡\网卡2.png" alt="网卡2" style="zoom:67%;"> <h3 id="_20-4-ifup-和-ifdown"><a href="#_20-4-ifup-和-ifdown" class="header-anchor">#</a> 20.4 ifup 和 ifdown</h3> <p>ifup命令用于重新启动指定的网络设备。ifup命令的格式为：ifup 网络设备文件名。</p> <p>ifup命令使用举例如下：</p> <div class="language- extra-class"><pre class="language-text"><code>ifup eth0 // 重新启动网卡eth0。
ifup lo // 重新启动本地回绕网卡lo。
</code></pre></div><p>操作结果如下图所示：</p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E7%BD%91%E5%8D%A1%5Cifup.png" alt=""></p> <p><strong>ifdown</strong>
ifdown命令用于关闭指定的网络设备。ifdown命令的格式为：ifdown 网络设备文件名。</p> <p>ifdown命令使用举例如下：</p> <div class="language- extra-class"><pre class="language-text"><code>ifdown eth0 // 关闭网卡eth0。
ifdown lo // 关闭本地回绕网卡lo。 
</code></pre></div><h3 id="_20-5-hostname"><a href="#_20-5-hostname" class="header-anchor">#</a> 20.5 hostname</h3> <p>hostname 没有选项，显示主机名字</p> <p>hostname –d 显示机器所属域名</p> <p>hostname –f 显示完整的主机名和域名</p> <p>hostname –i 显示当前机器的 ip 地址</p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E7%BD%91%E5%8D%A1%5Chostname.png" alt=""></p> <h3 id="_20-6-dig"><a href="#_20-6-dig" class="header-anchor">#</a> 20.6 dig</h3> <div class="language- extra-class"><pre class="language-text"><code>dig -t A FQDN
dig -x IP
</code></pre></div><img src="D:\linux软件\linux运维\images\网卡\dig.png" style="zoom:67%;"> <h3 id="_20-7-ip"><a href="#_20-7-ip" class="header-anchor">#</a> 20.7 ip</h3> <p>见网址：https://www.cnblogs.com/ginvip/p/6367803.html</p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E7%BD%91%E5%8D%A1%5Cip1.png" alt=""></p> <p>qlen: 队列长度</p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E7%BD%91%E5%8D%A1%5Cip.png" alt=""></p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E7%BD%91%E5%8D%A1%5Cip2.png" alt=""></p> <p><strong>ip link: network device configuration</strong></p> <p><strong>ip netns: ip - manage network namespaces</strong></p> <div class="language- extra-class"><pre class="language-text"><code>ip netns list: 列出所有的netns
ip netns add NAME: 创建指定的netns
ip netns del NAME: 删除指定的netns
ip netns exec NAME COMMAND: 在指定的netns中运行命令
</code></pre></div><p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E7%BD%91%E5%8D%A1%5CIP4.png" alt=""></p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E7%BD%91%E5%8D%A1%5Cip5.png" alt=""></p> <h3 id="_20-8-ss"><a href="#_20-8-ss" class="header-anchor">#</a> 20.8 ss</h3> <p><strong>ss -t -a</strong> 【显示TCP连接】</p> <blockquote><p>-t： tcp</p> <p>-a: all</p> <p>-l: listening     【ss -l列出所有打开的网络连接端口】</p> <p>-s: summary    【显示 Sockets 摘要】</p> <p>-p: progress</p> <p>-n: numeric     【不解析服务名称】</p> <p>-r: resolve    【解析服务名称】</p> <p>-m: memory    【显示内存情况】</p></blockquote> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E7%BD%91%E5%8D%A1%5Css.png" alt=""></p> <img src="D:\linux软件\linux运维\images\网卡\ss1.png" style="zoom:67%;"> <img src="D:\linux软件\linux运维\images\网卡\ss2.png" style="zoom:67%;"> <div class="language- extra-class"><pre class="language-text"><code>ss -tnl
ss -tan
</code></pre></div><p>重启网络</p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E7%BD%91%E5%8D%A1%5Cnetwork.png" alt=""></p> <p>###20.9 nmcli</p> <p>显示所有设配状态</p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E7%BD%91%E5%8D%A1%5Cnmcli.png" alt=""></p> <p>具体可参考:https://www.cnblogs.com/djlsunshine/p/9733182.html</p> <h2 id="_21-进程"><a href="#_21-进程" class="header-anchor">#</a> 21 进程</h2> <h3 id="_21-1-pstree命令-查看进程树"><a href="#_21-1-pstree命令-查看进程树" class="header-anchor">#</a> 21.1 pstree命令 -- 查看进程树</h3> <p>pstree命令是用于查看进程树之间的关系，即哪个进程是父进程，哪个是子进程，可以清楚的看出来是谁创建了谁</p> <p>参数：</p> <ul><li><p>-A: 各进程树之间的连接以ASCII码字符来连接</p></li> <li><p>-U:各进程树之间的连接以utf8字符来连接，某些终端可能会有错误</p></li> <li><p>-p:同时列出每个进程的PID</p></li> <li><p>-u: 同时列出每个进程的所属账号名称：</p></li></ul> <img src="D:\linux软件\linux运维\images\进程\pstree.png" style="zoom:67%;"> <h3 id="_21-2-ps-查看-linux-中当前运行的进程"><a href="#_21-2-ps-查看-linux-中当前运行的进程" class="header-anchor">#</a> 21.2 ps --查看 Linux 中当前运行的进程</h3> <p>能列出系统中运行的进程，包括进程号、命令、CPU使用量、内存使用量等</p> <ul><li>ps -a        - 列出所有运行中/激活进程</li> <li>ps -ef |grep xxx   - 列出需要进程</li> <li><strong>ps -aux     - 显示进程信息，包括无终端的（x)  和针对用户（u）的进程：如USER, PID, %CPU, %MEM等</strong></li> <li>ps -e : 显示所有进程</li> <li>ps -f : 显示完整格式的进程信息</li> <li><strong>ps -ef 常用</strong></li> <li>ps -F: 显示完整格式的进程信息</li> <li>ps -H : 以层级结构显示进程的相关信息</li> <li><strong>ps -efH 常用</strong></li> <li><strong>ps -eo</strong> <strong>ps axo</strong> <ul><li><code>o field1, field2,...</code>: 自定义要显示的字段列表，以逗号分隔</li> <li>常用field : <code>pid, ni(nice值), pri(priority优先级), psr, pcpu, stat, comm, tty, ppid, rtprio(实时优先级)</code></li></ul></li></ul> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E8%BF%9B%E7%A8%8B%5Cps1.png" alt=""></p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E8%BF%9B%E7%A8%8B%5Cps3.png" alt=""></p> <p>ps 工具标识进程的 5 种状态码:</p> <ul><li>D    不可中断    uninterruptible sleep (usually IO)</li> <li>R    运行        runnable (on run queue)</li> <li>S    睡眠        sleeping</li> <li>T    停止        traced or stopped</li> <li>Z    僵死        a defunct (”zombie”) process</li> <li><code>+</code> : 前台进程</li> <li><code>|</code> : 多线程</li> <li><code>N</code> : 低优先级进程</li> <li><code>&lt;</code> : 高优先级进程</li> <li><code>s</code>: session leader</li></ul> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E8%BF%9B%E7%A8%8B%5Cps2.png" alt=""></p> <ul><li></li></ul> <h3 id="_21-3-pgrep"><a href="#_21-3-pgrep" class="header-anchor">#</a> 21.3 pgrep</h3> <p>经常要查看进程的信息，包括进程的是否已经消亡，通过pgrep来获得正在被调度的进程的相关信息。pgrep通过匹配其程序名，找到匹配的进程</p> <p><strong>常用选项:</strong></p> <ul><li>u uid</li> <li>U uid</li> <li>-t terminal: 与指定终端相关的进程</li> <li>-l : 显示进程名</li> <li>-a : 显示完整格式的进程名</li> <li>-P pid: 显示此进程的子进程</li></ul> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E8%BF%9B%E7%A8%8B%5Cpgrep.png" alt=""></p> <h3 id="_21-4-pkill"><a href="#_21-4-pkill" class="header-anchor">#</a> 21.4 pkill</h3> <p>Linux pkill 用于杀死一个进程，与 <a href="https://www.runoob.com/linux/linux-comm-kill.html" target="_blank" rel="noopener noreferrer">kill<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 不同的是它会杀死指定名字的所有进程，类似于 <a href="https://www.runoob.com/linux/linux-comm-killall.html" target="_blank" rel="noopener noreferrer">killall<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 命令。</p> <p><strong>语法</strong></p> <div class="language- extra-class"><pre class="language-text"><code>  pkill [选项]  name
</code></pre></div><p><strong>参数说明</strong>：</p> <ul><li>name ： 进程名</li></ul> <p>选项包含如下几个参数：</p> <ul><li>-o 仅向找到的最小（起始）进程号发送信号 -n 仅向找到的最大（结束）进程号发送信号</li> <li>-P 指定父进程号发送信号</li> <li>-g 指定进程组</li> <li>-t 指定开启进程的终端</li></ul> <h3 id="_21-5-pidof-根据进程名-取其pid"><a href="#_21-5-pidof-根据进程名-取其pid" class="header-anchor">#</a> 21.5 pidof 根据进程名，取其pid</h3> <h3 id="_21-6-top-显示进程"><a href="#_21-6-top-显示进程" class="header-anchor">#</a> 21.6 top 显示进程</h3> <p><strong>排序</strong></p> <ul><li>P : 以占据CPU百分比排序</li> <li>M : 以占据内存百分比排序</li> <li>T : 累积占用CPU时间排序</li></ul> <p><strong>首部信息</strong></p> <ul><li>l : uptime信息</li> <li>t ：tasks及cpu信息</li> <li>m : 内存信息</li></ul> <p>退出：q</p> <p>修改刷新时间间隔：s</p> <p>终止指定进程: k</p> <p>选项：</p> <ul><li>-d # : 指定刷新时间</li> <li>-b: 以批次显示</li> <li>-n #: 显示多少批次</li></ul> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E8%BF%9B%E7%A8%8B%5Ctop.png" alt=""></p> <h2 id="_22-http"><a href="#_22-http" class="header-anchor">#</a> 22 http</h2> <img src="D:\linux软件\linux运维\images\http\图.png" style="zoom:67%;"> <p><strong>http服务器程序</strong></p> <ul><li>httpd(apache)</li> <li><strong>nginx</strong></li> <li>lighttpd</li></ul> <p><strong>应用程序服务器</strong></p> <ul><li>IIS: .NET</li> <li><strong>tomcat</strong>: .jsp</li></ul> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Chttp%5Cpei.png" alt=""></p> <p>##23 httpd</p> <p>###23.1 apache 启动停止</p> <p>参考博客：https://blog.csdn.net/weixin_39212776/article/details/81192847</p> <ul><li><p><strong>修改根目录</strong></p> <p>在 <strong>/etc/apache2/sites-available</strong> 中修改 <strong>000-default.conf</strong> 中的DocumentRoot /var/www/ 修改为想要的目录
比如：DocumentRoot /var/www/html/mainpage
执行命令：</p> <div class="language- extra-class"><pre class="language-text"><code>    vim /etc/apache2/sites-available/000-default.conf1
</code></pre></div><p>修改000-default.conf中的DocumentRoot /var/www/，如下</p> <div class="language- extra-class"><pre class="language-text"><code>    ServerAdmin webmaster@localhost
    DocumentRoot /var/www/html    // 一般我们默认为这个作为网站的根目录12
</code></pre></div></li> <li><p>接下来<strong>重启apache</strong> 即可</p> <div class="language- extra-class"><pre class="language-text"><code>    sudo apache2ctl -k restart 1
</code></pre></div></li> <li><p><strong>修改默认网页为自己想要的页面</strong></p> <p>修改/etc/apache2/mods-available/dir.conf中的内容
执行命令：</p> <div class="language- extra-class"><pre class="language-text"><code>vim /etc/apache2/mods-available/dir.conf1
</code></pre></div><p>原来是：</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;IfModule mod_dir.c&gt;
    DirectoryIndex index.html index.cgi index.pl index.php index.xhtml index.htm 
&lt;/IfModule&gt;123
</code></pre></div><p>添加上想要的/wordpress就行啦~</p> <div class="language- extra-class"><pre class="language-text"><code>&lt;IfModule mod_dir.c&gt;
    DirectoryIndex index.html index.cgi index.pl index.php index.xhtml index.htm /wordpress
&lt;/IfModule&gt;123
</code></pre></div><p>实际上在这里添加文件或目录的意思是，用于我们允许http请求访问到/var/www/html下的改文件或目录中的内容的意思：
例如我添加了test这个目录</p></li></ul> <div class="language- extra-class"><pre class="language-text"><code>    &lt;IfModule mod_dir.c&gt;
        DirectoryIndex index.html index.cgi index.pl index.php index.xhtml index.htm /test
    &lt;/IfModule&gt;123
</code></pre></div><p>在再里面添加个名为index.html的文档，写入“Hello World！”，于是我们便可通过IP地址+/test/index.html</p> <ol><li><p>安装,ubuntu不能没有httpd,需要安装apache2即可</p> <div class="language- extra-class"><pre class="language-text"><code>sudo apt install apache2 -y1
</code></pre></div></li> <li><p>安装完毕后，我们检查是否启动了Apache服务</p> <div class="language- extra-class"><pre class="language-text"><code>systemctl status apache2
</code></pre></div></li> <li><p>我们再来看看一些操作Apache的常用命令</p> <div class="language- extra-class"><pre class="language-text"><code>开启、关闭和重启服务器

1、sudo /etc/init.d/apache2 start    //启动Apache服务

2、sudo /etc/init.d/apache2 stop    //停止Apache服务

3、sudo /etc/init.d/apache2 restart    //重启Apache服务
</code></pre></div></li></ol> <img src="D:\linux软件\linux运维\images\http\httpd1.png" style="zoom:67%;"> <p>输入<code>/etc/init.d/apache2 start</code> 后打开 云主机的ip</p> <img src="D:\linux软件\linux运维\images\http\httpd2.png" style="zoom:50%;"> <h3 id="_23-2-常用配置"><a href="#_23-2-常用配置" class="header-anchor">#</a> 23.2 常用配置</h3> <h4 id="_23-2-1-修改监听的ip和port"><a href="#_23-2-1-修改监听的ip和port" class="header-anchor">#</a> 23.2.1 修改监听的ip和port</h4> <div class="language- extra-class"><pre class="language-text"><code>listen [IP:]PORT
	- 省略ip表示0.0.0.0;
	- listen 指令可重复多次出现
		listen 80
	- 修改监听socket，重启服务进程方可生效
</code></pre></div><h4 id="_23-2-2-持久连接"><a href="#_23-2-2-持久连接" class="header-anchor">#</a> 23.2.2 持久连接</h4> <div class="language- extra-class"><pre class="language-text"><code>keepAlive On|Off
KeepAliveTimeout 15
MaxKeepAliveRequests 100
</code></pre></div><p>###23.3 挂网页</p> <p>把自己的网页挂上去（还是静态网页）</p> <p>将index.html从本地转到服务器上，</p> <p>因为网页默认在<code>/var/xxx/html</code> 里面，所以还要将网页转移到<code>/var/xxx/html</code> 目录里面</p> <ul><li><strong>移动目录</strong></li></ul> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Chttp%5C%E7%A7%BB%E5%8A%A8%E7%9B%AE%E5%BD%95.png" alt=""></p> <ul><li><strong>启动服务</strong></li></ul> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Chttp%5C%E5%90%AF%E5%8A%A8%E6%9C%8D%E5%8A%A1.png" alt=""></p> <ul><li><strong>在浏览器中打开网址</strong></li></ul> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Chttp%5Cindex.png" alt=""></p> <h3 id="_23-4-telnet"><a href="#_23-4-telnet" class="header-anchor">#</a> 23.4 telnet</h3> <p>长连接</p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Chttp%5Ctelnet.png" alt=""></p> <h3 id="_23-5-apache2权限控制"><a href="#_23-5-apache2权限控制" class="header-anchor">#</a> 23.5 apache2权限控制</h3> <p>参照https://blog.csdn.net/jenyzhang/article/details/51604718</p> <p>模块文件路径：<code>/usr/lib64/httpd/modules</code></p> <p>站点文档：<code>/var/www/html</code></p> <p>配置文件</p> <p>日志文件: <code>/var/log/httpd</code></p> <ul><li><code>access_log</code>: 访问日志</li> <li><code>error_log</code>: 错误日志</li></ul> <p><img src="C:%5CUsers%5C86173%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201212090026647.png" alt="image-20201212090026647"></p> <h3 id="_23-6-apache2高级操作"><a href="#_23-6-apache2高级操作" class="header-anchor">#</a> 23.6 apache2高级操作</h3> <p>参照https://www.cnblogs.com/regit/p/9508454.html</p> <h4 id="_23-6-1-修改端口-80-8080"><a href="#_23-6-1-修改端口-80-8080" class="header-anchor">#</a> 23.6.1 修改端口 80-&gt;8080</h4> <ul><li>在阿里云中添加安全组：</li></ul> <img src="D:\linux软件\linux运维\images\http\ali.png" style="zoom:50%;"> <img src="D:\linux软件\linux运维\images\http\ali2.png" alt="ali2" style="zoom:50%;"> <ul><li>修改<code>/etc/apache2/ports.conf</code> 中的监听窗口</li></ul> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Chttp%5C%E4%BF%AE%E6%94%B9%E7%AB%AF%E5%8F%A31.png" alt=""></p> <ul><li>修改<code>/etc/apache2/sites-available/000-default.conf</code>  也可以在sites-available下新建文件，然后ln引用至<code>/etc/apache2/sites-enabled</code></li></ul> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Chttp%5C%E4%BF%AE%E6%94%B9%E7%AB%AF%E5%8F%A32.png" alt=""></p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Chttp%5Cubuntu.png" alt=""></p> <h4 id="_23-6-2-修改ip或域名"><a href="#_23-6-2-修改ip或域名" class="header-anchor">#</a> 23.6.2 修改ip或域名</h4> <ul><li>基于ip控制</li></ul> <p>Require ip IP地址/网络地址</p> <p>Require not ip IP地址/网络地址</p> <ul><li>基于主机名控制</li></ul> <div class="language- extra-class"><pre class="language-text"><code>&lt;Requireall&gt;
    Require host 主机名/域名
    Require not host 主机名/域名
&lt;/Requireall&gt;
</code></pre></div><p>修改<code>/etc/apache2/apache2.conf</code>里面的内容</p> <img src="D:\linux软件\linux运维\images\http\修改ip2.png" style="zoom:50%;"> <p>再次重启<code>sudo /etc/init.d/apache2 restart</code></p> <img src="D:\linux软件\linux运维\images\http\修改ip1.png" style="zoom:50%;"> <p>同时修改域名和ip  https://blog.csdn.net/weixin_40704661/article/details/80912943</p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Chttp%5Clink.png" alt=""></p> <p><code>sudo vim /etc/hosts</code></p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Chttp%5Chost.png" alt=""></p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Chttp%5C%E5%9F%9F%E5%90%8D.png" alt=""></p> <p>需要在阿里中进行配置</p> <h4 id="_23-6-3-options的使用"><a href="#_23-6-3-options的使用" class="header-anchor">#</a> 23.6.3 Options的使用</h4> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Chttp%5Coptions1.png" alt=""></p> <p>在<code>/etc/apache2/apache2.conf</code> 中修改Options,然后重启</p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Chttp%5C%E8%AE%BF%E9%97%AE%E5%9B%BE%E7%89%872.png" alt=""></p> <p>要指定图片，如404.jpg,但是如果直接访问images就不行</p> <img src="D:\linux软件\linux运维\images\http\访问图片.png" style="zoom:50%;"> <h4 id="_23-6-4-日志"><a href="#_23-6-4-日志" class="header-anchor">#</a> 23.6.4 日志</h4> <img src="D:\linux软件\linux运维\images\http\日志.png" style="zoom:50%;"> <p>错误日志：<code>/var/log/apache2/error.log</code></p> <p>日志文件：</p> <img src="D:\linux软件\linux运维\images\http\日志文件.png" style="zoom:67%;"> <img src="D:\linux软件\linux运维\images\http\日志.png" style="zoom:50%;"> <img src="D:\linux软件\linux运维\images\http\日志1.png" style="zoom:50%;"> <h4 id="_26-6-5-修改密码-未实现"><a href="#_26-6-5-修改密码-未实现" class="header-anchor">#</a> 26.6.5 修改密码 未实现</h4> <p>登录权限一般通过程序使用表单提交进行控制</p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Chttp%5C%E5%AF%86%E7%A0%814.png" alt=""></p> <p>修改完后并没有出现提示框</p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Chttp%5C%E5%AF%86%E7%A0%812.png" alt=""></p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Chttp%5C%E5%AF%86%E7%A0%813.png" alt=""></p> <p>基于组进行</p> <img src="D:\linux软件\linux运维\images\http\密码5.png" style="zoom:50%;"> <img src="D:\linux软件\linux运维\images\http\密码.png" style="zoom:50%;"> <h3 id="_23-7-apache2-文件说明"><a href="#_23-7-apache2-文件说明" class="header-anchor">#</a> 23.7 apache2 文件说明</h3> <p>参照https://www.cnblogs.com/ylan2009/archive/2012/02/25/2368028.html</p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Chttp%5Capache.png" alt=""></p> <ul><li><code>/etc/apache2/apache2.conf</code>: 主配置文件</li> <li><code>/etc/apache2/sites-avaliable/</code>: 存放站点配置文件，存放sites-available中配置文件的衔接，需要用时使用<code>ln</code> 进行衔接，把配置文件本体放入不会起作用</li> <li><code>/etc/apache2/mods-avaliable</code>: 存放模块配置文件的目录，可以加载各种模块
<ul><li><code>*.conf</code>: 模块的配置信息，相当于apache2.conf的补充</li> <li><code>*.load</code>: 模块自动加载的入口文件，里面的内容为loadModule指令</li></ul></li> <li><code>/etc/apache2 mods-enabled/</code>: 与<code>seites-enabled</code> 类似，想启用哪个模块，就把哪个模块的配置文件衔接进来</li></ul> <p>站点默认配置: <code>/etc/apache2/sites-avaliable/000-default.conf</code></p> <h2 id="_24-mysql"><a href="#_24-mysql" class="header-anchor">#</a> 24 mysql</h2> <p>###24.1 选项</p> <p>mysql [OPTIONS] [database]</p> <ul><li>-h, --host=hostname: 远程主机地址，默认localhost,客户端连接服务端，服务器会反解客户的ip为主机名，关闭此功能(<code>skip_name_resolve=ON</code>)</li> <li>-P, --port=#: mysql服务器监听的端口；默认为3306/tcp</li> <li>-S, --socket=/PATH/TO/mysql.sock: 套按字文件路径</li></ul> <p>客户端命令</p> <p>mysql&gt;</p> <ul><li>\d char : 设定新的语句结束符</li> <li>\g : 语句结束标记</li> <li>\G : 语句结束标记，结果以竖排显示（因为有的表行太长会乱）</li> <li>\! : 执行shell命令</li> <li>\. : 装载并运行sql脚本</li></ul> <p>​</p> <img src="D:\linux软件\linux运维\images\mysql\mysql1.png" style="zoom:67%;"> <img src="D:\linux软件\linux运维\images\mysql\mysql2.png" alt="mysql2" style="zoom:67%;"> <h3 id="_24-2-mysql权限管理"><a href="#_24-2-mysql权限管理" class="header-anchor">#</a> 24.2 mysql权限管理</h3> <p>在<code>/etc/mysql/mysql.conf.d/mysqld.cnf</code>下修改</p> <p>然后重启</p> <p><code>skip_name_resolve=ON</code> : 禁止检查主机名</p> <p>参考：https://www.cnblogs.com/wangyueping/p/11258028.html</p> <img src="D:\linux软件\linux运维\images\mysql\mysql3.png" style="zoom:50%;"> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Cmysql%5Cmysql4.png" alt=""></p> <img src="D:\linux软件\linux运维\images\mysql\mysql5.png" alt="mysql5" style="zoom:67%;"> <img src="D:\linux软件\linux运维\images\mysql\mysql6.png" alt="mysql6" style="zoom:67%;"> <h2 id="_25-chrony-同步时间"><a href="#_25-chrony-同步时间" class="header-anchor">#</a> 25 chrony 同步时间</h2> <p>NTP更慢  chrony更快更精确</p> <p><strong>程序环境</strong></p> <ul><li><p>配置文件：<code>/etc/chrony/chrony.conf</code></p></li> <li><p>主程序文件：<code>chronyd</code></p></li> <li><p>工具程序：<code>chronyc</code></p></li></ul> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Cchrony%5Cchrony1.png" alt=""></p> <p>日志文件在<code>/var/log/chrony/....</code></p> <p>跟服务器同步时间</p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Cchrony%5Cchrony2.png" alt=""></p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Cchrony%5Cchrony3.png" alt=""></p> <h2 id="_26-rsyslog-系统日志"><a href="#_26-rsyslog-系统日志" class="header-anchor">#</a> 26 rsyslog 系统日志</h2> <p>https://blog.csdn.net/fmyzc/article/details/82904378</p> <p><code>sudo vim /etc/rsyslog.conf</code></p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5Crsyslog%5C1.png" alt=""></p> <p>特性：</p> <ul><li>多线程：UDP，TCP, SSL, TLS, RELP</li> <li>存储日志信息于Mysql等数据管理系统</li> <li>自定义输出格式</li> <li>实现过滤日志信息中的任何部分的内容</li></ul> <p>ubuntu记录日志于mysql中</p> <p>https://blog.csdn.net/qq_41598851/article/details/79933854</p> <h2 id="_27-nginx-uwsgi"><a href="#_27-nginx-uwsgi" class="header-anchor">#</a> 27 nginx + uwsgi</h2> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E9%83%A8%E7%BD%B2%5Cnginx.png" alt=""></p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E9%83%A8%E7%BD%B2%5Cbu.png" alt=""></p> <h3 id="_27-1-使用git上传到码云上"><a href="#_27-1-使用git上传到码云上" class="header-anchor">#</a> 27.1 使用git上传到码云上</h3> <p>在本地运行成功后，用<code>pip freeze &gt; requirements.txt</code> 将当前环境的包导出到<code>requirements.txt</code>文件中</p> <p>一定要看清楚是私有还是公有 否则要作牢</p> <p>在git bash里面输入</p> <p>先切换到项目所在目录, <code>cd D:/xxx</code>  ==注：git里面目录是/==</p> <ul><li><code>git init</code></li> <li><code>git remote add origin xxx.git</code>   # 此处的xxx.git来自码云或者github里面的https://xxx.git</li> <li><code>git add .</code></li> <li><code>git commit -m 'first commit'</code>   # 进行提交 , 字符串中的随便写，但至少语义清楚</li> <li><code>git pull origin master --allow-unrelated-histories</code>  # 第一次提交</li> <li><code>git push origin master</code>  # 将项目推到码云上</li></ul> <p>便可在码云上看到自己的项目</p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E9%83%A8%E7%BD%B2%5Cgit.png" alt=""></p> <p>接下来将项目从码云上拖到自己的服务器上</p> <h3 id="_27-2-在服务器上的准备工作"><a href="#_27-2-在服务器上的准备工作" class="header-anchor">#</a> 27.2 在服务器上的准备工作</h3> <p>先在阿里上配置安全组</p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E9%83%A8%E7%BD%B2%5Cali.png" alt=""></p> <ol><li>使用xshell连接服务器</li></ol> <div class="language- extra-class"><pre class="language-text"><code>sudo apt-get install openssh-server openssh-client
sudo /etc/init.d/ssh restart
</code></pre></div><ol start="2"><li>安装mysql 服务端和客户端</li></ol> <div class="language- extra-class"><pre class="language-text"><code>sudo apt-get install mysql-server mysql-client
sudo apt-get install libmysqld-dev
</code></pre></div><ol start="3"><li><p>安装python, 记得安装相关的配置 ubuntu为<code>python-dev</code></p></li> <li><p>安装虚拟环境 即<code>virtualenv</code> 和 <code>virtualenvwrapper</code>, 并创建虚拟环境</p></li></ol> <ul><li><code>pip install virtualenv</code></li> <li><code>pip install virtualenvwrapper</code></li> <li><code>sudo vim ~/.bashrc</code> 在文件的最后添加</li></ul> <div class="language- extra-class"><pre class="language-text"><code>export WORKON_HOME=$HOME/.virtualenvs
source /usr/local/bin/virtualenvwrapper.sh
</code></pre></div><ul><li>激活虚拟环境 <code>source ~/.bashrc</code></li> <li>创建虚拟环境 <code>mkvirtualenv flask_env</code>  创建的虚拟环境在 <code>~/.virtualenvs</code> 中</li> <li>之后使用虚拟环境，可通过 <code>workon flask_env</code></li></ul> <ol start="5"><li>将码云上的项目拖到服务器上</li></ol> <div class="language- extra-class"><pre class="language-text"><code>sudo git init
sudo git remote add origin xxx.git
sudo git push origin master  # 后续只需执行这句就行
# 然后输入码云上的用户名，密码
</code></pre></div><ol start="6"><li><p>进入虚拟环境中，进入项目所在目录，执行命令<code>pip install -r requirements.txt</code> 安装好相应的包</p></li> <li><p>在<code>mysql</code>数据库中，安装好相应的包</p></li> <li><p>将数据库迁移到数据库中</p></li></ol> <div class="language- extra-class"><pre class="language-text"><code>python manage.py db migrate
python manage.py db upgrade
</code></pre></div><ol start="9"><li><p>将<code>flask中的 app.py</code> 改为 <code>app.run(host='0.0.0.0')</code>  即允许任何人访问， 在浏览器中输入<code>服务器ip:端口</code></p></li> <li><p>在flask的<code>config.py</code> 中设置域名，以及ip地址</p> <div class="language- extra-class"><pre class="language-text"><code>ALLOW_HOSTS = ['116.26....', 'www.jiangcji.com', 'jiangcji.com']
</code></pre></div></li> <li><p>设置<code>debug=False</code>, 避免网站产生错误，而将错误信息暴露给用户</p></li></ol> <h3 id="_27-3-配置nginx"><a href="#_27-3-配置nginx" class="header-anchor">#</a> 27.3 配置nginx</h3> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E9%83%A8%E7%BD%B2%5Cnginx1.png" alt=""></p> <p>在<code>/etc/nginx/sites-avabled</code> 里面新建一个<code>zhiliao.conf</code> ,编写</p> <div class="language- extra-class"><pre class="language-text"><code>server {
	listen 8000;
	server_name zhiliao;
	charset utf-8;
	client_max_boy_size 75M;
	
	location /static/(.*) {
		alias /srv/zhiliao/static;
	}
	
	location / {
		uwsgi_pass 0.0.0.0:8000;
		include /etc/nginx/uwsgi_params;
	}
 
}
</code></pre></div><p>之后记得连接到sites-enable, <code>ln -s /etc/nginx/sites-avablied/zhiliao.conf /etc/nginx/sites/enabled/</code></p> <p>当然也可以在<code>/etc/nginx/conf.d/</code> 下面建立<code>zhiliao.conf</code> 也是一样的,这个不用连接</p> <p>编写完后，通过<code>nginx -t</code> 检查是否有语法错误 ,如果没有错误，可启动nginx服务，查看ip:8000, 看看css文件等是否被加载</p> <h3 id="_27-4-配置uwsgi"><a href="#_27-4-配置uwsgi" class="header-anchor">#</a> 27.4 配置uwsgi</h3> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E9%83%A8%E7%BD%B2%5Cuwsgi.png" alt=""></p> <p>在所在项目下新建一个<code>xxx.ini</code>, 进行编辑</p> <div class="language- extra-class"><pre class="language-text"><code>[uwsgi]

socket = :8000  # 因为要与nginx通信，所以需要使用socket,否则使用http=0.0.0.0:8000

chdir = /srv/zhiliao
wsgi-file = /srv/zhiliao/app.py
callable = app 
processes = 2 # 最大数量的进程
threads = 10 # 最大数量的线程
pidfile = uwsgi.pid
daemonize = /srv/zhiliao/zhiliao_uwsgi.log
home = /home/.virtualenvs/flask_env  # python虚拟环境的路径
</code></pre></div><p>在配置的时候一定要细心，否则可能出不来。。。</p> <p><img src="D:%5Clinux%E8%BD%AF%E4%BB%B6%5Clinux%E8%BF%90%E7%BB%B4%5Cimages%5C%E9%83%A8%E7%BD%B2%5Csuper.png" alt=""></p> <h2 id="_28-gunicorn"><a href="#_28-gunicorn" class="header-anchor">#</a> 28 gunicorn</h2> <p>参考：https://blog.csdn.net/qq_42517220/article/details/90477700</p> <p>在此不使用supervisor，因为用uwsgi或者gunicorn两个用supervisor用不起，太菜，此外nginx也没有必要，因为会自动加载</p> <p>在项目中配置好虚拟环境</p> <p>在项目中创建好<code>gunicorn.conf.py</code> 便于看日志文件</p> <div class="language- extra-class"><pre class="language-text"><code># encoding: utf-8
# filename: gunicorn.conf.py
import os
import multiprocessing

bind = '127.0.0.1:8000'  # 绑定ip和端口号
backlog = 512  # 监听队列
chdir = os.path.dirname(os.path.abspath(__file__))  # gunicorn要切换到的目的工作目录
timeout = 30  # 超时
worker_class = 'sync'  # 还可以使用 sync 模式，默认的是 sync 模式,使用 gevent 模式

workers = multiprocessing.cpu_count() * 2 + 1  # 进程数
threads = 2  # 指定每个进程开启的线程数
loglevel = 'info'  # 日志级别，这个日志级别指的是错误日志的级别，而访问日志的级别无法设置
access_log_format = '%(t)s %(p)s %(h)s &quot;%(r)s&quot; %(s)s %(L)s %(b)s %(f)s&quot; &quot;%(a)s&quot;'  # 设置gunicorn访问日志格式，错误日志无法设置

&quot;&quot;&quot;
其每个选项的含义如下：
h          remote address
l          '-'
u          currently '-', may be user name in future releases
t          date of the request
r          status line (e.g. ``GET / HTTP/1.1``)
s          status
b          response length or '-'
f          referer
a          user agent
T          request time in seconds
D          request time in microseconds
L          request time in decimal seconds
p          process ID
&quot;&quot;&quot;
accesslog = os.path.join(chdir, &quot;log/gunicorn_access.log&quot;)  # 访问日志文件
errorlog = os.path.join(chdir, &quot;log/gunicorn_error.log&quot;)  # 访问日志文件
</code></pre></div><p>然后是启动文件<code>start.sh</code></p> <div class="language- extra-class"><pre class="language-text"><code>#! /bin/bash
exec gunicorn -c gunicorn.conf.py manage.py
</code></pre></div><p>丑是因为项目的从外网引入的js和css没有加载出来</p> <img src="D:\linux软件\linux运维\images\部署\gunicorn2.png" style="zoom:50%;"> <img src="D:\linux软件\linux运维\images\部署\gunicorn.png" style="zoom:50%;"></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Java基础/集合.html" class="prev">
        Java中的集合
      </a></span> <span class="next"><a href="/MySQL/MySQL高级.html">
        MySQL的学习
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.e7c2969b.js" defer></script><script src="/assets/js/2.94d3dfac.js" defer></script><script src="/assets/js/13.0d8bcb67.js" defer></script>
  </body>
</html>
