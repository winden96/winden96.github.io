<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>设计模式 | winden96</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="winden96 的学习记录">
    
    <link rel="preload" href="/assets/css/0.styles.4fd6cf0c.css" as="style"><link rel="preload" href="/assets/js/app.e7c2969b.js" as="script"><link rel="preload" href="/assets/js/2.94d3dfac.js" as="script"><link rel="preload" href="/assets/js/33.66017b72.js" as="script"><link rel="prefetch" href="/assets/js/10.27cdeca9.js"><link rel="prefetch" href="/assets/js/11.07a9d483.js"><link rel="prefetch" href="/assets/js/12.2505f188.js"><link rel="prefetch" href="/assets/js/13.0d8bcb67.js"><link rel="prefetch" href="/assets/js/14.a1698ea2.js"><link rel="prefetch" href="/assets/js/15.dce506f4.js"><link rel="prefetch" href="/assets/js/16.82ab8250.js"><link rel="prefetch" href="/assets/js/17.1fa3722a.js"><link rel="prefetch" href="/assets/js/18.129b810d.js"><link rel="prefetch" href="/assets/js/19.7531d5a3.js"><link rel="prefetch" href="/assets/js/20.2c5f040e.js"><link rel="prefetch" href="/assets/js/21.635435c4.js"><link rel="prefetch" href="/assets/js/22.a44576c7.js"><link rel="prefetch" href="/assets/js/23.32ee5f65.js"><link rel="prefetch" href="/assets/js/24.109d908c.js"><link rel="prefetch" href="/assets/js/25.9ebc3e07.js"><link rel="prefetch" href="/assets/js/26.643e2283.js"><link rel="prefetch" href="/assets/js/27.44aebb00.js"><link rel="prefetch" href="/assets/js/28.269bc50f.js"><link rel="prefetch" href="/assets/js/29.5ba9d11a.js"><link rel="prefetch" href="/assets/js/3.dc23a8fe.js"><link rel="prefetch" href="/assets/js/30.be0b3d6d.js"><link rel="prefetch" href="/assets/js/31.5c853594.js"><link rel="prefetch" href="/assets/js/32.06dd5c8a.js"><link rel="prefetch" href="/assets/js/4.76c25a36.js"><link rel="prefetch" href="/assets/js/5.313f4ba0.js"><link rel="prefetch" href="/assets/js/6.3db81792.js"><link rel="prefetch" href="/assets/js/7.2b7d8442.js"><link rel="prefetch" href="/assets/js/8.19d8ddaf.js"><link rel="prefetch" href="/assets/js/9.4cbab228.js">
    <link rel="stylesheet" href="/assets/css/0.styles.4fd6cf0c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">winden96</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JUC</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JVM</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Java基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Linux</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>My SQL</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Mybatis Plus</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Redis</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Spring Boot</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Spring Cloud</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>分布式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>操作系统</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>杂记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>消息中间件</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>计算机网络</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>设计模式</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/设计模式/设计模式.html" aria-current="page" class="active sidebar-link">设计模式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_1-1-单一职责原则" class="sidebar-link">1.1 单一职责原则</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_1-2-接口隔离原则" class="sidebar-link">1.2 接口隔离原则</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_1-3-依赖倒转原则" class="sidebar-link">1.3 依赖倒转原则</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_1-4-里氏替换原则" class="sidebar-link">1.4 里氏替换原则</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_1-5-开闭原则" class="sidebar-link">1.5 开闭原则</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_1-6-迪米特法则" class="sidebar-link">1.6 迪米特法则</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_1-7-合成复用原则" class="sidebar-link">1.7 合成复用原则</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_2-1-依赖关系" class="sidebar-link">2.1 依赖关系</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_2-2-泛化关系" class="sidebar-link">2.2 泛化关系</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_2-3-关联关系" class="sidebar-link">2.3 关联关系</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_2-4-聚合关系" class="sidebar-link">2.4 聚合关系</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_2-5-组合关系" class="sidebar-link">2.5 组合关系</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_3-1-单例模式" class="sidebar-link">3.1 单例模式</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_3-2-工厂模式" class="sidebar-link">3.2 工厂模式</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_3-3-原型模式" class="sidebar-link">3.3 原型模式</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_3-4-建造者模式" class="sidebar-link">3.4 建造者模式</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_3-5-适配器模式" class="sidebar-link">3.5 适配器模式</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_3-6-桥接模式" class="sidebar-link">3.6 桥接模式</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_3-7-装饰者模式" class="sidebar-link">3.7 装饰者模式</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_3-8-组合模式" class="sidebar-link">3.8 组合模式</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#" class="sidebar-link"></a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_3-9-外观模式" class="sidebar-link">3.9 外观模式</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_3-10-享元模式" class="sidebar-link">3.10 享元模式</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_3-11-代理模式" class="sidebar-link">3.11 代理模式</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_3-12-模板方法模式" class="sidebar-link">3.12 模板方法模式</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_3-13-命令模式" class="sidebar-link">3.13 命令模式</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_3-14-访问者模式" class="sidebar-link">3.14 访问者模式</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_3-15-迭代器模式" class="sidebar-link">3.15 迭代器模式</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_3-16-观察者模式" class="sidebar-link">3.16 观察者模式</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_3-17-中介者模式" class="sidebar-link">3.17 中介者模式</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_3-18-备忘录模式" class="sidebar-link">3.18 备忘录模式</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_3-19-解释器模式" class="sidebar-link">3.19 解释器模式</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_3-20-状态模式" class="sidebar-link">3.20 状态模式</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_3-21-策略模式" class="sidebar-link">3.21 策略模式</a></li><li class="sidebar-sub-header"><a href="/设计模式/设计模式.html#_3-22-职责链" class="sidebar-link">3.22 职责链</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_1-设计模式七大原则"><a href="#_1-设计模式七大原则" class="header-anchor">#</a> 1. 设计模式七大原则</h1> <p>设计模式原则，是程序员在编程时应当遵守的原则，也是各种设计模式的基础</p> <p>常用的7大原则：</p> <ul><li>单一职责原则</li> <li>接口隔离原则</li> <li>依赖倒转（倒置）原则</li> <li>里氏替换原则</li> <li>开闭原则</li> <li>迪米特法则</li> <li>合成复用原则</li></ul> <h2 id="_1-1-单一职责原则"><a href="#_1-1-单一职责原则" class="header-anchor">#</a> 1.1 单一职责原则</h2> <h3 id="_1-1-1-基本介绍"><a href="#_1-1-1-基本介绍" class="header-anchor">#</a> 1.1.1 基本介绍</h3> <p>​	对类来说，一个类应该只负责一项职责。如类A负责两个不同职责：职责1，职责2。当职责1需求变更而改变A时，可能造成职责2执行错误，需要将类A的粒度分解为A1，A2</p> <h3 id="_1-1-2-代码说明"><a href="#_1-1-2-代码说明" class="header-anchor">#</a> 1.1.2 代码说明</h3> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/1.png" style="zoom:67%;"> <h3 id="_1-1-3-注意事项和细节"><a href="#_1-1-3-注意事项和细节" class="header-anchor">#</a> 1.1.3 注意事项和细节</h3> <ul><li>降低类的复杂度，一个类只负责一项职责</li> <li>提高类的可读性，可维护性</li> <li>降低变更引起的风险</li> <li>通常情况下，应当遵守单一职责原则，只有逻辑足够简单，才可以在代码级违反单一职责原则；只有类中方法数量足够少，可以在方法级别维持单一职责原则</li></ul> <h2 id="_1-2-接口隔离原则"><a href="#_1-2-接口隔离原则" class="header-anchor">#</a> 1.2 接口隔离原则</h2> <h3 id="_1-2-1-基本介绍"><a href="#_1-2-1-基本介绍" class="header-anchor">#</a> 1.2.1 基本介绍</h3> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/2.png" alt=""></p> <h3 id="_1-2-2-代码说明"><a href="#_1-2-2-代码说明" class="header-anchor">#</a> 1.2.2 代码说明</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">interface</span> <span class="token class-name">Interface1</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">operation1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">operation2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">operation3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">operation4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">operation5</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">B</span> <span class="token keyword">implements</span> <span class="token class-name">Interface1</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">operation1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;B 实现了 operation1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">operation2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;B 实现了 operation2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">operation3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;B 实现了 operation3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">operation4</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;B 实现了 operation4&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">operation5</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;B 实现了 operation5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">D</span> <span class="token keyword">implements</span> <span class="token class-name">Interface1</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">operation1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;D 实现了 operation1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">operation2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;D 实现了 operation2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">operation3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;D 实现了 operation3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">operation4</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;D 实现了 operation4&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">operation5</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;D 实现了 operation5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">A</span> <span class="token punctuation">{</span> <span class="token comment">// A 类通过 接口 Interface1 依赖（使用）B类，但是只会用到1，2，3方法</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">depend1</span><span class="token punctuation">(</span><span class="token class-name">Interface1</span> interface1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        interface1<span class="token punctuation">.</span><span class="token function">operation1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">depend2</span><span class="token punctuation">(</span><span class="token class-name">Interface1</span> interface1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        interface1<span class="token punctuation">.</span><span class="token function">operation2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">depend3</span><span class="token punctuation">(</span><span class="token class-name">Interface1</span> interface1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        interface1<span class="token punctuation">.</span><span class="token function">operation3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">C</span> <span class="token punctuation">{</span> <span class="token comment">// C 类通过 接口 Interface1 依赖（使用）D类，但是只会用到1，4,5方法</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">depend1</span><span class="token punctuation">(</span><span class="token class-name">Interface1</span> interface1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        interface1<span class="token punctuation">.</span><span class="token function">operation1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">depend2</span><span class="token punctuation">(</span><span class="token class-name">Interface1</span> interface1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        interface1<span class="token punctuation">.</span><span class="token function">operation4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">depend3</span><span class="token punctuation">(</span><span class="token class-name">Interface1</span> interface1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        interface1<span class="token punctuation">.</span><span class="token function">operation5</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>将拆分成最小接口</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">interface</span> <span class="token class-name">Interface11</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">operation1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">interface</span> <span class="token class-name">Interface12</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">operation2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">operation3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">interface</span> <span class="token class-name">Interface13</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">operation4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">operation5</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> B1 <span class="token keyword">implements</span> <span class="token class-name">Interface11</span><span class="token punctuation">,</span> <span class="token class-name">Interface12</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">operation1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;B 实现了 operation1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">operation2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;B 实现了 operation2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">operation3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;B 实现了 operation3&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> D1 <span class="token keyword">implements</span> <span class="token class-name">Interface11</span><span class="token punctuation">,</span> <span class="token class-name">Interface13</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">operation1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;D 实现了 operation1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">operation4</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;D 实现了 operation4&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">operation5</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;D 实现了 operation5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> A1 <span class="token punctuation">{</span> <span class="token comment">// A 类通过 接口 Interface1 依赖（使用）B类，但是只会用到1，2，3方法</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">depend1</span><span class="token punctuation">(</span><span class="token class-name">Interface11</span> interface11<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        interface11<span class="token punctuation">.</span><span class="token function">operation1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">depend2</span><span class="token punctuation">(</span><span class="token class-name">Interface12</span> interface12<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        interface12<span class="token punctuation">.</span><span class="token function">operation2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">depend3</span><span class="token punctuation">(</span><span class="token class-name">Interface12</span> interface12<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        interface12<span class="token punctuation">.</span><span class="token function">operation3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> C1 <span class="token punctuation">{</span> <span class="token comment">// C 类通过 接口 Interface1 依赖（使用）D类，但是只会用到1，4,5方法</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">depend1</span><span class="token punctuation">(</span><span class="token class-name">Interface11</span> interface11<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        interface11<span class="token punctuation">.</span><span class="token function">operation1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">depend2</span><span class="token punctuation">(</span><span class="token class-name">Interface13</span> interface1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        interface1<span class="token punctuation">.</span><span class="token function">operation4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">depend3</span><span class="token punctuation">(</span><span class="token class-name">Interface13</span> interface1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        interface1<span class="token punctuation">.</span><span class="token function">operation5</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_1-3-依赖倒转原则"><a href="#_1-3-依赖倒转原则" class="header-anchor">#</a> 1.3 依赖倒转原则</h2> <h3 id="_1-3-1-基本介绍"><a href="#_1-3-1-基本介绍" class="header-anchor">#</a> 1.3.1 基本介绍</h3> <ul><li>高层模块不应该依赖底层模块，二者都应该依赖其抽象</li> <li>抽象不应该依赖细节，细节应该依赖抽象</li> <li>依赖倒转（倒置）的中心思想是面向接口编程</li> <li>依赖倒转原则的设计理念：相对于细节的多变性，抽象的东西要稳定的多，以抽象为基础搭建的架构比以细节为基础的架构要稳定的多。在 java 中，抽象指的是接口或抽象类，细节就是具体的实现类</li> <li>使用接口或抽象类的目的是制定好规范，而不设计任何具体的操作，把展现细节的任务交给他们的实现类去完成</li></ul> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/3.png" alt=""></p> <h3 id="_1-3-2-依赖关系传递的三种方式"><a href="#_1-3-2-依赖关系传递的三种方式" class="header-anchor">#</a> 1.3.2 依赖关系传递的三种方式</h3> <ul><li>接口传递</li> <li>构造方法传递</li> <li>setter 方式传递</li></ul> <h3 id="_1-3-3-依赖倒转原则的注意事项和细节"><a href="#_1-3-3-依赖倒转原则的注意事项和细节" class="header-anchor">#</a> 1.3.3 依赖倒转原则的注意事项和细节</h3> <ul><li>低层模块尽量都要有抽象类或接口或者两者都有，程序稳定性更好</li> <li>变量的声明类型尽量是抽象类或接口，这样我们的变量引用和实际对象间，就存在一个缓冲层，利于程序扩展和优化</li> <li>继承时遵循里氏替换原则</li></ul> <h2 id="_1-4-里氏替换原则"><a href="#_1-4-里氏替换原则" class="header-anchor">#</a> 1.4 里氏替换原则</h2> <h3 id="_1-4-1-基本介绍"><a href="#_1-4-1-基本介绍" class="header-anchor">#</a> 1.4.1 基本介绍</h3> <ul><li>如果对每个类型为 T1 的对象 o1，都有类型为 T2的对象 o2,使得以T1定义的所有程序 P在所有的对象 o1 都代换成 o2，程序 P的行为没有发生变化，那么类型 T2是类型 T1的子类型。所有引用基类的地方必须能透明地使用其子类的对象</li> <li>在使用继承时，遵循里氏替换原则，在子类中尽量不要重写父类的方法</li> <li>继承实际上让两个类耦合性增强了，在适当的情况下，可以通过聚合、组合、依赖解决问题</li></ul> <h3 id="_1-4-2-代码说明"><a href="#_1-4-2-代码说明" class="header-anchor">#</a> 1.4.2 代码说明</h3> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/4.png" alt=""></p> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/5.png" alt=""></p> <h2 id="_1-5-开闭原则"><a href="#_1-5-开闭原则" class="header-anchor">#</a> 1.5 开闭原则</h2> <h3 id="_1-5-1-基本介绍"><a href="#_1-5-1-基本介绍" class="header-anchor">#</a> 1.5.1 基本介绍</h3> <ul><li>开闭原则是编程中最基础、最重要的设计原则</li> <li>一个软件实体 如类、模块、函数应该对外扩展开放，对修改关闭。用抽象构建框架，用实现扩展细节</li> <li>当软件需要变化时，尽量通过扩展软件实体的行为来实现变化，而不是通过修改已有的代码来实现变化</li> <li>编程中遵循其他原则，以及使用设计模式的目的就是遵循开闭原则</li></ul> <h3 id="_1-5-2-代码实现"><a href="#_1-5-2-代码实现" class="header-anchor">#</a> 1.5.2 代码实现</h3> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/6.png" alt=""></p> <p>通过创建一个接口或者抽象类抽出公共部分</p> <h2 id="_1-6-迪米特法则"><a href="#_1-6-迪米特法则" class="header-anchor">#</a> 1.6 迪米特法则</h2> <h3 id="_1-6-1-基本介绍"><a href="#_1-6-1-基本介绍" class="header-anchor">#</a> 1.6.1 基本介绍</h3> <ul><li>一个对象应该对其他对象保持最少的了解</li> <li>类与类关系越密切，耦合度越大</li> <li>迪米特法则又叫最少知道原则。即一个类对自己依赖的类知道的越少越好。也就是说，对于被依赖的类不管多么复杂，都尽量将逻辑封装在类的内部。对外除了提供的 public方法，不对外泄露任何信息</li> <li>简单的定义：只与直接的朋友通信</li> <li>耦合的方式：依赖、关联、组合、聚合等，当出现成员变量、方法参数、方法返回值中的类为直接朋友，而出现在局部变量中的类不是直接的朋友，也就是说，陌生的类最好不要以局部变量的形式出现在类的内部</li></ul> <h2 id="_1-7-合成复用原则"><a href="#_1-7-合成复用原则" class="header-anchor">#</a> 1.7 合成复用原则</h2> <h3 id="_1-7-1-基本介绍"><a href="#_1-7-1-基本介绍" class="header-anchor">#</a> 1.7.1 基本介绍</h3> <p>尽量使用合成/聚合的方式，而不是使用继承</p> <h3 id="_1-7-2-代码说明"><a href="#_1-7-2-代码说明" class="header-anchor">#</a> 1.7.2 代码说明</h3> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/7.png" alt=""></p> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/8.png" alt=""></p> <h1 id="_2-uml图设计"><a href="#_2-uml图设计" class="header-anchor">#</a> 2. UML图设计</h1> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/9.png" style="zoom:67%;"> <p>UML图分类：</p> <ul><li>用例图</li> <li>静态结构图：类图、对象图、包图、组件图、部署图</li> <li>动态行为图：交互图（时序图与协作图）、状态图、活动图</li></ul> <p>类图是描述类与类之间的关系的，是 UML图中最核心的</p> <p>类之间的关系：<strong>依赖、泛化（继承）、实现、关联、聚合与组合</strong></p> <h2 id="_2-1-依赖关系"><a href="#_2-1-依赖关系" class="header-anchor">#</a> 2.1 依赖关系</h2> <p>依赖关系是最大的关系，只要有关系就可以算依赖关系</p> <h2 id="_2-2-泛化关系"><a href="#_2-2-泛化关系" class="header-anchor">#</a> 2.2 泛化关系</h2> <p>泛化关系实际上就是继承关系，是依赖关系的特例</p> <p>如果 A类继承了 B类，就说 A 和 B存在泛化关系</p> <h2 id="_2-3-关联关系"><a href="#_2-3-关联关系" class="header-anchor">#</a> 2.3 关联关系</h2> <p>关联关系是类与类之间的联系，是依赖关系的特例</p> <p>关联具有导航性，即双向关系或单向关系</p> <p>关系具有多重性：如&quot;1&quot;（表示有且仅有一个）, &quot;0...&quot;（表示0个或者多个），&quot;0, 1&quot;（表示0个或者一个），&quot;n..m&quot;（表示n 到 m个都可以）, &quot;m...*&quot;（表示至少 m 个）</p> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/10.png" alt=""></p> <h2 id="_2-4-聚合关系"><a href="#_2-4-聚合关系" class="header-anchor">#</a> 2.4 聚合关系</h2> <p>聚合关系表示的是整体和部分的关系，整体与部分可以分开。聚合关系是关联关系的特例，具有关联的导航性和多重性。如一台电脑由键盘、显示器、鼠标等组成，组成电脑的各个配件是可以从电脑上分离出来的，使用带空心菱形的实线来表示</p> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/11.png" alt=""></p> <h2 id="_2-5-组合关系"><a href="#_2-5-组合关系" class="header-anchor">#</a> 2.5 组合关系</h2> <p>组合关系：也是整体与部分的关系，但是整体与部分不可以分开</p> <p>Person 与 IDCard、Head，那么 Head 和 Person 就是组合， IDCard 和 Person就是聚合</p> <p>如果在程序中 Person实体中定义了对 IDCard 进行级联删除，即删除 Person时连同 IDCard一起删除，那么 IDCard 和 Person 就是组合了</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">IDCard</span> card<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Head</span> head <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Head</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">IDCard</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Head</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><h1 id="_3-设计模式"><a href="#_3-设计模式" class="header-anchor">#</a> 3. 设计模式</h1> <p>设计模式分为3种类型，共 23 种</p> <ul><li>创建型模式：<strong>单例模式</strong>、抽象工厂模式、原型模式、建造者模式、<strong>工厂模式</strong></li> <li>结构型模式：适配器模式、桥接模式、<strong>装饰模式</strong>、组合模式、外观模式、享元模式、<strong>代理模式</strong></li> <li>行为型模式：模板方法模式、命令模式、访问者模式、迭代器模式、<strong>观察者模式</strong>、中介者模式、备忘录模式、解释器模式（Interpreter模式）、状态模式、策略模式、责任链模式（职责链模式）</li></ul> <h2 id="_3-1-单例模式"><a href="#_3-1-单例模式" class="header-anchor">#</a> 3.1 单例模式</h2> <p>所谓类的单例设计模式，就是采取一定的方法保证在整个的软件系统中，对某个类只能存在一个对象实例，并且该类只提供一个取得其对象实例的方法</p> <p>比如：Hibernate的SessionFactory，充当数据存储源的代理，并负责创建 Session对象。SessionFactory并不是轻量级的，一般情况下，一个项目通常只需要一个 SessionFactory就够，这是就会使用到单例模式</p> <p>单例模式一般关注的点：</p> <ul><li>构造函数需要是 private 访问权限的，这样才能避免外部通过 new 创建实例；</li> <li>考虑对象创建时的线程安全问题；</li> <li>考虑是否支持延迟加载；</li> <li>考虑 getInstance() 性能是否高（是否加锁）。</li></ul> <p>单例模式有八种方式：</p> <ul><li><strong>饿汉式（静态常量）</strong></li> <li><strong>饿汉式（静态代码块）</strong></li> <li>懒汉式（线程不安全）</li> <li>懒汉式（线程安全，同步方法）</li> <li>懒汉式（线程安全，同步代码块）</li> <li><strong>双重检查</strong></li> <li><strong>静态内部类</strong></li> <li><strong>枚举</strong></li></ul> <h3 id="_3-1-1-饿汉式-静态常量"><a href="#_3-1-1-饿汉式-静态常量" class="header-anchor">#</a> 3.1.1 饿汉式（静态常量）</h3> <p>饿汉，不管用不用到都创建对象；懒汉，只有用到才创建对象</p> <p>饿汉式初始化耗时长。</p> <ol><li>如果初始化耗时长，那我们最好不要等到真正要用它的时候，才去执行这个耗时长的初始化过程，这会影响到系统的性能（比如，在响应客户端接口请求的时候，做这个初始化操作，会导致此请求的响应时间变长，甚至超时）。采用饿汉式实现方式，将耗时的初始化操作，提前到程序启动的时候完成，这样就能避免在程序运行的时候，再去初始化导致的性能问题。</li> <li>如果实例占用资源多，按照 fail-fast 的设计原则（有问题及早暴露），那我们也希望在程序启动时就将这个实例初始化好。如果资源不够，就会在程序启动的时候触发报错（比如 Java 中的 PermGen Space OOM），我们可以立即去修复。这样也能避免在程序运行一段时间后，突然因为初始化这个实例占用资源过多，导致系统崩溃，影响系统的可用性。(如果初始化消耗资源过多，反而推荐懒汉式，早日发现问题)</li></ol> <p>步骤如下：</p> <ul><li>构造器私有化（防止 new）</li> <li>类的内部创建对象</li> <li>向外暴露一个静态的公共方法。getInstance</li> <li>代码实现</li></ul> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SingletonHungry</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 测试</span>
        <span class="token class-name">Singleton</span> instance <span class="token operator">=</span> <span class="token class-name">Singleton</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Singleton</span> instance1 <span class="token operator">=</span> <span class="token class-name">Singleton</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>instance <span class="token operator">==</span> instance1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> instance<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>instance1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token comment">// 饿汉式（静态变量）</span>
<span class="token keyword">class</span> <span class="token class-name">Singleton</span> <span class="token punctuation">{</span>
    <span class="token comment">// 1. 构造器私有化，外部能 new</span>
    <span class="token keyword">private</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token comment">// 2. 本类内部创建对象实例, 编译的时候就被加载了</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 提供一个公有的静态方法，返回实例对象</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Singleton</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> instance<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>优缺点说明：</p> <ul><li>优点：这种写法比较简单，就是在类装载的时候就完成实例化。避免了线程同步问题</li> <li>缺点：在类装载的时候就完成实例化，没有达到 lazy loading的效果。如果从始至终从未使用过这个实例，则会造成内存的浪费</li> <li>这种方式基于 classloader机制避免了多线程的同步问题，不过，instance在类装载时就实例化，在单例模式中大多数都是调用 getInstance方法，但是导致类装载的原因有很多种，因此不能确定有其他的方式（或者其他的静态方法）导致类装载，这时候初始化 instance 就没有达到 lazy loading的效果</li> <li>结论：这种单例模式可用，可能造成内存浪费</li></ul> <h3 id="_3-1-2-饿汉式-静态代码块"><a href="#_3-1-2-饿汉式-静态代码块" class="header-anchor">#</a> 3.1.2 饿汉式（静态代码块）</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SingletonHungry1</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SingletonHu</span> instance <span class="token operator">=</span> <span class="token class-name">SingletonHu</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SingletonHu</span> instance1 <span class="token operator">=</span> <span class="token class-name">SingletonHu</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>instance <span class="token operator">==</span> instance1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">SingletonHu</span> <span class="token punctuation">{</span>

    <span class="token comment">// 1. 构造器私有化，外部能 new</span>
    <span class="token keyword">private</span> <span class="token class-name">SingletonHu</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
    <span class="token comment">// 2. 本类内部创建对象实例</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">SingletonHu</span> instance<span class="token punctuation">;</span>

    <span class="token keyword">static</span> <span class="token punctuation">{</span> <span class="token comment">// 在静态代码块中，创建单例对象</span>
        instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SingletonHu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 3. 提供一个公有的静态方法，返回实例对象</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">SingletonHu</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> instance<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>类实例化的过程放在了静态代码块中，也是在类装载的时候，就执行静态代码块中的代码，初始化类的实例。优缺点和上面是一样的</p> <p>这种单例模式可用，但是可能造成内存浪费</p> <h3 id="_3-1-3-懒汉式-线程不安全"><a href="#_3-1-3-懒汉式-线程不安全" class="header-anchor">#</a> 3.1.3 懒汉式（线程不安全）</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SingletonLazy2</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;懒汉式1，线程不安全&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SingletonHu2</span> instance <span class="token operator">=</span> <span class="token class-name">SingletonHu2</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SingletonHu2</span> instance1 <span class="token operator">=</span> <span class="token class-name">SingletonHu2</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>instance <span class="token operator">==</span> instance1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">SingletonHu2</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">SingletonHu2</span> instance<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">SingletonHu2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    
    <span class="token comment">// 提供一个静态的公有方法，当使用到该方法时，才会创建 instance</span>
    <span class="token comment">// 即懒汉式</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">SingletonHu2</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>instance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SingletonHu2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> instance<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>优缺点说明：</p> <ul><li>起到了 lazy loading的效果，但是只能在单线程下使用</li> <li>如果在多线程下，一个线程进入了 if(singleton == null)判断语句块，还未来得及往下执行，另一个线程也通过了这个判断语句，这时便会产生多个实例。所以多线程环境下不可使用此方式</li> <li>结论：实际开发中，不要使用此方式</li></ul> <h3 id="_3-1-4-懒汉式-线程安全-同步方法"><a href="#_3-1-4-懒汉式-线程安全-同步方法" class="header-anchor">#</a> 3.1.4 懒汉式（线程安全，同步方法）</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SingletonLazy3</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;懒汉式2，线程不安全&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SingletonHu3</span> instance <span class="token operator">=</span> <span class="token class-name">SingletonHu3</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SingletonHu3</span> instance1 <span class="token operator">=</span> <span class="token class-name">SingletonHu3</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>instance <span class="token operator">==</span> instance1<span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">SingletonHu3</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">SingletonHu3</span> instance<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">SingletonHu3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 提供一个静态的公有方法，加入同步方法解决线程不安全问题</span>
    <span class="token comment">// 即懒汉式</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">synchronized</span> <span class="token class-name">SingletonHu3</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>instance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SingletonHu3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> instance<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>优缺点说明：</p> <ul><li>解决了线程不安全的问题</li> <li>效率太低了，每个线程在想获得类的实例时候，执行 getInstance()方法都要进行同步，而其实这个方法只执行一次实例化代码就够了，后面想获得该类实例，直接 return 就行了。方法及逆行同步效率太低</li> <li>在实际开发中，不推荐</li></ul> <h3 id="_3-1-5-懒汉式-线程安全-同步代码块"><a href="#_3-1-5-懒汉式-线程安全-同步代码块" class="header-anchor">#</a> 3.1.5 懒汉式（线程安全，同步代码块）</h3> <p>优缺点说明：</p> <ul><li>这种方式并不能起到线程同步的作用，跟第3种实现方式遇到的情形一致，假如一个线程进入了 if(singleton == null) 判断语句块，还未来得及往下执行，另一个线程也通过了这个判断语句，这时便会产生多个实例</li></ul> <h3 id="_3-1-6-双重检查"><a href="#_3-1-6-双重检查" class="header-anchor">#</a> 3.1.6 双重检查</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SingletonLazy4</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;懒汉式2 使用双重检查 线程安全&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SingletonHu4</span> instance <span class="token operator">=</span> <span class="token class-name">SingletonHu4</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SingletonHu4</span> instance1 <span class="token operator">=</span> <span class="token class-name">SingletonHu4</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>instance <span class="token operator">==</span> instance1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 懒汉式（线程安全，同步方法）</span>
<span class="token keyword">class</span> <span class="token class-name">SingletonHu4</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">volatile</span> <span class="token class-name">SingletonHu4</span> instance<span class="token punctuation">;</span> <span class="token comment">// 禁止指令重排，内存线程缓存立即更新,使对象可见</span>

    <span class="token keyword">private</span> <span class="token class-name">SingletonHu4</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token comment">// 提供一个静态的公有方法，加入双重检查代码，解决线程安全问题，同时解决懒加载的问题</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">synchronized</span> <span class="token class-name">SingletonHu4</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>instance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token class-name">SingletonHu4</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>instance <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SingletonHu4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> instance<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>双重检查是多线程开发中尝使用到的，进行了两次if(singleton==null)检查，这样就可以保证线程安全了</li> <li>这样实例化代码只用执行一次，后面访问时，判断 if(singleton == null)，直接 return 实例化对象，也避免反复进行方法同步</li> <li>线程安全；延迟加载，效率较高</li> <li>结论：在实际开发中，推荐使用这种单例设计模式</li></ul> <p><code>volatile</code> 必须加，禁止指令重排</p> <h3 id="_3-1-7-静态内部类"><a href="#_3-1-7-静态内部类" class="header-anchor">#</a> 3.1.7 静态内部类</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StaticInner</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Singleton</span> instance <span class="token operator">=</span> <span class="token class-name">Singleton</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Singleton</span> instance1 <span class="token operator">=</span> <span class="token class-name">Singleton</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>instance <span class="token operator">==</span> instance1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 静态内部类完成, 推荐使用</span>
<span class="token keyword">class</span> <span class="token class-name">Singleton</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">volatile</span> <span class="token class-name">Singleton</span> instance<span class="token punctuation">;</span>

    <span class="token comment">// 构造器私有化</span>
    <span class="token keyword">private</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token comment">// 写一个静态内部类，该类中有一个静态属性 Singleton</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">SingletonInstance</span> <span class="token punctuation">{</span>
        <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Singleton</span> INSTANCE <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Singleton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 提供一个静态的公有方法，直接返回 SingletonInstance.INSTANCE</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">synchronized</span> <span class="token class-name">Singleton</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">SingletonInstance</span><span class="token punctuation">.</span>INSTANCE<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span>
</code></pre></div><p>优缺点说明：</p> <ul><li>这种方式采用了类装载的机制来保证初始化实例时只有一个线程</li> <li>静态内部类方法在 Singleton类被装载时并不会立即实例化，从而完成Singleton的实例化</li> <li>类的静态属性只会在第一次加载类的时候初始化，所以在这里，jvm帮助我们保证了线程的安全性，在类进行初始化时，别的线程是无法进入的</li> <li>优点：避免了线程不安全，利用静态内部类特点实现延迟加载，效率高</li> <li>推荐使用</li></ul> <h3 id="_3-1-8-枚举"><a href="#_3-1-8-枚举" class="header-anchor">#</a> 3.1.8 枚举</h3> <p>枚举是最安全的单例，枚举的底层就是静态的变量、方法，是不可破坏的，其余所有的单例都是可以用反射破坏的</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SingletonTest</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Singleton</span> instance <span class="token operator">=</span> <span class="token class-name">Singleton</span><span class="token punctuation">.</span>INSTANCE<span class="token punctuation">;</span>
        <span class="token class-name">Singleton</span> instance1 <span class="token operator">=</span> <span class="token class-name">Singleton</span><span class="token punctuation">.</span>INSTANCE<span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>instance <span class="token operator">==</span> instance1<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>instance<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> instance1<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        instance<span class="token punctuation">.</span><span class="token function">sayOk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">enum</span> <span class="token class-name">Singleton</span> <span class="token punctuation">{</span>
    INSTANCE<span class="token punctuation">;</span> <span class="token comment">// 属性</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sayOk</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ok~&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>优缺点说明：</p> <ul><li>枚举避免多线程同步问题，而且还能防止反序列化重新创建新的对象</li> <li>推荐使用</li></ul> <h3 id="_3-1-9-单例模式在jdk下的源码分析"><a href="#_3-1-9-单例模式在jdk下的源码分析" class="header-anchor">#</a> 3.1.9 单例模式在jdk下的源码分析</h3> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/12.png" alt=""></p> <h3 id="_3-1-10-总结"><a href="#_3-1-10-总结" class="header-anchor">#</a> 3.1.10 总结</h3> <p>推荐使用：双重检查、静态内部类、枚举、饿汉式（静态常量）、饿汉式（静态代码块）</p> <ul><li><p>单例模式保证了系统内存中该类只存在一个对象，节省了系统资源，对于一些需要频繁创建销毁的对象，使用单例模式可以提高系统性能</p></li> <li><p>当想实例化一个单例类时，需要记住相应的获取对象的方法，而不是使用 new</p></li> <li><p>单例的使用场景：需要频繁的进行创建和销毁的对象、创建对象时耗时过多或耗费资源过多（重量级对象），但又经常用到的对象、工具类对象、频繁访问数据库或文件的对象（比如数据源、session工厂等）</p></li></ul> <h2 id="_3-2-工厂模式"><a href="#_3-2-工厂模式" class="header-anchor">#</a> 3.2 工厂模式</h2> <p>工厂设计模式，顾名思义，就是用来生产对象的，在java中，万物皆对象，这些对象都需要创建，如果创建的时候直接new该对象，就会对该对象耦合严重，假如我们要更换对象，所有new对象的地方都需要修改一遍，这显然违背了软件设计的开闭原则，如果我们使用工厂来生产对象，我们就只和工厂打交道就可以了，彻底和对象解耦，如果要更换对象，直接在工厂里更换该对象即可，达到了与对象解耦的目的；所以说，工厂模式最大的优点就是：<strong>解耦</strong></p> <p>本篇主要介绍三种工厂设计模式的使用：
<strong>1、简单工厂</strong> <strong>2、工厂方法</strong> <strong>3、抽象工厂</strong></p> <h3 id="_3-2-1-简单工厂设计模式"><a href="#_3-2-1-简单工厂设计模式" class="header-anchor">#</a> 3.2.1 简单工厂设计模式</h3> <p>定义：一个工厂方法，依据传入的参数，生成对应的产品对象；
角色：
<strong>1、抽象产品</strong> <strong>2、具体产品</strong> <strong>3、具体工厂</strong> <strong>4、产品使用者</strong>
使用说明：先将产品类抽象出来，比如，苹果和梨都属于水果，抽象出来一个水果类Fruit，苹果和梨就是具体的产品类，然后创建一个水果工厂，分别用来创建苹果和梨；代码如下：</p> <p>水果接口</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Fruit</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">whatIm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>具体类 苹果</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Apple</span> <span class="token keyword">implements</span> <span class="token class-name">Fruit</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">whatIm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//苹果</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>具体类 梨</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Pear</span> <span class="token keyword">implements</span> <span class="token class-name">Fruit</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">whatIm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//梨</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>具体工厂 水果工厂</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FruitFactory</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token class-name">Fruit</span> <span class="token function">createFruit</span><span class="token punctuation">(</span><span class="token class-name">String</span> type<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>type<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;apple&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//生产苹果</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Apple</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>type<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;pear&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token comment">//生产梨</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Pear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>产品使用</p> <div class="language-java extra-class"><pre class="language-java"><code> <span class="token class-name">FruitFactory</span> mFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FruitFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token class-name">Apple</span> apple <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Apple</span><span class="token punctuation">)</span> mFactory<span class="token punctuation">.</span><span class="token function">createFruit</span><span class="token punctuation">(</span><span class="token string">&quot;apple&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获得苹果</span>
 <span class="token class-name">Pear</span> pear <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Pear</span><span class="token punctuation">)</span> mFactory<span class="token punctuation">.</span><span class="token function">createFruit</span><span class="token punctuation">(</span><span class="token string">&quot;pear&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获得梨</span>
</code></pre></div><p>就这样，一个非常简单的工厂设计模式就完成了，但是有没有发现什么问题呢？
对，那就是如果我想吃香蕉，想吃橘子呢，我万一什么都想吃呢？？所以，以上的这种方式，每当我想添加一种水果，就必然要修改工厂类，这显然违反了开闭原则，亦不可取；所以简单工厂只适合于产品对象较少，且产品固定的需求，对于产品变化无常的需求来说显然不合适；所以我们来看下一种方式；</p> <h3 id="_3-2-2-工厂方法设计模式"><a href="#_3-2-2-工厂方法设计模式" class="header-anchor">#</a> 3.2.2 工厂方法设计模式</h3> <p>定义：将工厂提取成一个接口或抽象类，具体生产什么产品由子类决定；
角色：
<strong>抽象产品类</strong> <strong>具体产品类</strong> <strong>抽象工厂类</strong> <strong>具体工厂类</strong>
使用说明：和上例中一样，产品类抽象出来，这次我们把工厂类也抽象出来，生产什么样的产品由子类来决定；
代码如下：
水果接口 苹果类和梨类 代码和上例一样</p> <p>工厂接口</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">FruitFactory</span> <span class="token punctuation">{</span>
    <span class="token class-name">Fruit</span> <span class="token function">createFruit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//生产水果</span>
<span class="token punctuation">}</span>
</code></pre></div><p>苹果工厂</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppleFactory</span> <span class="token keyword">implements</span> <span class="token class-name">FruitFactory</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Fruit</span> <span class="token function">createFruit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Apple</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>梨工厂</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PearFactory</span> <span class="token keyword">implements</span> <span class="token class-name">FruitFactory</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Fruit</span> <span class="token function">createFruit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Pear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>使用</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">AppleFactory</span> appleFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AppleFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">PearFactory</span> pearFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PearFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">Apple</span> apple <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Apple</span><span class="token punctuation">)</span> appleFactory<span class="token punctuation">.</span><span class="token function">createFruit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获得苹果</span>
<span class="token class-name">Pear</span> pear <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Pear</span><span class="token punctuation">)</span> pearFactory<span class="token punctuation">.</span><span class="token function">createFruit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//获得梨</span>
</code></pre></div><p>以上这种方式，虽然解耦了，也遵循了开闭原则，但是问题根本还是没有解决啊，换汤没换药，如果我需要的产品很多的话，需要创建非常多的工厂，所以这种方式的缺点也很明显；违反了设计模式的 ocp原则，即对外扩展开放，对修改关闭</p> <h3 id="_3-2-3-抽象工厂设计模式"><a href="#_3-2-3-抽象工厂设计模式" class="header-anchor">#</a> 3.2.3 抽象工厂设计模式</h3> <p>定义：为创建一组相关或者是相互依赖的对象提供的一个接口，而不需要指定它们的具体类。
角色：和工厂方法一样
抽象工厂和工厂方法的模式基本一样，区别在于，工厂方法是生产一个具体的产品，而抽象工厂可以用来生产一组相同，有相对关系的产品；重点在于一组，一批，一系列；举个例子，假如生产小米手机，小米手机有很多系列，小米note、红米note等；假如小米note生产需要的配件有825的处理器，6英寸屏幕，而红米只需要650的处理器和5寸的屏幕就可以了；用抽象工厂来实现：</p> <p>cpu接口和实现类</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Cpu</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">class</span> <span class="token class-name">Cpu650</span> <span class="token keyword">implements</span> <span class="token class-name">Cpu</span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//625 也厉害</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">class</span> <span class="token class-name">Cpu825</span> <span class="token keyword">implements</span> <span class="token class-name">Cpu</span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//825 处理更强劲</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>屏幕接口和实现类</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Screen</span> <span class="token punctuation">{</span>

    <span class="token keyword">void</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">class</span> <span class="token class-name">Screen5</span> <span class="token keyword">implements</span> <span class="token class-name">Screen</span> <span class="token punctuation">{</span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//5寸</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">class</span> <span class="token class-name">Screen6</span> <span class="token keyword">implements</span> <span class="token class-name">Screen</span> <span class="token punctuation">{</span>

        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//6寸</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>工厂接口</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">PhoneFactory</span> <span class="token punctuation">{</span>

    <span class="token class-name">Cpu</span> <span class="token function">getCpu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//使用的cpu</span>

    <span class="token class-name">Screen</span> <span class="token function">getScreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//使用的屏幕</span>
<span class="token punctuation">}</span>
</code></pre></div><p>具体工厂实现类：小米手机工厂</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">XiaoMiFactory</span> <span class="token keyword">implements</span> <span class="token class-name">PhoneFactory</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Cpu</span> <span class="token function">getCpu</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Cpu<span class="token punctuation">.</span>Cpu825</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//高性能处理器</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Screen</span> <span class="token function">getScreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Screen<span class="token punctuation">.</span>Screen6</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//6寸大屏</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>具体工厂实现类：红米手机工厂</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HongMiFactory</span> <span class="token keyword">implements</span> <span class="token class-name">PhoneFactory</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Cpu</span> <span class="token function">getCpu</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Cpu<span class="token punctuation">.</span>Cpu650</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//高效处理器</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Screen</span> <span class="token function">getScreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Screen<span class="token punctuation">.</span>Screen5</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//小屏手机</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>以上例子可以看出，抽象工厂可以解决一系列的产品生产的需求，对于大批量，多系列的产品，用抽象工厂可以更好的管理和扩展；</p> <p><strong>三种工厂方式总结：</strong>
1、对于简单工厂和工厂方法来说，两者的使用方式实际上是一样的，如果对于产品的分类和名称是确定的，数量是相对固定的，推荐使用简单工厂模式；
2、抽象工厂用来解决相对复杂的问题，适用于一系列、大批量的对象生产；</p> <h3 id="_3-2-4-calendar-源码分析"><a href="#_3-2-4-calendar-源码分析" class="header-anchor">#</a> 3.2.4 Calendar 源码分析</h3> <p>简单工厂模式</p> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/13.png" alt=""></p> <h2 id="_3-3-原型模式"><a href="#_3-3-原型模式" class="header-anchor">#</a> 3.3 原型模式</h2> <h3 id="_3-3-1-实现方式"><a href="#_3-3-1-实现方式" class="header-anchor">#</a> 3.3.1 实现方式</h3> <p>参考：https://blog.csdn.net/zhengzhb/article/details/7393528</p> <p>定义：用原型实例指定创建对象的种类，并通过拷贝这些原型创建新的对象。</p> <p>类型：创建类模式</p> <p>类图：</p> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/1.jpg" alt=""></p> <p>原型模式主要用于对象的复制，它的核心是就是类图中的原型类Prototype。Prototype类需要具备以下两个条件：</p> <ul><li>实现Cloneable接口。在java语言有一个Cloneable接口，它的作用只有一个，就是在运行时通知虚拟机可以安全地在实现了此接口的类上使用clone方法。在java虚拟机中，只有实现了这个接口的类才可以被拷贝，否则在运行时会抛出CloneNotSupportedException异常。</li> <li>重写Object类中的clone方法。Java中，所有类的父类都是Object类，Object类中有一个clone方法，作用是返回对象的一个拷贝，但是其作用域protected类型的，一般的类无法调用，因此，Prototype类需要将clone方法的作用域修改为public类型。</li></ul> <p>​        原型模式是一种比较简单的模式，也非常容易理解，实现一个接口，重写一个方法即完成了原型模式。在实际应用中，原型模式很少单独出现。经常与其他模式混用，他的原型类Prototype也常用抽象类来替代。</p> <p>实现代码：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Prototype</span> <span class="token keyword">implements</span> <span class="token class-name">Cloneable</span> <span class="token punctuation">{</span>
	<span class="token keyword">public</span> <span class="token class-name">Prototype</span> <span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token class-name">Prototype</span> prototype <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
		<span class="token keyword">try</span><span class="token punctuation">{</span>
			prototype <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Prototype</span><span class="token punctuation">)</span><span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">CloneNotSupportedException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
			e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> prototype<span class="token punctuation">;</span> 
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">ConcretePrototype</span> <span class="token keyword">extends</span> <span class="token class-name">Prototype</span><span class="token punctuation">{</span>
	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;原型模式实现类&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>
	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token class-name">ConcretePrototype</span> cp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcretePrototype</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token class-name">ConcretePrototype</span> clonecp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ConcretePrototype</span><span class="token punctuation">)</span>cp<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			clonecp<span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>原型模式的优点及适用场景</p></blockquote> <p>使用原型模式创建对象比直接new一个对象在性能上要好的多，因为Object类的clone方法是一个本地方法，它直接操作内存中的二进制流，特别是复制大对象时，性能的差别非常明显。</p> <p>使用原型模式的另一个好处是简化对象的创建，使得创建对象就像我们在编辑文档时的复制粘贴一样简单。</p> <p>因为以上优点，所以在需要重复地创建相似对象时可以考虑使用原型模式。比如需要在一个循环体内创建对象，假如对象创建过程比较复杂或者循环次数很多的话，使用原型模式不但可以简化创建过程，而且可以使系统的整体性能提高很多。</p> <blockquote><p>原型模式的注意事项</p></blockquote> <p>​	使用原型模式复制对象不会调用类的构造方法。因为对象的复制是通过调用Object类的clone方法来完成的，<strong>它直接在内存中复制数据，因此不会调用到类的构造方法。不但构造方法中的代码不会执行，甚至连访问权限都对原型模式无效</strong>。还记得单例模式吗？单例模式中，只要将构造方法的访问权限设置为private型，就可以实现单例。但是clone方法直接无视构造方法的权限，所以，单例模式与原型模式是冲突的，在使用时要特别注意。
深拷贝与浅拷贝。Object类的clone方法只会拷贝对象中的基本的数据类型，对于数组、容器对象、引用对象等都不会拷贝，这就是浅拷贝。如果要实现深拷贝，必须将原型模式中的数组、容器对象、引用对象等另行拷贝。例如：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Prototype</span> <span class="token keyword">implements</span> <span class="token class-name">Cloneable</span> <span class="token punctuation">{</span>
	<span class="token keyword">private</span> <span class="token class-name">ArrayList</span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token class-name">Prototype</span> <span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token class-name">Prototype</span> prototype <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
		<span class="token keyword">try</span><span class="token punctuation">{</span>
			prototype <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Prototype</span><span class="token punctuation">)</span><span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			prototype<span class="token punctuation">.</span>list <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ArrayList</span><span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>list<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">CloneNotSupportedException</span> e<span class="token punctuation">)</span><span class="token punctuation">{</span>
			e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		<span class="token keyword">return</span> prototype<span class="token punctuation">;</span> 
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>​        由于ArrayList不是基本类型，所以成员变量list，不会被拷贝，需要我们自己实现深拷贝，幸运的是java提供的大部分的容器类都实现了Cloneable接口。所以实现深拷贝并不是特别困难。</p> <p>PS：深拷贝与浅拷贝问题中，会发生深拷贝的有java中的8中基本类型以及他们的封装类型，另外还有String类型。其余的都是浅拷贝。</p> <h3 id="_3-3-2-bean-创建过程分析"><a href="#_3-3-2-bean-创建过程分析" class="header-anchor">#</a> 3.3.2 bean 创建过程分析</h3> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/14.png" alt=""></p> <h3 id="_3-3-3-浅拷贝和深拷贝"><a href="#_3-3-3-浅拷贝和深拷贝" class="header-anchor">#</a> 3.3.3 浅拷贝和深拷贝</h3> <ul><li>浅拷贝：创建一个新对象，新对象的属性和原来对象完全相同，对于非基本类型属性，仍指向原有属性所指向的对象的内存地址。</li> <li>深拷贝：创建一个新对象，属性中引用的其他对象也会被克隆，不再指向原有对象地址。</li></ul> <p>深拷贝实现方式：</p> <ul><li>重写 clone 方法</li> <li>对象序列化</li></ul> <h2 id="_3-4-建造者模式"><a href="#_3-4-建造者模式" class="header-anchor">#</a> 3.4 建造者模式</h2> <h3 id="_3-4-1-分析"><a href="#_3-4-1-分析" class="header-anchor">#</a> 3.4.1 分析</h3> <p>https://blog.csdn.net/hguisu/article/details/7518060</p> <p>建造者模式又叫生成器模式，是一种对象构建模式。它可以将复杂对象的建造过程抽象出来（抽象类别），使这个抽象过程的不同实现方法可以构造出不同表现（属性）的对象</p> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/15.png" style="zoom:67%;"> <p>四个角色：</p> <ul><li>Product（产品角色）：一个具体的产品对象</li> <li>Builder（抽象建造者）：创建一个 Product 对象的各个部件指定的接口/抽象类</li> <li>ConcreteBuilder（具体建造者）：实现接口，构建和装配各个部件</li> <li>Director（指挥者）：构建一个使用 Builder 接口的对象，主要用于创建一个复杂的对象，作用：1. 隔离客户与对象的生产过程，2. 负责控制产品对象的生产过程</li></ul> <p>Builder模式的主要效果：</p> <p>1 ) 它使你可以改变一个产品的内部表示 Builder对象提供给导向器一个构造产品的抽象接口。该接口使得生成器可以隐藏这个产品的表示和内部结构。它同时也隐藏了该产品是如何装配的。因为产品是通过抽象接口构造的，你在改变该产品的内部表示时所要做的只是定义一个新的生成器。</p> <ol start="2"><li>它将构造代码和表示代码分开 Builder模式通过封装一个复杂对象的创建和表示方式提高了对象的模块性。客户不需要知道定义产品内部结构的类的所有信息；这些类是不出现在Builder接口中的。每个Concrete Builder包含了创建和装配一个特定产品的所有代码。这些代码只需要写一次；然后不同的Director可以复用它以在相同部件集合的基础上构作不同的Product。</li></ol> <p>3 ) 它使你可对构造过程进行更精细的控制 Builder模式与一下子就生成产品的创建型模式不同，它是在导向者的控制下一步一步构造产品的。仅当该产品完成时导向者才从生成器中取回它。因此Builder接口相比其他创建型模式能更好的反映产品的构造过程。这使你可以更精细的控制构建过程，从而能更精细的控制所得产品的内部结构。</p> <h3 id="_3-4-2-jdk中的应用"><a href="#_3-4-2-jdk中的应用" class="header-anchor">#</a> 3.4.2 JDK中的应用</h3> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/16.png" alt=""></p> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/17.png" alt=""></p> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/18.png" alt=""></p> <h2 id="_3-5-适配器模式"><a href="#_3-5-适配器模式" class="header-anchor">#</a> 3.5 适配器模式</h2> <h3 id="_3-5-1-分析"><a href="#_3-5-1-分析" class="header-anchor">#</a> 3.5.1 分析</h3> <p>https://blog.csdn.net/zjh942328003/article/details/106363439</p> <ol><li>适配器模式（Adapter Pattern）将某个类的接口转换成客户端期望的另一个接口表示，让原本因接口不匹配不能一起工作的两个类可以协同工作。其别名为包装器（Wrapper）</li></ol> <p>2）适配器主要分为三类：类适配器模式、对象适配器模式和接口适配器模式</p> <p>适配器的三个角色</p> <ol><li>被适配者（Adaptee）</li> <li>适配者（Adapter）</li> <li>适配过后的接口（targetService）</li></ol> <blockquote><p>类适配器的缺点：</p></blockquote> <p><strong>适配类是继承与被适配类，这样就导致我们适配过后给客户使用的必须为接口并且如果我们相对被适配者的子类进行也进行适配会发现没法适配，所有就有了对象适配，对象适配的原理其实跟类适配的原理是一样的，只不过对象适配模式是利用组合/聚合的方式来使用被适配者</strong></p> <blockquote><p>对象适配器</p></blockquote> <p>类适配器使用的是继承的方式，直接继承了Adaptee，所以无法对Adaptee的子类进行适配。</p> <p>对象适配器使用的是组合的方式，·所以Adaptee及其子孙类都可以被适配。另外，对象适配器对于增加一些新行为非常方便，而且新增加的行为同时适用于所有的源。</p> <p>基于组合/聚合优于继承的原则，使用对象适配器是更好的选择。但具体问题应该具体分析，某些情况可能使用类适配器会适合，最适合的才是最好的。</p> <blockquote><p>接口适配器</p></blockquote> <p>接口适配器模式也叫缺省适配器模式。当不需要全部实现接口提供的方法时，可以先设计一个抽象类实现该接口，并对该接口的所有方法提供一个默认实现（实现内容都是空的），然后抽象类的子类在有选择性的重写需要的方法。这样子类可以从这个缺省实现进行扩展，而不必从原有接口进行扩展-------jdk中很多监听都是用的这种模式。</p> <ul><li><p>更好的复用性：系统需要使用现有的类，而此类的接口不符合系统的需要。那么通过适配器模式就可以让这些功能得到更好的复用。</p></li> <li><p>更好的扩展性：在实现适配器功能的时候，可以扩展自己源的行为（增加方法），从而自然地扩展系统的功能</p></li></ul> <h3 id="_3-5-2-springmvc中的使用"><a href="#_3-5-2-springmvc中的使用" class="header-anchor">#</a> 3.5.2 springmvc中的使用</h3> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/19.png" alt=""></p> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/20.png" alt=""></p> <h2 id="_3-6-桥接模式"><a href="#_3-6-桥接模式" class="header-anchor">#</a> 3.6 桥接模式</h2> <h2 id="_3-7-装饰者模式"><a href="#_3-7-装饰者模式" class="header-anchor">#</a> 3.7 装饰者模式</h2> <h2 id="_3-8-组合模式"><a href="#_3-8-组合模式" class="header-anchor">#</a> 3.8 组合模式</h2> <h3 id="_3-8-1-基本介绍"><a href="#_3-8-1-基本介绍" class="header-anchor">#</a> 3.8.1 基本介绍</h3> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/21.png" style="zoom:67%;"> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/22.png" style="zoom:67%;"> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/23.png" style="zoom:67%;"> <h3 id="_3-8-2-代码实现"><a href="#_3-8-2-代码实现" class="header-anchor">#</a> 3.8.2 代码实现</h3> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/24.png" style="zoom:50%;"> <p>OrganizationComponent 抽象类</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">OrganizationComponent</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span> <span class="token comment">// 名字</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> des<span class="token punctuation">;</span> <span class="token comment">// 说明</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">OrganizationComponent</span> organizationComponent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 默认实现</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UnsupportedOperationException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token class-name">OrganizationComponent</span> organizationComponent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 默认实现</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UnsupportedOperationException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token class-name">OrganizationComponent</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">String</span> des<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>des <span class="token operator">=</span> des<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 方法 print，做成抽象的 子类都需要实现</span>
    <span class="token keyword">protected</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
	<span class="token comment">// set, get 方法</span>
<span class="token punctuation">}</span>

</code></pre></div><p>组合 <code>University</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// University 就是 Composite，可以管理 College</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">University</span> <span class="token keyword">extends</span> <span class="token class-name">OrganizationComponent</span><span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">OrganizationComponent</span><span class="token punctuation">&gt;</span></span> organizationComponents <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">OrganizationComponent</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 构造方法</span>

    <span class="token comment">// 重写 add</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">OrganizationComponent</span> organizationComponent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        organizationComponents<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>organizationComponent<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 重写 remove</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token class-name">OrganizationComponent</span> organizationComponent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        organizationComponents<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>organizationComponent<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getDes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">getDes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;=======================&quot;</span> <span class="token operator">+</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;===============================&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 遍历 organizationComponents</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">OrganizationComponent</span> organizationComponent <span class="token operator">:</span> organizationComponents<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            organizationComponent<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>组合 <code>College</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">College</span> <span class="token keyword">extends</span> <span class="token class-name">OrganizationComponent</span><span class="token punctuation">{</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">OrganizationComponent</span><span class="token punctuation">&gt;</span></span> organizationComponents <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">OrganizationComponent</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

	<span class="token comment">// 构造方法</span>

    <span class="token comment">// 重写 add</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">OrganizationComponent</span> organizationComponent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 将来实际业务中，College 的 add 和 University的不一定相同</span>
        organizationComponents<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>organizationComponent<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 重写 remove</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token class-name">OrganizationComponent</span> organizationComponent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        organizationComponents<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>organizationComponent<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getDes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">getDes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;=======================&quot;</span> <span class="token operator">+</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;===============================&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 遍历 organizationComponents</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">OrganizationComponent</span> organizationComponent <span class="token operator">:</span> organizationComponents<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            organizationComponent<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>叶子节点</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 系</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Department</span> <span class="token keyword">extends</span> <span class="token class-name">OrganizationComponent</span><span class="token punctuation">{</span>

    <span class="token comment">// 没有集合，因为是叶子节点</span>
    <span class="token keyword">public</span> <span class="token class-name">Department</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">String</span> des<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> des<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// add, remove 就不用写了，因为他是叶子节点</span>


    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getDes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">getDes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>client进行调用</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">// 从大到小创建对象 学校</span>
        <span class="token class-name">OrganizationComponent</span> university <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">University</span><span class="token punctuation">(</span><span class="token string">&quot;清华大学&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;中国顶级大学&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 创建学院</span>
        <span class="token class-name">OrganizationComponent</span> computerCollege <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">College</span><span class="token punctuation">(</span><span class="token string">&quot;计算机学院&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;计算机学院&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">OrganizationComponent</span> infoEngineerCollege <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">College</span><span class="token punctuation">(</span><span class="token string">&quot;信息工程学院&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;信息工程学院&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 创建各个学院下面的系（专业）</span>
        computerCollege<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Department</span><span class="token punctuation">(</span><span class="token string">&quot;软件工程&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot; 软件工程不错&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        computerCollege<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Department</span><span class="token punctuation">(</span><span class="token string">&quot;网络工程&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot; 网络工程不错&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        computerCollege<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Department</span><span class="token punctuation">(</span><span class="token string">&quot;计算机科学与技术&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot; 计算机科学与技术老牌专业&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        infoEngineerCollege<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Department</span><span class="token punctuation">(</span><span class="token string">&quot;通信工程&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;不好学&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        infoEngineerCollege<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Department</span><span class="token punctuation">(</span><span class="token string">&quot;信息工程&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;信息工程好学&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 将学院加入到 学校</span>
        university<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>computerCollege<span class="token punctuation">)</span><span class="token punctuation">;</span>
        university<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>infoEngineerCollege<span class="token punctuation">)</span><span class="token punctuation">;</span>

        university<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        infoEngineerCollege.print();</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/25.png" style="zoom:67%;"> <h3 id="_3-8-3-hashmap实现组合模式"><a href="#_3-8-3-hashmap实现组合模式" class="header-anchor">#</a> 3.8.3 HashMap实现组合模式</h3> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/26.png" style="zoom:67%;"> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/28.png" alt=""></p> <h3 id="_3-8-4-注意事项"><a href="#_3-8-4-注意事项" class="header-anchor">#</a> 3.8.4 注意事项</h3> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/29.png" alt=""></p> <h2 id=""><a href="#" class="header-anchor">#</a></h2> <h2 id="_3-9-外观模式"><a href="#_3-9-外观模式" class="header-anchor">#</a> 3.9 外观模式</h2> <h3 id="_3-9-1-外观模式介绍"><a href="#_3-9-1-外观模式介绍" class="header-anchor">#</a> 3.9.1 外观模式介绍</h3> <p>外观模式也叫 过程模式；外观模式为子系统中的一组接口提供一个一致的界面，此模式定义了一个高层接口，这个接口使得这一子系统更加容易使用</p> <p>外观模式通过定义一个一致的接口，用以屏蔽内部子系统的细节，使得调用端口只需跟这个接口发生调用，而无需关心这个子系统的内部细节</p> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/30.png" alt=""></p> <h3 id="_3-9-2-代码实现"><a href="#_3-9-2-代码实现" class="header-anchor">#</a> 3.9.2 代码实现</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DVDPlayer</span> <span class="token punctuation">{</span>

    <span class="token comment">// 使用单例模式，使用饿汉式</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">DVDPlayer</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DVDPlayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">DVDPlayer</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> instance<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">on</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot; dvd on &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot; dvd is playing &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ...</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot; dvd pause .. &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Popcorn</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Popcorn</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Popcorn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Popcorn</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> instance<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">on</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot; popcorn on&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">off</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot; popcorn off &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot; popcorn is popping &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Projector</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Projector</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Projector</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Projector</span> <span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> instance<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">on</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot; Projector on&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">off</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot; Projector off &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot; Projector is Projector &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HomeTheaterFacade</span> <span class="token punctuation">{</span>

    <span class="token comment">// 各个子对象</span>
    <span class="token keyword">private</span> <span class="token class-name">Popcorn</span> popcorn<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">DVDPlayer</span> dvdPlayer<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Projector</span> projector<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">HomeTheaterFacade</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>popcorn <span class="token operator">=</span> <span class="token class-name">Popcorn</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>dvdPlayer <span class="token operator">=</span> <span class="token class-name">DVDPlayer</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>projector <span class="token operator">=</span> <span class="token class-name">Projector</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">ready</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        popcorn<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        popcorn<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dvdPlayer<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        projector<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_3-9-3-mybatis源码分析"><a href="#_3-9-3-mybatis源码分析" class="header-anchor">#</a> 3.9.3 Mybatis源码分析</h3> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/31.png" alt=""></p> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/32.png" style="zoom:67%;"> <h3 id="_3-9-4-注意模式"><a href="#_3-9-4-注意模式" class="header-anchor">#</a> 3.9.4 注意模式</h3> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/33.png" style="zoom:67%;"> <h2 id="_3-10-享元模式"><a href="#_3-10-享元模式" class="header-anchor">#</a> 3.10 享元模式</h2> <h3 id="_3-10-1-介绍"><a href="#_3-10-1-介绍" class="header-anchor">#</a> 3.10.1 介绍</h3> <p>共享解决重复对象内存浪费问题</p> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/34.png" style="zoom:67%;"> <h3 id="_3-10-2-代码类图"><a href="#_3-10-2-代码类图" class="header-anchor">#</a> 3.10.2 代码类图</h3> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/35.png" alt=""></p> <h3 id="_3-10-3-integer源码分析"><a href="#_3-10-3-integer源码分析" class="header-anchor">#</a> 3.10.3 Integer源码分析</h3> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/36.png" style="zoom:67%;"> <h3 id="_3-10-4-注意事项"><a href="#_3-10-4-注意事项" class="header-anchor">#</a> 3.10.4 注意事项</h3> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/37.png" style="zoom:67%;"> <h2 id="_3-11-代理模式"><a href="#_3-11-代理模式" class="header-anchor">#</a> 3.11 代理模式</h2> <h3 id="_3-11-1-介绍"><a href="#_3-11-1-介绍" class="header-anchor">#</a> 3.11. 1 介绍</h3> <p>为对象提供一个替身，以控制对这个对象的访问。即通过代理对象访问目标对象，可以在目标对象实现的基础上，增强额外的功能操作，即扩展目标对象的功能</p> <p>对代理的对象可以是远程对象、创建开销大的对象或需要安全控制的对象</p> <p>代理主要有三种方式</p> <ul><li>静态代理</li> <li>动态代理（JDK代理、接口代理）</li> <li>cglib代理（可以在内存动态的创建对象，而不需要实现接口，他是属于动态代理的范畴）</li></ul> <p>装饰者模式 n - n, 这是代理 1- n</p> <h3 id="_3-11-2-静态代理"><a href="#_3-11-2-静态代理" class="header-anchor">#</a> 3.11.2 静态代理</h3> <h4 id="_3-11-2-1-介绍"><a href="#_3-11-2-1-介绍" class="header-anchor">#</a> 3.11.2.1 介绍</h4> <p>静态代理在使用时，需要定义接口或者父类，被代理对象（即目标对象）与代理对象一起实现相同的接口或者继承相同父类</p> <ul><li>定义一个接口 <code>ITeacherDao</code></li> <li>目标对象 <code>TeacherDao</code> 实现接口 <code>ITeahcerDao</code></li> <li>使用静态代理方式，就需要在代理对象 <code>TeacherDaoProxy</code> 中也实现 <code>ITeacherDao</code></li> <li>嗲用的时候通过代理对象的方法来调用目标对象</li> <li>提醒：代理对象与目标对象要实现相同的接口，然后通过调用相同的方法来调用目标对象的方法</li></ul> <h4 id="_3-11-2-2-实现"><a href="#_3-11-2-2-实现" class="header-anchor">#</a> 3.11.2.2 实现</h4> <p>UML类图</p> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/38.png" style="zoom:50%;"> <p>接口 <code>ITeacherDao</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ITeacherDao</span> <span class="token punctuation">{</span><span class="token keyword">void</span> <span class="token function">teach</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">}</span> <span class="token comment">// 授课的方法</span>
</code></pre></div><p><code>TeacherDao</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TeacherDao</span> <span class="token keyword">implements</span> <span class="token class-name">ITeacherDao</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">teach</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot; 老师授课中... &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>代理对象 <code>TeacherDaoProxy</code></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TeacherDaoProxy</span> <span class="token keyword">implements</span> <span class="token class-name">ITeacherDao</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token class-name">ITeacherDao</span> target<span class="token punctuation">;</span> <span class="token comment">// 目标对象，通过接口来聚合</span>

    <span class="token comment">// 构造器,通过 构造器注入 </span>
    <span class="token keyword">public</span> <span class="token class-name">TeacherDaoProxy</span><span class="token punctuation">(</span><span class="token class-name">ITeacherDao</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>target <span class="token operator">=</span> target<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">teach</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;开始代理....完成某些操作&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        target<span class="token punctuation">.</span><span class="token function">teach</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;提交....&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>使用</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 创建目标对象（被代理对象）</span>
        <span class="token class-name">TeacherDao</span> teacherDao <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TeacherDao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 创建代理对象，同时将被代理对象传递给代理对象</span>
        <span class="token class-name">TeacherDaoProxy</span> teacherDaoProxy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TeacherDaoProxy</span><span class="token punctuation">(</span>teacherDao<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 通过代理对象，调用到被代理对象的方法</span>
        <span class="token comment">// 即：执行的是代理对象的方法，代理对象再去调用目标对象的方法</span>
        teacherDaoProxy<span class="token punctuation">.</span><span class="token function">teach</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h4 id="_3-11-2-3-静态代理优缺点"><a href="#_3-11-2-3-静态代理优缺点" class="header-anchor">#</a> 3.11.2.3 静态代理优缺点</h4> <ul><li>优点：在不修改目标对象的功能前提下，能通过代理对象对目标功能扩展</li> <li>缺点：因为代理对象需要与目标对象实现一样的接口，所以会有很多代理类</li> <li>一旦接口增加方法，目标对象与代理对象都要维护</li></ul> <h3 id="_3-11-3-动态代理"><a href="#_3-11-3-动态代理" class="header-anchor">#</a> 3.11.3 动态代理</h3> <h4 id="_3-11-3-1-介绍"><a href="#_3-11-3-1-介绍" class="header-anchor">#</a> 3.11.3.1 介绍</h4> <ul><li>代理对象不需要接口，但是目标对象要实现接口，否则不能用动态代理</li> <li>代理对象的生成，是利用JDK的API，动态的在内存中构建代理对象</li> <li>动态代理也叫 JDK代理，接口代理</li></ul> <h4 id="_3-11-3-2-实现"><a href="#_3-11-3-2-实现" class="header-anchor">#</a> 3.11.3.2 实现</h4> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/39.png" style="zoom:50%;"> <p><code>ITeacherDao</code> 接口</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 接口</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ITeacherDao</span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">teach</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">void</span> <span class="token function">sayHello</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>TeacherDao</code> 实现</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TeacherDao</span> <span class="token keyword">implements</span> <span class="token class-name">ITeacherDao</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">teach</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot; 老师授课中 ....&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sayHello</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;hello &quot;</span> <span class="token operator">+</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>ProxyFactory</code> 代理对象</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">/**
     * ClassLoader: 指定当前目标对象使用的类加载器，获取加载方器从方法验证
     * Class&lt;?&gt;[] interfaces： 目标对象实现的接口类型，使用泛型确认类型
     * InvocationHandler h: 事情护处理，执行目标对象的方法时，会触发事情处理器方法
     * @return
     */</span>
<span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token function">newProxyInstance</span><span class="token punctuation">(</span><span class="token class-name">ClassLoader</span> loader<span class="token punctuation">,</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">[</span><span class="token punctuation">]</span> interfaces<span class="token punctuation">,</span> <span class="token class-name">InvocationHandler</span> h<span class="token punctuation">)</span>
</code></pre></div><div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProxyFactory</span> <span class="token punctuation">{</span>

    <span class="token comment">// 维护一个目标对象，Object</span>
    <span class="token keyword">private</span> <span class="token class-name">Object</span> target<span class="token punctuation">;</span>

    <span class="token comment">// 构造器，对 target 进行初始化</span>
    <span class="token keyword">public</span> <span class="token class-name">ProxyFactory</span><span class="token punctuation">(</span><span class="token class-name">Object</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>target <span class="token operator">=</span> target<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 给目标对象生成一个代理对象</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">getProxyInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Proxy</span><span class="token punctuation">.</span><span class="token function">newProxyInstance</span><span class="token punctuation">(</span>target<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> target<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getInterfaces</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">InvocationHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">Object</span> proxy<span class="token punctuation">,</span> <span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Throwable</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;JDK代理开始&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 反射机制调用目标对象的方法</span>
                <span class="token class-name">Object</span> returnVal <span class="token operator">=</span> method<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;JDK代理提交&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> returnVal<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>调用实现</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Client</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token class-name">ITeacherDao</span> target <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TeacherDao</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 给目标对象创建代理对象，可以转成 ITeacherDao</span>
        <span class="token class-name">ITeacherDao</span> proxyInstance <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ITeacherDao</span><span class="token punctuation">)</span> <span class="token keyword">new</span> <span class="token class-name">ProxyFactory</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getProxyInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// proxyInstance = class com.sun.proxy.$Proxy0</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;proxyInstance = &quot;</span> <span class="token operator">+</span> proxyInstance<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 通过代理对象，调用目标对象的方法</span>
<span class="token comment">//        proxyInstance.teach();</span>
        proxyInstance<span class="token punctuation">.</span><span class="token function">sayHello</span><span class="token punctuation">(</span><span class="token string">&quot;周&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>打印结果</p> <div class="language-java extra-class"><pre class="language-java"><code>proxyInstance <span class="token operator">=</span> <span class="token keyword">class</span> com<span class="token punctuation">.</span>sun<span class="token punctuation">.</span>proxy<span class="token punctuation">.</span>$<span class="token class-name">Proxy0</span>
JDK代理开始
hello 周
JDK代理提交
</code></pre></div><h3 id="_3-11-4-cglib代理"><a href="#_3-11-4-cglib代理" class="header-anchor">#</a> 3.11.4 cglib代理</h3> <p>静态代理和JDK代理模式都要求目标对象是实现一个接口，如果只是类的话可以使用 cglib代理（子类代理）,被spring aop实现方法拦截</p> <p>在 aop中选择代理模式</p> <ul><li>目标对象需要实现接口，用 JDK代理</li> <li>目标对象不需要实现接口，用 cglib代理</li></ul> <p>代理类不能为 final，或者目标对象 方法不能为 final/staic，因为不会被拦截</p> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/40.png" style="zoom:67%;"> <h3 id="_3-11-5-变体"><a href="#_3-11-5-变体" class="header-anchor">#</a> 3.11.5 变体</h3> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/41.png" style="zoom:50%;"> <h2 id="_3-12-模板方法模式"><a href="#_3-12-模板方法模式" class="header-anchor">#</a> 3.12 模板方法模式</h2> <p>在一个抽象类公开定义执行方法模板，子类可按需重写方法实现</p> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/42.png" style="zoom:67%;"> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/43.png" alt=""></p> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/44.png" style="zoom:67%;"> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/45.png" style="zoom:67%;"> <h2 id="_3-13-命令模式"><a href="#_3-13-命令模式" class="header-anchor">#</a> 3.13 命令模式</h2> <h3 id="_3-13-1-基本介绍"><a href="#_3-13-1-基本介绍" class="header-anchor">#</a> 3.13.1 基本介绍</h3> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/46.png" alt=""></p> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/47.png" style="zoom:67%;"> <h3 id="_3-13-2-原理类图"><a href="#_3-13-2-原理类图" class="header-anchor">#</a> 3.13.2 原理类图</h3> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/48.png" style="zoom:67%;"> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/49.png" style="zoom:67%;"> <h3 id="_3-13-3-源码分析"><a href="#_3-13-3-源码分析" class="header-anchor">#</a> 3.13.3 源码分析</h3> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/50.png" alt=""></p> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/51.png" style="zoom:67%;"> <h2 id="_3-14-访问者模式"><a href="#_3-14-访问者模式" class="header-anchor">#</a> 3.14 访问者模式</h2> <h3 id="_3-14-1-介绍"><a href="#_3-14-1-介绍" class="header-anchor">#</a> 3.14.1 介绍</h3> <p>访问者模式：封装一些作用于某种数据结构的各元素的操作，它可以在不改变数据结构的前提下定义作用于这些元素的新的操作</p> <p>主要将数据结构与数据操作分离，解决<strong>数据结构和操作耦合性</strong>问题</p> <p>工作原理：在被访问的类里面加一个对外提供接待访问者的接口</p> <p>主要场景为：需要对一个对象结构中的对象进行很多不同操作（这些操作彼此没有关联），同时需要避免让这些操作“污染”这些对象的类，可以使用访问者模式解决</p> <h3 id="_3-14-2-代码"><a href="#_3-14-2-代码" class="header-anchor">#</a> 3.14.2 代码</h3> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/64.png" style="zoom:67%;"> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/65.png" alt=""></p> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/66.png" style="zoom:67%;"> <h3 id="_3-14-3-注意事项"><a href="#_3-14-3-注意事项" class="header-anchor">#</a> 3.14.3 注意事项</h3> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/67.png" alt=""></p> <h2 id="_3-15-迭代器模式"><a href="#_3-15-迭代器模式" class="header-anchor">#</a> 3.15 迭代器模式</h2> <h3 id="_3-15-1-基本介绍"><a href="#_3-15-1-基本介绍" class="header-anchor">#</a> 3.15.1 基本介绍</h3> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/68.png" alt=""></p> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/69.png" alt=""></p> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/70.png" style="zoom:67%;"> <h3 id="_3-15-2-注意事项"><a href="#_3-15-2-注意事项" class="header-anchor">#</a> 3.15.2 注意事项</h3> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/71.png" alt=""></p> <h2 id="_3-16-观察者模式"><a href="#_3-16-观察者模式" class="header-anchor">#</a> 3.16 观察者模式</h2> <h3 id="_3-16-1-基本介绍"><a href="#_3-16-1-基本介绍" class="header-anchor">#</a> 3.16.1 基本介绍</h3> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/72.png" alt=""></p> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/73.png" style="zoom:67%;"> <p>好处：观察者模式设计后，会以集合的方式来管理用户（Observer），包括注册，移除和通知，不需要修改核心类WeatherData不会修改代码，遵守了ocp原则</p> <h3 id="_3-16-2-源码分析"><a href="#_3-16-2-源码分析" class="header-anchor">#</a> 3.16.2 源码分析</h3> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/74.png" style="zoom:67%;"> <h2 id="_3-17-中介者模式"><a href="#_3-17-中介者模式" class="header-anchor">#</a> 3.17 中介者模式</h2> <h3 id="_3-17-1-介绍"><a href="#_3-17-1-介绍" class="header-anchor">#</a> 3.17.1 介绍</h3> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/84.png" style="zoom:67%;"> <p>当对象彼此联系，你中有我，我中有你，不利于松耦合，各个对象之间所传递的消息（参数），容易混乱。当系统增加一个新的电器对象时，或者执行流程改变时，代码的可维护性、扩展性都不理想，考虑中介者模式</p> <p>解耦之后变成</p> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/85.png" style="zoom:67%;"> <p>中介者模式：用一个中介对象来封装一系列的对象交互。中介者使各个对象不需要显示的相互引用，从而使其耦合松散，而且可以独立地改变他们之间的交互</p> <p>中介者模式属于行为型模式，使代码易于维护</p> <p>比如MVC模式，C(Controller控制器)是M(Model模型)和V(View视图)的中介者，在前后端交互时起到了中间人的作用</p> <h3 id="_3-17-2-代码"><a href="#_3-17-2-代码" class="header-anchor">#</a> 3.17.2 代码</h3> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/86.png" alt=""></p> <h3 id="_3-17-3-注意事项"><a href="#_3-17-3-注意事项" class="header-anchor">#</a> 3.17.3 注意事项</h3> <p>中介者模式的注意事项和细节</p> <ul><li>多个类互相耦合会形成网状结构，使用 中介者模式将网状结构分离为星型结构，进行解耦</li> <li>减少类间依赖，降低了耦合，符合迪米特原则</li> <li>中介者承担了较多的责任，一旦中介者出现了问题，整个系统都会受到影响</li> <li>如何设计不当，中介者对象本身变得过于复杂</li></ul> <h2 id="_3-18-备忘录模式"><a href="#_3-18-备忘录模式" class="header-anchor">#</a> 3.18 备忘录模式</h2> <h3 id="_3-18-1-介绍"><a href="#_3-18-1-介绍" class="header-anchor">#</a> 3.18.1 介绍</h3> <p>传统的方式的问题分析</p> <ul><li>一个对象，就对应一个保存对象状态的对象，这样当我们游戏的对象很多时，不利于管理，开销也很大</li> <li>传统方式是做简单做备份，new 出另外一个对象出来，再把需要备份的数据放到这个新对象，但这就暴露了对象内部的细节</li> <li>解决方案=&gt;备忘录模式</li></ul> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/87.png" style="zoom:50%;"> <h3 id="_3-18-2-基本代码"><a href="#_3-18-2-基本代码" class="header-anchor">#</a> 3.18.2 基本代码</h3> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/89.png" style="zoom:50%;"> <h3 id="_3-18-3-注意事项"><a href="#_3-18-3-注意事项" class="header-anchor">#</a> 3.18.3 注意事项</h3> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/90.png" style="zoom:50%;"> <h2 id="_3-19-解释器模式"><a href="#_3-19-解释器模式" class="header-anchor">#</a> 3.19 解释器模式</h2> <h3 id="_3-19-1-介绍"><a href="#_3-19-1-介绍" class="header-anchor">#</a> 3.19.1 介绍</h3> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/91.png" style="zoom:67%;"> <h3 id="_3-19-2-原理类图"><a href="#_3-19-2-原理类图" class="header-anchor">#</a> 3.19.2 原理类图</h3> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/92.png" style="zoom:67%;"> <h3 id="_3-19-3-注意事项"><a href="#_3-19-3-注意事项" class="header-anchor">#</a> 3.19.3 注意事项</h3> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/93.png" style="zoom:67%;"> <h2 id="_3-20-状态模式"><a href="#_3-20-状态模式" class="header-anchor">#</a> 3.20 状态模式</h2> <h3 id="_3-20-1-介绍"><a href="#_3-20-1-介绍" class="header-anchor">#</a> 3.20.1 介绍</h3> <p>状态模式：主要用来解决对象在多种状态转换时，需要对外输出不同的行为的问题。状态和行为是一一对应的，状态之间可以相互转换</p> <p>当一个对象的内在状态改变时，允许改变其行为，这个对象看起来像是改变了其类</p> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/94.png" style="zoom:67%;"> <h3 id="_3-20-2-原理"><a href="#_3-20-2-原理" class="header-anchor">#</a> 3.20.2 原理</h3> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/95.png" style="zoom:67%;"> <h3 id="_3-20-3-注意事项"><a href="#_3-20-3-注意事项" class="header-anchor">#</a> 3.20.3 注意事项</h3> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/96.png" style="zoom:67%;"> <h2 id="_3-21-策略模式"><a href="#_3-21-策略模式" class="header-anchor">#</a> 3.21 策略模式</h2> <h3 id="_3-21-1-介绍"><a href="#_3-21-1-介绍" class="header-anchor">#</a> 3.21.1 介绍</h3> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/97.png" alt=""></p> <h3 id="_3-21-2-原理"><a href="#_3-21-2-原理" class="header-anchor">#</a> 3.21.2 原理</h3> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/98.png" alt=""></p> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/99.png" style="zoom:50%;"> <h3 id="_3-21-3-源码"><a href="#_3-21-3-源码" class="header-anchor">#</a> 3.21.3 源码</h3> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/100.png" alt=""></p> <h2 id="_3-22-职责链"><a href="#_3-22-职责链" class="header-anchor">#</a> 3.22 职责链</h2> <h3 id="_3-22-1-介绍"><a href="#_3-22-1-介绍" class="header-anchor">#</a> 3.22.1 介绍</h3> <img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/设计模式/assert/101.png" style="zoom:67%;"> <h3 id="_3-22-2-源码解析"><a href="#_3-22-2-源码解析" class="header-anchor">#</a> 3.22.2 源码解析</h3> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/102.png" alt=""></p> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/103.png" alt=""></p> <h3 id="_3-22-3-注意事项"><a href="#_3-22-3-注意事项" class="header-anchor">#</a> 3.22.3 注意事项</h3> <p><img src="https://cdn.jsdelivr.net/gh/winden96/jsdelivr@1.0/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/assert/104.png" alt=""></p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/计算机网络/输入网址之后发生了什么.html" class="prev">
        输入网址之后发生了什么
      </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.e7c2969b.js" defer></script><script src="/assets/js/2.94d3dfac.js" defer></script><script src="/assets/js/33.66017b72.js" defer></script>
  </body>
</html>
